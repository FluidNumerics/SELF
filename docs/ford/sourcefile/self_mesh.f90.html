<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="SELF -- Spectral Element Library in Fortran. Fortran classes for implementing spectral element methods on CPU and GPU hardware.">
    
    <meta name="author" content="Joe Schoonover" >
    <link rel="icon" href="../favicon.png">

    <title>SELF_Mesh.f90 &ndash; SELF</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SELF </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>



          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>SELF_Mesh.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
    <li><i class="fa fa-legal"></i> Anti-Capitalist Software License</li> 
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="11.1% of total for source files.">1616 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/SELF_Mesh.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">SELF_Mesh.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/self_mesh.html">SELF_Mesh</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/self_mesh.f90.html#src">SELF_Mesh.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: sourcefile~~self_mesh.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileself_meshf90EfferentGraph" width="641pt" height="223pt"
 viewBox="0.00 0.00 641.00 223.31" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~self_mesh.f90~~EfferentGraph" class="graph" transform="scale(1.4 1.4) rotate(0) translate(4 307.8)">
<title>sourcefile~~self_mesh.f90~~EfferentGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-307.8 891,-307.8 891,4 -4,4"/>
<!-- sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~self_mesh.f90</title>
<polygon fill="none" stroke="black" points="887,-129.23 796,-129.23 796,-105.23 887,-105.23 887,-129.23"/>
<text text-anchor="middle" x="841.5" y="-114.83" font-family="Helvetica,sans-Serif" font-size="10.50">SELF_Mesh.f90</text>
</g>
<!-- sourcefile~self_supportroutines.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~self_supportroutines.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/self_supportroutines.f90.html" xlink:title="SELF_SupportRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="303,-269.23 152,-269.23 152,-245.23 303,-245.23 303,-269.23"/>
<text text-anchor="middle" x="227.5" y="-254.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_SupportRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_supportroutines.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_supportroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M547,-297.23C480.6,-294.81 463.83,-301.15 397.5,-297.23"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M395.5,-297.23C353.16,-294.74 306.29,-282.66 273.02,-272.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="273.73,-268.98 263.15,-269.32 271.63,-275.66 273.73,-268.98"/>
</g>
<!-- sourcefile~self_data.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~self_data.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/self_data.f90.html" xlink:title="SELF_Data.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="745.5,-149.23 656.5,-149.23 656.5,-125.23 745.5,-125.23 745.5,-149.23"/>
<text text-anchor="middle" x="701" y="-134.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Data.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_data.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.92,-123.67C783.06,-125.53 768.9,-127.57 755.56,-129.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="754.95,-126.05 745.55,-130.95 755.95,-132.98 754.95,-126.05"/>
</g>
<!-- sourcefile~self_hdf5.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~self_hdf5.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/self_hdf5.f90.html" xlink:title="SELF_HDF5.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443,-109.23 350,-109.23 350,-85.23 443,-85.23 443,-109.23"/>
<text text-anchor="middle" x="396.5" y="-94.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_HDF5.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_hdf5.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_hdf5.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M796,-115.23C714.74,-111.56 542.54,-103.78 453.48,-99.76"/>
<polygon fill="#ff0000" stroke="#ff0000" points="453.45,-96.26 443.3,-99.3 453.13,-103.25 453.45,-96.26"/>
</g>
<!-- sourcefile~self_lagrange.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~self_lagrange.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/self_lagrange.f90.html" xlink:title="SELF_Lagrange.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="454,-189.23 339,-189.23 339,-165.23 454,-165.23 454,-189.23"/>
<text text-anchor="middle" x="396.5" y="-174.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Lagrange.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_lagrange.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_lagrange.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M831.79,-129.26C798.75,-173.24 676.66,-321.59 549,-297.23"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M547,-297.23C484.68,-294.96 433.49,-231.72 410.53,-197.99"/>
<polygon fill="#ff0000" stroke="#ff0000" points="413.25,-195.75 404.82,-189.33 407.4,-199.6 413.25,-195.75"/>
</g>
<!-- sourcefile~self_hashtable.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~self_hashtable.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/self_hashtable.f90.html" xlink:title="SELF_HashTable.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="760,-69.23 642,-69.23 642,-45.23 760,-45.23 760,-69.23"/>
<text text-anchor="middle" x="701" y="-54.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_HashTable.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_hashtable.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_hashtable.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M812.47,-105.09C791.45,-95.98 762.45,-83.42 739.44,-73.45"/>
<polygon fill="#ff0000" stroke="#ff0000" points="740.55,-70.12 729.99,-69.36 737.77,-76.55 740.55,-70.12"/>
</g>
<!-- sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~self_constants.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/self_constants.f90.html" xlink:title="SELF_Constants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="116,-189.23 0,-189.23 0,-165.23 116,-165.23 116,-189.23"/>
<text text-anchor="middle" x="58" y="-174.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Constants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M395.5,-297.23C287.14,-290.84 249.64,-325.67 152,-278.23 115.66,-260.58 86.67,-222.03 71.23,-197.99"/>
<polygon fill="#ff0000" stroke="#ff0000" points="74.06,-195.91 65.81,-189.27 68.12,-199.61 74.06,-195.91"/>
</g>
<!-- sourcefile~self_supportroutines.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~self_supportroutines.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M187.28,-245.11C175.74,-241.13 163.2,-236.38 152,-231.23 129.03,-220.68 104.34,-206.18 86.18,-194.87"/>
<polygon fill="#ff0000" stroke="#ff0000" points="87.65,-191.65 77.32,-189.28 83.91,-197.57 87.65,-191.65"/>
</g>
<!-- sourcefile~self_data.f90&#45;&gt;sourcefile~self_lagrange.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~self_data.f90&#45;&gt;sourcefile~self_lagrange.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M547,-177.23C520.01,-178.92 490.24,-179.23 464.41,-179.01"/>
<polygon fill="#ffff00" stroke="#ffff00" points="464.38,-175.51 454.34,-178.9 464.3,-182.51 464.38,-175.51"/>
</g>
<!-- sourcefile~self_data.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~self_data.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M669.07,-149.26C638.96,-160.05 591.63,-174.58 549,-177.23"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M547,-177.23C504.71,-179.87 496.11,-160.93 454,-156.23 320.6,-141.36 285.4,-141.36 152,-156.23 139.28,-157.65 125.76,-160.13 113.08,-162.9"/>
<polygon fill="#ffff00" stroke="#ffff00" points="112.1,-159.53 103.13,-165.17 113.65,-166.36 112.1,-159.53"/>
</g>
<!-- sourcefile~self_metadata.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~self_metadata.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/self_metadata.f90.html" xlink:title="SELF_Metadata.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="605,-149.23 491,-149.23 491,-125.23 605,-125.23 605,-149.23"/>
<text text-anchor="middle" x="548" y="-134.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Metadata.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_data.f90&#45;&gt;sourcefile~self_metadata.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~self_data.f90&#45;&gt;sourcefile~self_metadata.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M656.32,-137.23C643.5,-137.23 629.17,-137.23 615.27,-137.23"/>
<polygon fill="#ffff00" stroke="#ffff00" points="615.25,-133.73 605.25,-137.23 615.25,-140.73 615.25,-133.73"/>
</g>
<!-- sourcefile~self_hdf5.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~self_hdf5.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M383.94,-85.03C357.6,-58.77 290.6,-0.58 228.5,-17.23"/>
</g>
<!-- sourcefile~self_memory.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~self_memory.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/self_memory.f90.html" xlink:title="SELF_Memory.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="280.5,-109.23 174.5,-109.23 174.5,-85.23 280.5,-85.23 280.5,-109.23"/>
<text text-anchor="middle" x="227.5" y="-94.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Memory.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_hdf5.f90&#45;&gt;sourcefile~self_memory.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~self_hdf5.f90&#45;&gt;sourcefile~self_memory.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M349.87,-97.23C331.61,-97.23 310.29,-97.23 290.66,-97.23"/>
<polygon fill="#00ff00" stroke="#00ff00" points="290.57,-93.73 280.57,-97.23 290.57,-100.73 290.57,-93.73"/>
</g>
<!-- sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_supportroutines.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_supportroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M377.29,-189.28C359.03,-201.02 329.85,-218.85 303,-231.23 294.87,-234.99 286.03,-238.52 277.37,-241.7"/>
<polygon fill="#00ffff" stroke="#00ffff" points="275.98,-238.48 267.73,-245.13 278.32,-245.07 275.98,-238.48"/>
</g>
<!-- sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M351.62,-189.3C336.35,-192.94 319.04,-196.44 303,-198.23 236.31,-205.71 218.7,-205.67 152,-198.23 139.28,-196.82 125.76,-194.34 113.08,-191.57"/>
<polygon fill="#00ffff" stroke="#00ffff" points="113.65,-188.11 103.13,-189.3 112.1,-194.94 113.65,-188.11"/>
</g>
<!-- sourcefile~self_quadrature.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~self_quadrature.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/self_quadrature.f90.html" xlink:title="SELF_Quadrature.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="289.5,-189.23 165.5,-189.23 165.5,-165.23 289.5,-165.23 289.5,-189.23"/>
<text text-anchor="middle" x="227.5" y="-174.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Quadrature.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_quadrature.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_quadrature.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M338.96,-177.23C326.42,-177.23 312.96,-177.23 299.91,-177.23"/>
<polygon fill="#00ffff" stroke="#00ffff" points="299.56,-173.73 289.56,-177.23 299.56,-180.73 299.56,-173.73"/>
</g>
<!-- sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_memory.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_memory.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M370.14,-165.08C341.53,-151.38 294.84,-129.01 262.94,-113.73"/>
<polygon fill="#00ffff" stroke="#00ffff" points="264.09,-110.4 253.56,-109.24 261.06,-116.71 264.09,-110.4"/>
</g>
<!-- sourcefile~self_hashtable.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~self_hashtable.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M661.32,-45.16C579.76,-21.59 384.81,24.7 228.5,-17.23"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M226.5,-17.23C152.46,-38.79 95.36,-117.82 71.37,-156.13"/>
<polygon fill="#0000ff" stroke="#0000ff" points="68.21,-154.58 65.99,-164.94 74.19,-158.23 68.21,-154.58"/>
</g>
<!-- sourcefile~self_linkedlist.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~self_linkedlist.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/self_linkedlist.f90.html" xlink:title="SELF_LinkedList.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="606,-69.23 490,-69.23 490,-45.23 606,-45.23 606,-69.23"/>
<text text-anchor="middle" x="548" y="-54.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_LinkedList.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_hashtable.f90&#45;&gt;sourcefile~self_linkedlist.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~self_hashtable.f90&#45;&gt;sourcefile~self_linkedlist.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M641.62,-57.23C633.36,-57.23 624.81,-57.23 616.4,-57.23"/>
<polygon fill="#0000ff" stroke="#0000ff" points="616.23,-53.73 606.23,-57.23 616.23,-60.73 616.23,-53.73"/>
</g>
<!-- sourcefile~self_quadrature.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~self_quadrature.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M165.08,-177.23C152.48,-177.23 139.16,-177.23 126.36,-177.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="126.24,-173.73 116.24,-177.23 126.24,-180.73 126.24,-173.73"/>
</g>
<!-- sourcefile~self_memory.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~self_memory.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M187.28,-109.36C175.74,-113.34 163.2,-118.08 152,-123.23 129.03,-133.79 104.34,-148.29 86.18,-159.6"/>
<polygon fill="#7fff00" stroke="#7fff00" points="83.91,-156.9 77.32,-165.19 87.65,-162.82 83.91,-156.9"/>
</g>
<!-- sourcefile~self_metadata.f90&#45;&gt;sourcefile~self_hdf5.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~self_metadata.f90&#45;&gt;sourcefile~self_hdf5.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M502.15,-125.23C486.55,-121.06 468.87,-116.33 452.54,-111.96"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="453.15,-108.5 442.58,-109.3 451.34,-115.26 453.15,-108.5"/>
</g>
</g>
</svg>
</div><script>var pansourcefileself_meshf90EfferentGraph = svgPanZoom('#sourcefileself_meshf90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: sourcefile~~self_mesh.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileself_meshf90AfferentGraph" width="641pt" height="171pt"
 viewBox="0.00 0.00 641.00 170.86" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~self_mesh.f90~~AfferentGraph" class="graph" transform="scale(1.34 1.34) rotate(0) translate(4 225.77)">
<title>sourcefile~~self_mesh.f90~~AfferentGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-225.77 858,-225.77 858,4 -4,4"/>
<!-- sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~self_mesh.f90</title>
<polygon fill="none" stroke="black" points="91,-124 0,-124 0,-100 91,-100 91,-124"/>
<text text-anchor="middle" x="45.5" y="-109.6" font-family="Helvetica,sans-Serif" font-size="10.50">SELF_Mesh.f90</text>
</g>
<!-- sourcefile~self_mappeddata.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~self_mappeddata.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/self_mappeddata.f90.html" xlink:title="SELF_MappedData.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="410,-124 278,-124 278,-100 410,-100 410,-124"/>
<text text-anchor="middle" x="344" y="-109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_MappedData.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M306.94,-99.97C268.14,-87.54 208.85,-70.18 185.5,-72"/>
</g>
<!-- sourcefile~self_geometry.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~self_geometry.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/self_geometry.f90.html" xlink:title="SELF_Geometry.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="242,-124 127,-124 127,-100 242,-100 242,-124"/>
<text text-anchor="middle" x="184.5" y="-109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Geometry.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_geometry.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_geometry.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M277.57,-112C269.28,-112 260.79,-112 252.47,-112"/>
<polygon fill="#aaff00" stroke="#aaff00" points="252.44,-108.5 242.44,-112 252.44,-115.5 252.44,-108.5"/>
</g>
<!-- sourcefile~self_linearshallowwater.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~self_linearshallowwater.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/self_linearshallowwater.f90.html" xlink:title="SELF_LinearShallowWater.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="747,-202 578,-202 578,-178 747,-178 747,-202"/>
<text text-anchor="middle" x="662.5" y="-187.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_LinearShallowWater.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_linearshallowwater.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~self_linearshallowwater.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M493,-192C427.73,-183.84 410.52,-197.76 345,-192"/>
</g>
<!-- sourcefile~self_linearshallowwater.f90&#45;&gt;sourcefile~self_mappeddata.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~self_linearshallowwater.f90&#45;&gt;sourcefile~self_mappeddata.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M577.83,-195.45C551.26,-195.99 521.82,-195.35 495,-192"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M493,-192C443.57,-185.82 394.32,-152.37 366.94,-130.73"/>
<polygon fill="#ff0000" stroke="#ff0000" points="368.82,-127.74 358.85,-124.16 364.41,-133.18 368.82,-127.74"/>
</g>
<!-- sourcefile~self_model.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~self_model.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/self_model.f90.html" xlink:title="SELF_Model.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="542,-164 446,-164 446,-140 542,-140 542,-164"/>
<text text-anchor="middle" x="494" y="-149.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Model.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_linearshallowwater.f90&#45;&gt;sourcefile~self_model.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~self_linearshallowwater.f90&#45;&gt;sourcefile~self_model.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M608.82,-177.98C590.81,-173.87 570.59,-169.25 552.24,-165.06"/>
<polygon fill="#0000ff" stroke="#0000ff" points="552.79,-161.6 542.27,-162.79 551.24,-168.43 552.79,-161.6"/>
</g>
<!-- sourcefile~self_geometry.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~self_geometry.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M126.99,-112C118.5,-112 109.75,-112 101.3,-112"/>
<polygon fill="#ff0000" stroke="#ff0000" points="101.17,-108.5 91.17,-112 101.17,-115.5 101.17,-108.5"/>
</g>
<!-- sourcefile~self_advection3d.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~self_advection3d.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/self_advection3d.f90.html" xlink:title="SELF_Advection3D.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="728,-44 597,-44 597,-20 728,-20 728,-44"/>
<text text-anchor="middle" x="662.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Advection3D.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_advection3d.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~self_advection3d.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M596.92,-26.37C565.85,-25.09 528.22,-25.63 495,-32"/>
</g>
<!-- sourcefile~self_dg.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~self_dg.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/self_dg.f90.html" xlink:title="SELF_DG.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="534,-84 454,-84 454,-60 534,-60 534,-84"/>
<text text-anchor="middle" x="494" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_DG.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_advection3d.f90&#45;&gt;sourcefile~self_dg.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~self_advection3d.f90&#45;&gt;sourcefile~self_dg.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M611.54,-44C590.13,-49.15 565.19,-55.14 543.89,-60.25"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="542.98,-56.87 534.07,-62.61 544.62,-63.68 542.98,-56.87"/>
</g>
<!-- sourcefile~sadv3d.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~sadv3d.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/sadv3d.f90.html" xlink:title="sadv3d.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="854,-24 783,-24 783,0 854,0 854,-24"/>
<text text-anchor="middle" x="818.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sadv3d.f90</text>
</a>
</g>
</g>
<!-- sourcefile~sadv3d.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~sadv3d.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M782.72,-11.41C771.34,-11.24 758.63,-11.08 747,-11 671.89,-10.47 652.54,-1.72 578,-11 540.24,-15.7 532.37,-24.84 495,-32"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M493,-32C425.78,-43.15 413.14,-72 345,-72"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M343,-72C273,-72 255.29,-66.56 185.5,-72"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M183.5,-72C149.07,-74.68 111.52,-86.3 84.45,-96.33"/>
<polygon fill="#ff0000" stroke="#ff0000" points="83.08,-93.11 74.98,-99.93 85.57,-99.65 83.08,-93.11"/>
</g>
<!-- sourcefile~sadv3d.f90&#45;&gt;sourcefile~self_advection3d.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~sadv3d.f90&#45;&gt;sourcefile~self_advection3d.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M782.94,-16.49C769.7,-18.21 754.03,-20.24 738.46,-22.26"/>
<polygon fill="#00ff00" stroke="#00ff00" points="737.74,-18.83 728.28,-23.59 738.65,-25.77 737.74,-18.83"/>
</g>
<!-- sourcefile~self_advection2d.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~self_advection2d.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/self_advection2d.f90.html" xlink:title="SELF_Advection2D.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="728,-160 597,-160 597,-136 728,-136 728,-160"/>
<text text-anchor="middle" x="662.5" y="-145.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Advection2D.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_advection2d.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~self_advection2d.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M611.07,-135.96C578.16,-128.38 534.19,-118.79 495,-112"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M493,-112C425.86,-100.37 413.14,-72 345,-72"/>
</g>
<!-- sourcefile~self_advection2d.f90&#45;&gt;sourcefile~self_mappeddata.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~self_advection2d.f90&#45;&gt;sourcefile~self_mappeddata.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M493,-112C469.62,-107.95 443.86,-106.82 420.46,-107.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="420.19,-103.54 410.25,-107.21 420.31,-110.54 420.19,-103.54"/>
</g>
<!-- sourcefile~self_advection2d.f90&#45;&gt;sourcefile~self_model.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~self_advection2d.f90&#45;&gt;sourcefile~self_model.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M596.65,-149.56C582.03,-149.91 566.61,-150.28 552.32,-150.62"/>
<polygon fill="#0000ff" stroke="#0000ff" points="552.06,-147.13 542.15,-150.87 552.23,-154.13 552.06,-147.13"/>
</g>
<!-- sourcefile~self_model.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~self_model.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M465.5,-164.07C436.23,-175.81 388.25,-191.9 345,-192"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M343,-192C245.68,-192.22 136.39,-151.45 81.69,-128.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="83.01,-124.79 72.44,-124.02 80.22,-131.21 83.01,-124.79"/>
</g>
<!-- sourcefile~self_model.f90&#45;&gt;sourcefile~self_mappeddata.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~self_model.f90&#45;&gt;sourcefile~self_mappeddata.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.6,-140C433.15,-135.83 415.65,-131.1 399.49,-126.73"/>
<polygon fill="#ff0000" stroke="#ff0000" points="400.2,-123.29 389.63,-124.06 398.37,-130.05 400.2,-123.29"/>
</g>
<!-- sourcefile~self_dg.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~self_dg.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.74,-72C423.91,-72 381.87,-72 345,-72"/>
</g>
<!-- sourcefile~self_dg.f90&#45;&gt;sourcefile~self_mappeddata.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~self_dg.f90&#45;&gt;sourcefile~self_mappeddata.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.73,-82.61C437.04,-87.13 417.3,-92.46 399.25,-97.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="398.17,-94.01 389.43,-99.99 399.99,-100.76 398.17,-94.01"/>
</g>
<!-- sourcefile~sadv2d.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~sadv2d.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/sadv2d.f90.html" xlink:title="sadv2d.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="854,-201 783,-201 783,-177 854,-177 854,-201"/>
<text text-anchor="middle" x="818.5" y="-186.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sadv2d.f90</text>
</a>
</g>
</g>
<!-- sourcefile~sadv2d.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~sadv2d.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M786.04,-201.05C774.02,-205.06 760.06,-209.01 747,-211 614.73,-231.16 579.28,-217.73 446,-206 400.86,-202.03 390.14,-195.97 345,-192"/>
</g>
<!-- sourcefile~sadv2d.f90&#45;&gt;sourcefile~self_advection2d.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~sadv2d.f90&#45;&gt;sourcefile~self_advection2d.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M782.77,-178.92C771.39,-175.68 758.68,-172.12 747,-169 739.1,-166.89 730.75,-164.71 722.52,-162.61"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="723.13,-159.15 712.57,-160.08 721.4,-165.94 723.13,-159.15"/>
</g>
</g>
</svg>
</div><script>var pansourcefileself_meshf90AfferentGraph = svgPanZoom('#sourcefileself_meshf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/self_mesh.html">SELF_Mesh</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/self_mesh.f90.html#src">SELF_Mesh.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!</span>
<a name="ln-2"></a><span class="c">! Copyright 2020 Fluid Numerics LLC</span>
<a name="ln-3"></a><span class="c">! Author : Joseph Schoonover (joe@fluidnumerics.com)</span>
<a name="ln-4"></a><span class="c">! Support : self@higherordermethods.org</span>
<a name="ln-5"></a><span class="c">!</span>
<a name="ln-6"></a><span class="c">! //////////////////////////////////////////////////////////////////////////////////////////////// !</span>
<a name="ln-7"></a><span class="k">MODULE </span><span class="n">SELF_Mesh</span>
<a name="ln-8"></a>
<a name="ln-9"></a>  <span class="k">USE </span><span class="n">SELF_Constants</span>
<a name="ln-10"></a>  <span class="k">USE </span><span class="n">SELF_HashTable</span>
<a name="ln-11"></a>  <span class="k">USE </span><span class="n">SELF_Lagrange</span>
<a name="ln-12"></a>  <span class="k">USE </span><span class="n">SELF_Data</span>
<a name="ln-13"></a>  <span class="k">USE </span><span class="n">SELF_SupportRoutines</span>
<a name="ln-14"></a>  <span class="k">USE </span><span class="n">SELF_HDF5</span>
<a name="ln-15"></a>  <span class="c">! External Libs !</span>
<a name="ln-16"></a>  <span class="k">USE </span><span class="n">HDF5</span>
<a name="ln-17"></a>  <span class="k">USE </span><span class="n">MPI</span>
<a name="ln-18"></a>
<a name="ln-19"></a>  <span class="k">USE </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-20"></a>
<a name="ln-21"></a><span class="nb">  </span><span class="k">IMPLICIT NONE</span>
<a name="ln-22"></a>
<a name="ln-23"></a><span class="cp">#include &quot;SELF_Macros.h&quot;</span>
<a name="ln-24"></a><span class="c">! ========================================================================= !</span>
<a name="ln-25"></a><span class="c">! Node, Edge, Face, Element and Connectivity Standard</span>
<a name="ln-26"></a><span class="c">! ========================================================================= !</span>
<a name="ln-27"></a><span class="c">!</span>
<a name="ln-28"></a><span class="c">! To define the element corner nodes, the side order and side connectivity,</span>
<a name="ln-29"></a><span class="c">! we follow the standard from CGNS SIDS (CFD General Notation System,</span>
<a name="ln-30"></a><span class="c">! Standard Interface Data Structures, http: //cgns.sourceforge.net/ ).</span>
<a name="ln-31"></a><span class="c">!</span>
<a name="ln-32"></a><span class="c">! Computational coordinate directions are defined as follows</span>
<a name="ln-33"></a><span class="c">!</span>
<a name="ln-34"></a><span class="c">! xi1 direction points from &quot;West&quot; (xi1=-1) to &quot;East&quot; (xi1=1)</span>
<a name="ln-35"></a><span class="c">! xi2 direction points from &quot;South&quot; (xi2=-1) to &quot;North&quot; (xi2=1)</span>
<a name="ln-36"></a><span class="c">! xi3 direction points from &quot;Bottom&quot; (xi3=-1) to &quot;Top&quot; (xi3=1)</span>
<a name="ln-37"></a><span class="c">!</span>
<a name="ln-38"></a><span class="c">! 2-D Hexahedreal Element sides are defined as</span>
<a name="ln-39"></a><span class="c">!</span>
<a name="ln-40"></a><span class="c">! Side 1 = South  (xi2 = -1) = [CN1, CN2]</span>
<a name="ln-41"></a><span class="c">! Side 2 = East   (xi1 = 1) = [CN2, CN3]</span>
<a name="ln-42"></a><span class="c">! Side 3 = North  (xi2 = 1) = [CN4, CN3]</span>
<a name="ln-43"></a><span class="c">! Side 4 = West   (xi1 = -1) = [CN1, CN4]</span>
<a name="ln-44"></a><span class="c">!</span>
<a name="ln-45"></a><span class="c">! 3-D Hexahedreal Element sides are defined as</span>
<a name="ln-46"></a><span class="c">!</span>
<a name="ln-47"></a><span class="c">! Side 1 = Bottom (xi3 = -1) = [CN1, CN4, CN3, CN2]</span>
<a name="ln-48"></a><span class="c">! Side 2 = South  (xi2 = -1) = [CN1, CN2, CN6, CN5]</span>
<a name="ln-49"></a><span class="c">! Side 3 = East   (xi1 = 1) = [CN2, CN3, CN7, CN6]</span>
<a name="ln-50"></a><span class="c">! Side 4 = North  (xi2 = 1) = [CN3, CN4, CN8, CN7]</span>
<a name="ln-51"></a><span class="c">! Side 5 = West   (xi1 = -1) = [CN1, CN5, CN8, CN4]</span>
<a name="ln-52"></a><span class="c">! Side 6 = Top    (xi3 = 1) = [CN5, CN6, CN7, CN8]</span>
<a name="ln-53"></a><span class="c">!</span>
<a name="ln-54"></a><span class="c">! In 2-D, corner nodes are order counter-clockwise (looking in the -xi3 direction).</span>
<a name="ln-55"></a><span class="c">!</span>
<a name="ln-56"></a><span class="c">! CornerNode 1 = South-West = (-1,-1)</span>
<a name="ln-57"></a><span class="c">! CornerNode 2 = South-East = ( 1,-1)</span>
<a name="ln-58"></a><span class="c">! CornerNode 3 = North-East = ( 1, 1)</span>
<a name="ln-59"></a><span class="c">! CornerNode 4 = North-West = (-1, 1)</span>
<a name="ln-60"></a><span class="c">!</span>
<a name="ln-61"></a><span class="c">! In 3-D, corner nodes are order counter-clockwise (looking in the -xi3 direction) from</span>
<a name="ln-62"></a><span class="c">! bottom to top.</span>
<a name="ln-63"></a><span class="c">!</span>
<a name="ln-64"></a><span class="c">! CornerNode 1 = Bottom-South-West = (-1,-1,-1)</span>
<a name="ln-65"></a><span class="c">! CornerNode 2 = Bottom-South-East = ( 1,-1,-1)</span>
<a name="ln-66"></a><span class="c">! CornerNode 3 = Bottom-North-East = ( 1, 1,-1)</span>
<a name="ln-67"></a><span class="c">! CornerNode 4 = Bottom-North-West = (-1, 1,-1)</span>
<a name="ln-68"></a><span class="c">! CornerNode 5 = Top-South-West = (-1,-1, 1)</span>
<a name="ln-69"></a><span class="c">! CornerNode 6 = Top-South-East = ( 1,-1, 1)</span>
<a name="ln-70"></a><span class="c">! CornerNode 7 = Top-North-East = ( 1, 1, 1)</span>
<a name="ln-71"></a><span class="c">! CornerNode 8 = Top-North-West = (-1, 1, 1)</span>
<a name="ln-72"></a><span class="c">!</span>
<a name="ln-73"></a><span class="c">!</span>
<a name="ln-74"></a><span class="c">! Notes:</span>
<a name="ln-75"></a><span class="c">!  * cornerNode attributes have not been implemented yet</span>
<a name="ln-76"></a><span class="c">!</span>
<a name="ln-77"></a><span class="c">!  * For line segments, quads, and hexes, SELF uses Legendre-Gauss-Lobatto quadrature</span>
<a name="ln-78"></a><span class="c">!</span>
<a name="ln-79"></a><span class="c">! ========================================================================= !</span>
<a name="ln-80"></a>
<a name="ln-81"></a>  <span class="c">! Element Types - From Table 4.1 of https://www.hopr-project.org/externals/Meshformat.pdf</span>
<a name="ln-82"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfLineLinear</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-83"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfLineNonlinear</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-84"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfTriangleLinear</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-85"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfQuadLinear</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-86"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfQuadBilinear</span> <span class="o">=</span> <span class="mi">14</span>
<a name="ln-87"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfTriangleNonlinear</span> <span class="o">=</span> <span class="mi">23</span>
<a name="ln-88"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfQuadNonlinear</span> <span class="o">=</span> <span class="mi">24</span>
<a name="ln-89"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfTetrahedronLinear</span> <span class="o">=</span> <span class="mi">104</span>
<a name="ln-90"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfPyramidLinear</span> <span class="o">=</span> <span class="mi">105</span>
<a name="ln-91"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfPrismLinear</span> <span class="o">=</span> <span class="mi">106</span>
<a name="ln-92"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfHexahedronLinear</span> <span class="o">=</span> <span class="mi">108</span>
<a name="ln-93"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfPyramidBilinear</span> <span class="o">=</span> <span class="mi">115</span>
<a name="ln-94"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfPrismBilinear</span> <span class="o">=</span> <span class="mi">116</span>
<a name="ln-95"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfHexahedronBilinear</span> <span class="o">=</span> <span class="mi">118</span>
<a name="ln-96"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfTetrahedronNonlinear</span> <span class="o">=</span> <span class="mi">204</span>
<a name="ln-97"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfPyramidNonlinear</span> <span class="o">=</span> <span class="mi">205</span>
<a name="ln-98"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfPrismNonlinear</span> <span class="o">=</span> <span class="mi">206</span>
<a name="ln-99"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfHexahedronNonlinear</span> <span class="o">=</span> <span class="mi">208</span>
<a name="ln-100"></a>
<a name="ln-101"></a>  <span class="c">!</span>
<a name="ln-102"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfMinNodalValence2D</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-103"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfMinNodalValence3D</span> <span class="o">=</span> <span class="mi">8</span>
<a name="ln-104"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfMaxNodalValence2D</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-105"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfMaxNodalValence3D</span> <span class="o">=</span> <span class="mi">10</span>
<a name="ln-106"></a>
<a name="ln-107"></a>  <span class="c">! Side Ordering</span>
<a name="ln-108"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide2D_South</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-109"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide2D_East</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-110"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide2D_North</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-111"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide2D_West</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-112"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide3D_Bottom</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-113"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide3D_South</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-114"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide3D_East</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-115"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide3D_North</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-116"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide3D_West</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-117"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide3D_Top</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-118"></a>  <span class="c">!</span>
<a name="ln-119"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">self_BCDefault</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-120"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">self_nBCsDefault</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-121"></a>
<a name="ln-122"></a>  <span class="c">!==============================================!</span>
<a name="ln-123"></a>  <span class="c">! --------------- File Types------------------ !</span>
<a name="ln-124"></a>  <span class="c">!==============================================!</span>
<a name="ln-125"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SELF_MESH_ISM_V2_2D</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-126"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SELF_MESH_ISM_V2_3D</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-127"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SELF_MESH_HOPR_2D</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-128"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SELF_MESH_HOPR_3D</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-129"></a>
<a name="ln-130"></a>  <span class="k">TYPE </span><span class="n">MeshSpec</span>
<a name="ln-131"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="n">self_FileNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">filename</span>
<a name="ln-132"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">fileType</span>
<a name="ln-133"></a>
<a name="ln-134"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">blockMesh</span>
<a name="ln-135"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">blockMesh_nGeo</span>
<a name="ln-136"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">blockMesh_nElemX</span>
<a name="ln-137"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">blockMesh_nElemY</span>
<a name="ln-138"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">blockMesh_nElemZ</span>
<a name="ln-139"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">blockMesh_x0</span><span class="p">,</span><span class="n">blockMesh_x1</span>
<a name="ln-140"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">blockMesh_y0</span><span class="p">,</span><span class="n">blockMesh_y1</span>
<a name="ln-141"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">blockMesh_z0</span><span class="p">,</span><span class="n">blockMesh_z1</span>
<a name="ln-142"></a>
<a name="ln-143"></a>  <span class="k">END TYPE </span><span class="n">MeshSpec</span>
<a name="ln-144"></a>
<a name="ln-145"></a>  <span class="k">TYPE </span><span class="n">MPILayer</span>
<a name="ln-146"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">mpiEnabled</span>
<a name="ln-147"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">mpiComm</span>
<a name="ln-148"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">mpiPrec</span>
<a name="ln-149"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">rankId</span>
<a name="ln-150"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nRanks</span>
<a name="ln-151"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-152"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">maxMsg</span>
<a name="ln-153"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">msgCount</span>
<a name="ln-154"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">elemToRank</span>
<a name="ln-155"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">offSetElem</span>
<a name="ln-156"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">requests</span><span class="p">(:)</span>
<a name="ln-157"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">stats</span><span class="p">(:,:)</span>
<a name="ln-158"></a>
<a name="ln-159"></a>  <span class="k">CONTAINS</span>
<a name="ln-160"></a>
<a name="ln-161"></a><span class="k">    PROCEDURE</span> <span class="kd">::</span> <span class="n">Init</span> <span class="o">=&gt;</span> <span class="n">Init_MPILayer</span>
<a name="ln-162"></a>    <span class="k">PROCEDURE</span> <span class="kd">::</span> <span class="n">Free</span> <span class="o">=&gt;</span> <span class="n">Free_MPILayer</span>
<a name="ln-163"></a>    <span class="k">PROCEDURE</span> <span class="kd">::</span> <span class="n">Finalize</span> <span class="o">=&gt;</span> <span class="n">Finalize_MPILayer</span>
<a name="ln-164"></a>
<a name="ln-165"></a>    <span class="k">PROCEDURE</span> <span class="kd">::</span> <span class="n">GenerateDecomposition</span> <span class="o">=&gt;</span> <span class="n">GenerateDecomposition_MPILayer</span>
<a name="ln-166"></a>    <span class="k">PROCEDURE</span> <span class="kd">::</span> <span class="n">SetElemToRank</span>
<a name="ln-167"></a>    <span class="k">PROCEDURE</span> <span class="kd">::</span> <span class="n">SetMaxMsg</span>
<a name="ln-168"></a>
<a name="ln-169"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">FinalizeMPIExchangeAsync</span>
<a name="ln-170"></a>
<a name="ln-171"></a>  <span class="k">END TYPE </span><span class="n">MPILayer</span>
<a name="ln-172"></a>
<a name="ln-173"></a>  <span class="k">TYPE</span> <span class="kd">::</span> <span class="n">SEMMesh</span>
<a name="ln-174"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGeo</span>
<a name="ln-175"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-176"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGlobalElem</span>
<a name="ln-177"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nNodes</span>
<a name="ln-178"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nSides</span>
<a name="ln-179"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nCornerNodes</span>
<a name="ln-180"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nUniqueNodes</span>
<a name="ln-181"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nUniqueSides</span>
<a name="ln-182"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nBCs</span>
<a name="ln-183"></a>
<a name="ln-184"></a>  <span class="k">END TYPE </span><span class="n">SEMMesh</span>
<a name="ln-185"></a>
<a name="ln-186"></a>  <span class="k">TYPE</span><span class="p">,</span><span class="k">EXTENDS</span><span class="p">(</span><span class="n">SEMMesh</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Mesh1D</span>
<a name="ln-187"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_elemInfo</span>
<a name="ln-188"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_nodeCoords</span>
<a name="ln-189"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_globalNodeIDs</span>
<a name="ln-190"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BCType</span>
<a name="ln-191"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">255</span><span class="p">),</span><span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">BCNames</span><span class="p">(:)</span>
<a name="ln-192"></a>
<a name="ln-193"></a>  <span class="k">CONTAINS</span>
<a name="ln-194"></a><span class="k">    PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Init</span> <span class="o">=&gt;</span> <span class="n">Init_Mesh1D</span>
<a name="ln-195"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Free</span> <span class="o">=&gt;</span> <span class="n">Free_Mesh1D</span>
<a name="ln-196"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateHost</span> <span class="o">=&gt;</span> <span class="n">UpdateHost_Mesh1D</span>
<a name="ln-197"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateDevice</span> <span class="o">=&gt;</span> <span class="n">UpdateDevice_Mesh1D</span>
<a name="ln-198"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UniformBlockMesh</span> <span class="o">=&gt;</span> <span class="n">UniformBlockMesh_Mesh1D</span>
<a name="ln-199"></a>
<a name="ln-200"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span>  <span class="kd">::</span> <span class="n">Read_HOPr</span> <span class="o">=&gt;</span> <span class="n">Read_HOPr_Mesh1D_serial</span><span class="p">,</span><span class="n">Read_HOPr_Mesh1D_parallel</span>
<a name="ln-201"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">Read_HOPr_Mesh1D_serial</span><span class="p">,</span><span class="n">Read_HOPr_Mesh1D_parallel</span>
<a name="ln-202"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span>  <span class="kd">::</span> <span class="n">Write_HOPr</span> <span class="o">=&gt;</span> <span class="n">Write_HOPr_Mesh1D</span>
<a name="ln-203"></a>
<a name="ln-204"></a>  <span class="k">END TYPE </span><span class="n">Mesh1D</span>
<a name="ln-205"></a>
<a name="ln-206"></a>  <span class="c">! Mesh format is set up as the HOPr format</span>
<a name="ln-207"></a>  <span class="c">! See https://hopr-project.org/externals/MeshFormat.pdf</span>
<a name="ln-208"></a>
<a name="ln-209"></a>  <span class="k">TYPE</span><span class="p">,</span><span class="k">EXTENDS</span><span class="p">(</span><span class="n">SEMMesh</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Mesh2D</span>
<a name="ln-210"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self_sideInfo</span>
<a name="ln-211"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self_nodeCoords</span>
<a name="ln-212"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hohq_cornerNodes</span>
<a name="ln-213"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hohq_elemInfo</span>
<a name="ln-214"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hohq_sideInfo</span>
<a name="ln-215"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hohq_sideCurves</span>
<a name="ln-216"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_elemInfo</span>
<a name="ln-217"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_sideInfo</span>
<a name="ln-218"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_nodeCoords</span>
<a name="ln-219"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_globalNodeIDs</span>
<a name="ln-220"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_CGNSCornerMap</span>
<a name="ln-221"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_CGNSSideMap</span>
<a name="ln-222"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_curveNodeMap</span>
<a name="ln-223"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_curveNodeMapInv</span>
<a name="ln-224"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BCType</span>
<a name="ln-225"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">255</span><span class="p">),</span><span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">BCNames</span><span class="p">(:)</span>
<a name="ln-226"></a>
<a name="ln-227"></a>  <span class="k">CONTAINS</span>
<a name="ln-228"></a><span class="k">    PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Init</span> <span class="o">=&gt;</span> <span class="n">Init_Mesh2D</span>
<a name="ln-229"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Free</span> <span class="o">=&gt;</span> <span class="n">Free_Mesh2D</span>
<a name="ln-230"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateHost</span> <span class="o">=&gt;</span> <span class="n">UpdateHost_Mesh2D</span>
<a name="ln-231"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateDevice</span> <span class="o">=&gt;</span> <span class="n">UpdateDevice_Mesh2D</span>
<a name="ln-232"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UniformBlockMesh</span> <span class="o">=&gt;</span> <span class="n">UniformBlockMesh_Mesh2D</span>
<a name="ln-233"></a>
<a name="ln-234"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Load</span> <span class="o">=&gt;</span> <span class="n">Load_Mesh2D_serial</span><span class="p">,</span><span class="n">Load_Mesh2D_parallel</span>
<a name="ln-235"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">Load_Mesh2D_serial</span><span class="p">,</span><span class="n">Load_Mesh2D_parallel</span>
<a name="ln-236"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Read_HOPr</span> <span class="o">=&gt;</span> <span class="n">Read_HOPr_Mesh2D_serial</span><span class="p">,</span><span class="n">Read_HOPr_Mesh2D_parallel</span>
<a name="ln-237"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">Read_HOPr_Mesh2D_serial</span><span class="p">,</span><span class="n">Read_HOPr_Mesh2D_parallel</span>
<a name="ln-238"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Write_HOPr</span> <span class="o">=&gt;</span> <span class="n">Write_HOPr_Mesh2D</span>
<a name="ln-239"></a>
<a name="ln-240"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Read_ISMv2</span> <span class="o">=&gt;</span> <span class="n">Read_ISMv2_Mesh2D</span>
<a name="ln-241"></a>
<a name="ln-242"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">GenerateConnectivity</span> <span class="o">=&gt;</span> <span class="n">GenerateConnectivity_Mesh2D</span>
<a name="ln-243"></a>
<a name="ln-244"></a>  <span class="k">END TYPE </span><span class="n">Mesh2D</span>
<a name="ln-245"></a>
<a name="ln-246"></a>  <span class="k">TYPE</span><span class="p">,</span><span class="k">EXTENDS</span><span class="p">(</span><span class="n">SEMMesh</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Mesh3D</span>
<a name="ln-247"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self_sideInfo</span>
<a name="ln-248"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self_nodeCoords</span>
<a name="ln-249"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hohq_cornerNodes</span>
<a name="ln-250"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hohq_elemInfo</span>
<a name="ln-251"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hohq_sideInfo</span>
<a name="ln-252"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hohq_sideSurfaces</span>
<a name="ln-253"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_elemInfo</span>
<a name="ln-254"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_sideInfo</span>
<a name="ln-255"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_nodeCoords</span>
<a name="ln-256"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_globalNodeIDs</span>
<a name="ln-257"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_CGNSCornerMap</span>
<a name="ln-258"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_CGNSSideMap</span>
<a name="ln-259"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self_sideMap</span>
<a name="ln-260"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_curveNodeMap</span>
<a name="ln-261"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_curveNodeMapInv</span>
<a name="ln-262"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BCType</span>
<a name="ln-263"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">255</span><span class="p">),</span><span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">BCNames</span><span class="p">(:)</span>
<a name="ln-264"></a>
<a name="ln-265"></a>  <span class="k">CONTAINS</span>
<a name="ln-266"></a>
<a name="ln-267"></a><span class="k">    PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Init</span> <span class="o">=&gt;</span> <span class="n">Init_Mesh3D</span>
<a name="ln-268"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Free</span> <span class="o">=&gt;</span> <span class="n">Free_Mesh3D</span>
<a name="ln-269"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateHost</span> <span class="o">=&gt;</span> <span class="n">UpdateHost_Mesh3D</span>
<a name="ln-270"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateDevice</span> <span class="o">=&gt;</span> <span class="n">UpdateDevice_Mesh3D</span>
<a name="ln-271"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UniformBlockMesh</span> <span class="o">=&gt;</span> <span class="n">UniformBlockMesh_Mesh3D</span>
<a name="ln-272"></a>
<a name="ln-273"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Load</span> <span class="o">=&gt;</span> <span class="n">Load_Mesh3D_serial</span><span class="p">,</span><span class="n">Load_Mesh3D_parallel</span>
<a name="ln-274"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">Load_Mesh3D_serial</span><span class="p">,</span><span class="n">Load_Mesh3D_parallel</span>
<a name="ln-275"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Read_HOPr</span> <span class="o">=&gt;</span> <span class="n">Read_HOPr_Mesh3D_serial</span><span class="p">,</span><span class="n">Read_HOPr_Mesh3D_parallel</span>
<a name="ln-276"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">Read_HOPr_Mesh3D_serial</span><span class="p">,</span><span class="n">Read_HOPr_Mesh3D_parallel</span>
<a name="ln-277"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Write_HOPr</span> <span class="o">=&gt;</span> <span class="n">Write_HOPr_Mesh3D</span>
<a name="ln-278"></a>
<a name="ln-279"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">RecalculateFlip</span> <span class="o">=&gt;</span> <span class="n">RecalculateFlip_Mesh3D</span>
<a name="ln-280"></a>
<a name="ln-281"></a>  <span class="k">END TYPE </span><span class="n">Mesh3D</span>
<a name="ln-282"></a>
<a name="ln-283"></a><span class="k">CONTAINS</span>
<a name="ln-284"></a>
<a name="ln-285"></a><span class="k">  SUBROUTINE </span><span class="n">Init_Mesh1D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">nNodes</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-286"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-287"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-288"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nGeo</span>
<a name="ln-289"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-290"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nNodes</span>
<a name="ln-291"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nBCs</span>
<a name="ln-292"></a>
<a name="ln-293"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nGeo</span> <span class="o">=</span> <span class="n">nGeo</span>
<a name="ln-294"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-295"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nGlobalElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-296"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nNodes</span> <span class="o">=</span> <span class="n">nNodes</span>
<a name="ln-297"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nCornerNodes</span> <span class="o">=</span> <span class="n">nElem</span><span class="o">*</span><span class="mi">2</span>
<a name="ln-298"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-299"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nBCs</span> <span class="o">=</span> <span class="n">nBCs</span>
<a name="ln-300"></a>
<a name="ln-301"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-302"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-303"></a>
<a name="ln-304"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-305"></a>                                          <span class="n">upBound</span><span class="o">=</span><span class="n">nNodes</span><span class="p">)</span>
<a name="ln-306"></a>
<a name="ln-307"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-308"></a>                                             <span class="n">upBound</span><span class="o">=</span><span class="n">nNodes</span><span class="p">)</span>
<a name="ln-309"></a>
<a name="ln-310"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-311"></a>                                 <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">nBCs</span><span class="o">/</span><span class="p">))</span>
<a name="ln-312"></a>
<a name="ln-313"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCNames</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nBCs</span><span class="p">))</span>
<a name="ln-314"></a>
<a name="ln-315"></a>  <span class="k">END SUBROUTINE </span><span class="n">Init_Mesh1D</span>
<a name="ln-316"></a>
<a name="ln-317"></a>  <span class="k">SUBROUTINE </span><span class="n">Free_Mesh1D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-318"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-319"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-320"></a>
<a name="ln-321"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-322"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-323"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nCornerNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-324"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-325"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nBCs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-326"></a>
<a name="ln-327"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-328"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-329"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-330"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-331"></a>
<a name="ln-332"></a>    <span class="k">DEALLOCATE</span> <span class="p">(</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCNames</span><span class="p">)</span>
<a name="ln-333"></a>
<a name="ln-334"></a>  <span class="k">END SUBROUTINE </span><span class="n">Free_Mesh1D</span>
<a name="ln-335"></a>
<a name="ln-336"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateHost_Mesh1D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-337"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-338"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-339"></a>
<a name="ln-340"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-341"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-342"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-343"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-344"></a>
<a name="ln-345"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateHost_Mesh1D</span>
<a name="ln-346"></a>
<a name="ln-347"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateDevice_Mesh1D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-348"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-349"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-350"></a>
<a name="ln-351"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-352"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-353"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-354"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-355"></a>
<a name="ln-356"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateDevice_Mesh1D</span>
<a name="ln-357"></a>
<a name="ln-358"></a>  <span class="k">SUBROUTINE </span><span class="n">UniformBlockMesh_Mesh1D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<a name="ln-359"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-360"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-361"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nGeo</span>
<a name="ln-362"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-363"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-364"></a>    <span class="c">! Local</span>
<a name="ln-365"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iel</span>
<a name="ln-366"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nid</span><span class="p">,</span><span class="n">nNodes</span>
<a name="ln-367"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-368"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nElem</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-369"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Lagrange</span><span class="p">),</span> <span class="k">TARGET</span> <span class="kd">::</span> <span class="n">linearInterp</span>
<a name="ln-370"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Lagrange</span><span class="p">),</span> <span class="k">TARGET</span> <span class="kd">::</span> <span class="n">nGeoInterp</span>
<a name="ln-371"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xLinear</span>
<a name="ln-372"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xGeo</span>
<a name="ln-373"></a>
<a name="ln-374"></a>    <span class="n">nNodes</span> <span class="o">=</span> <span class="n">nElem</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-375"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">nNodes</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-376"></a>
<a name="ln-377"></a>    <span class="c">! Set the hopr_nodeCoords</span>
<a name="ln-378"></a>    <span class="n">xU</span> <span class="o">=</span> <span class="n">UniformPoints</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">nElem</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-379"></a>
<a name="ln-380"></a>    <span class="k">CALL </span><span class="n">linearInterp</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,&amp;</span>
<a name="ln-381"></a>            <span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">)</span>
<a name="ln-382"></a>
<a name="ln-383"></a>    <span class="k">CALL </span><span class="n">nGeoInterp</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,&amp;</span>
<a name="ln-384"></a>            <span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">)</span>
<a name="ln-385"></a>
<a name="ln-386"></a>    <span class="c">! Create a linear interpolant to interpolate to nGeo grid</span>
<a name="ln-387"></a>    <span class="k">CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">linearInterp</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">)</span>
<a name="ln-388"></a>    <span class="k">CALL </span><span class="n">xGeo</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeoInterp</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">)</span>
<a name="ln-389"></a>
<a name="ln-390"></a>    <span class="k">DO </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span>
<a name="ln-391"></a>      <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">xU</span><span class="p">(</span><span class="n">iel</span><span class="p">:</span><span class="n">iel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-392"></a>    <span class="k">END DO</span>
<a name="ln-393"></a>
<a name="ln-394"></a><span class="k">    CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">GridInterp</span><span class="p">(</span><span class="n">xGeo</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-395"></a>
<a name="ln-396"></a>    <span class="c">! Set the element information</span>
<a name="ln-397"></a>    <span class="n">nid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-398"></a>    <span class="k">DO </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span>
<a name="ln-399"></a>      <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfLineLinear</span> <span class="c">! Element Type</span>
<a name="ln-400"></a>      <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! Element Zone</span>
<a name="ln-401"></a>      <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">nid</span> <span class="c">! Node Index Start</span>
<a name="ln-402"></a>      <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-403"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">nid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xGeo</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span>
<a name="ln-404"></a>        <span class="n">nid</span> <span class="o">=</span> <span class="n">nid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-405"></a>      <span class="k">END DO</span>
<a name="ln-406"></a><span class="k">      </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">nid</span> <span class="o">-</span> <span class="mi">1</span> <span class="c">! Node Index End</span>
<a name="ln-407"></a>    <span class="k">END DO</span>
<a name="ln-408"></a>
<a name="ln-409"></a><span class="k">    CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-410"></a>
<a name="ln-411"></a>    <span class="k">CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-412"></a>    <span class="k">CALL </span><span class="n">xGeo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-413"></a>    <span class="k">CALL </span><span class="n">linearInterp</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-414"></a>    <span class="k">CALL </span><span class="n">nGeoInterp</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-415"></a>
<a name="ln-416"></a>  <span class="k">END SUBROUTINE </span><span class="n">UniformBlockMesh_Mesh1D</span>
<a name="ln-417"></a>
<a name="ln-418"></a>  <span class="k">SUBROUTINE </span><span class="n">Read_HOPr_Mesh1D_serial</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">meshFile</span><span class="p">)</span>
<a name="ln-419"></a>    <span class="c">! From https://www.hopr-project.org/externals/Meshformat.pdf, Algorithm 6</span>
<a name="ln-420"></a>    <span class="c">! Adapted for 1D Mesh : Note that HOPR does not have 1D mesh output.</span>
<a name="ln-421"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-422"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-423"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">meshFile</span>
<a name="ln-424"></a>    <span class="c">! Local</span>
<a name="ln-425"></a>    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">HID_T</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fileId</span>
<a name="ln-426"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGlobalElem</span>
<a name="ln-427"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nLocalNodes</span>
<a name="ln-428"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGeo</span><span class="p">,</span><span class="n">nBCs</span>
<a name="ln-429"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_elemInfo</span>
<a name="ln-430"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_nodeCoords</span>
<a name="ln-431"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_globalNodeIDs</span>
<a name="ln-432"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bcType</span>
<a name="ln-433"></a>
<a name="ln-434"></a>    <span class="k">CALL </span><span class="n">Open_HDF5</span><span class="p">(</span><span class="n">meshFile</span><span class="p">,</span><span class="n">H5F_ACC_RDWR_F</span><span class="p">,</span><span class="n">fileId</span><span class="p">)</span>
<a name="ln-435"></a>
<a name="ln-436"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nElems&#39;</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="p">)</span>
<a name="ln-437"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;Ngeo&#39;</span><span class="p">,</span><span class="n">nGeo</span><span class="p">)</span>
<a name="ln-438"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nBCs&#39;</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-439"></a>
<a name="ln-440"></a>    <span class="c">! Read BCType</span>
<a name="ln-441"></a>    <span class="k">CALL </span><span class="n">bcType</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-442"></a>                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">nBCs</span><span class="o">/</span><span class="p">))</span>
<a name="ln-443"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;BCType&#39;</span><span class="p">,</span><span class="n">bcType</span><span class="p">)</span>
<a name="ln-444"></a>
<a name="ln-445"></a>    <span class="c">! Read local subarray of ElemInfo</span>
<a name="ln-446"></a>    <span class="c">! Allocate Space for hopr_elemInfo!</span>
<a name="ln-447"></a>    <span class="k">CALL </span><span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-448"></a>                               <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-449"></a>
<a name="ln-450"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;ElemInfo&#39;</span><span class="p">,</span><span class="n">hopr_elemInfo</span><span class="p">)</span>
<a name="ln-451"></a>
<a name="ln-452"></a>    <span class="c">! Read local subarray of NodeCoords and GlobalNodeIDs</span>
<a name="ln-453"></a>    <span class="n">nLocalNodes</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="p">)</span> <span class="o">-</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-454"></a>
<a name="ln-455"></a>    <span class="c">! Allocate Space for hopr_nodeCoords and hopr_globalNodeIDs !</span>
<a name="ln-456"></a>    <span class="k">CALL </span><span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-457"></a>                                 <span class="n">upBound</span><span class="o">=</span><span class="n">nLocalNodes</span><span class="p">)</span>
<a name="ln-458"></a>
<a name="ln-459"></a>    <span class="k">CALL </span><span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-460"></a>                                    <span class="n">upBound</span><span class="o">=</span><span class="n">nLocalNodes</span><span class="p">)</span>
<a name="ln-461"></a>
<a name="ln-462"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;NodeCoords&#39;</span><span class="p">,</span><span class="n">hopr_nodeCoords</span><span class="p">)</span>
<a name="ln-463"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;GlobalNodeIDs&#39;</span><span class="p">,</span><span class="n">hopr_globalNodeIDs</span><span class="p">)</span>
<a name="ln-464"></a>
<a name="ln-465"></a>    <span class="k">CALL </span><span class="n">Close_HDF5</span><span class="p">(</span><span class="n">fileID</span><span class="p">)</span>
<a name="ln-466"></a>
<a name="ln-467"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="p">,</span><span class="n">nLocalNodes</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-468"></a>
<a name="ln-469"></a>    <span class="c">! Copy data from local arrays into myMesh</span>
<a name="ln-470"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span>
<a name="ln-471"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="o">=</span> <span class="n">hopr_nodeCoords</span>
<a name="ln-472"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="o">=</span> <span class="n">hopr_globalNodeIDs</span>
<a name="ln-473"></a>
<a name="ln-474"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-475"></a>
<a name="ln-476"></a>    <span class="k">CALL </span><span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-477"></a>    <span class="k">CALL </span><span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-478"></a>    <span class="k">CALL </span><span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-479"></a>
<a name="ln-480"></a>  <span class="k">END SUBROUTINE </span><span class="n">Read_HOPr_Mesh1D_serial</span>
<a name="ln-481"></a>
<a name="ln-482"></a>  <span class="k">SUBROUTINE </span><span class="n">Read_HOPr_Mesh1D_parallel</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">meshFile</span><span class="p">,</span><span class="n">decomp</span><span class="p">)</span>
<a name="ln-483"></a>    <span class="c">! From https://www.hopr-project.org/externals/Meshformat.pdf, Algorithm 6</span>
<a name="ln-484"></a>    <span class="c">! Adapted for 1D Mesh : Note that HOPR does not have 1D mesh output.</span>
<a name="ln-485"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-486"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-487"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">meshFile</span>
<a name="ln-488"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MPILayer</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">decomp</span>
<a name="ln-489"></a>    <span class="c">! Local</span>
<a name="ln-490"></a>    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">HID_T</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fileId</span>
<a name="ln-491"></a>    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">HID_T</span><span class="p">)</span> <span class="kd">::</span> <span class="n">offset</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="n">gOffset</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-492"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGlobalElem</span>
<a name="ln-493"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">firstElem</span><span class="p">,</span><span class="n">nLocalElems</span>
<a name="ln-494"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">firstNode</span><span class="p">,</span><span class="n">nLocalNodes</span>
<a name="ln-495"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGeo</span><span class="p">,</span><span class="n">nBCs</span>
<a name="ln-496"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_elemInfo</span>
<a name="ln-497"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_nodeCoords</span>
<a name="ln-498"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_globalNodeIDs</span>
<a name="ln-499"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bcType</span>
<a name="ln-500"></a>
<a name="ln-501"></a>    <span class="k">CALL </span><span class="n">Open_HDF5</span><span class="p">(</span><span class="n">meshFile</span><span class="p">,</span><span class="n">H5F_ACC_RDWR_F</span><span class="p">,</span><span class="n">fileId</span><span class="p">,</span><span class="n">decomp</span> <span class="p">%</span> <span class="n">mpiComm</span><span class="p">)</span>
<a name="ln-502"></a>
<a name="ln-503"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nElems&#39;</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="p">)</span>
<a name="ln-504"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;Ngeo&#39;</span><span class="p">,</span><span class="n">nGeo</span><span class="p">)</span>
<a name="ln-505"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nBCs&#39;</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-506"></a>
<a name="ln-507"></a>    <span class="k">CALL </span><span class="n">decomp</span> <span class="p">%</span> <span class="n">SetElemToRank</span><span class="p">(</span><span class="n">nGlobalElem</span><span class="p">)</span>
<a name="ln-508"></a>
<a name="ln-509"></a>    <span class="c">! Read BCType</span>
<a name="ln-510"></a>    <span class="k">CALL </span><span class="n">bcType</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-511"></a>                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">nBCs</span><span class="o">/</span><span class="p">))</span>
<a name="ln-512"></a>    <span class="n">offset</span><span class="p">(:)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-513"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;BCType&#39;</span><span class="p">,</span><span class="n">bcType</span><span class="p">,</span><span class="n">offset</span><span class="p">)</span>
<a name="ln-514"></a>
<a name="ln-515"></a>    <span class="c">! Read local subarray of ElemInfo</span>
<a name="ln-516"></a>    <span class="n">firstElem</span> <span class="o">=</span> <span class="n">decomp</span> <span class="p">%</span> <span class="n">offsetElem</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">decomp</span> <span class="p">%</span> <span class="n">rankId</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-517"></a>    <span class="n">nLocalElems</span> <span class="o">=</span> <span class="n">decomp</span> <span class="p">%</span> <span class="n">offsetElem</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">decomp</span> <span class="p">%</span> <span class="n">rankId</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-518"></a>                  <span class="n">decomp</span> <span class="p">%</span> <span class="n">offsetElem</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">decomp</span> <span class="p">%</span> <span class="n">rankId</span><span class="p">)</span>
<a name="ln-519"></a>
<a name="ln-520"></a>    <span class="c">! Allocate Space for hopr_elemInfo!</span>
<a name="ln-521"></a>    <span class="k">CALL </span><span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-522"></a>                               <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span><span class="n">nLocalElems</span><span class="o">/</span><span class="p">))</span>
<a name="ln-523"></a>
<a name="ln-524"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="n">firstElem</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">)</span>
<a name="ln-525"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;ElemInfo&#39;</span><span class="p">,</span><span class="n">hopr_elemInfo</span><span class="p">,</span><span class="n">offset</span><span class="p">)</span>
<a name="ln-526"></a>
<a name="ln-527"></a>    <span class="c">! Read local subarray of NodeCoords and GlobalNodeIDs</span>
<a name="ln-528"></a>    <span class="n">firstNode</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-529"></a>    <span class="n">nLocalNodes</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">nLocalElems</span><span class="p">)</span> <span class="o">-</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-530"></a>
<a name="ln-531"></a>    <span class="c">! Allocate Space for hopr_nodeCoords and hopr_globalNodeIDs !</span>
<a name="ln-532"></a>    <span class="k">CALL </span><span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-533"></a>                                 <span class="n">upBound</span><span class="o">=</span><span class="n">nLocalNodes</span><span class="p">)</span>
<a name="ln-534"></a>
<a name="ln-535"></a>    <span class="k">CALL </span><span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-536"></a>                                    <span class="n">upBound</span><span class="o">=</span><span class="n">nLocalNodes</span><span class="p">)</span>
<a name="ln-537"></a>
<a name="ln-538"></a>    <span class="n">gOffset</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">firstNode</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">)</span>
<a name="ln-539"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;NodeCoords&#39;</span><span class="p">,</span><span class="n">hopr_nodeCoords</span><span class="p">,</span><span class="n">gOffset</span><span class="p">)</span>
<a name="ln-540"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;GlobalNodeIDs&#39;</span><span class="p">,</span><span class="n">hopr_globalNodeIDs</span><span class="p">,</span><span class="n">gOffset</span><span class="p">)</span>
<a name="ln-541"></a>
<a name="ln-542"></a>    <span class="k">CALL </span><span class="n">Close_HDF5</span><span class="p">(</span><span class="n">fileID</span><span class="p">)</span>
<a name="ln-543"></a>
<a name="ln-544"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nLocalElems</span><span class="p">,</span><span class="n">nLocalNodes</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-545"></a>
<a name="ln-546"></a>    <span class="c">! Copy data from local arrays into myMesh</span>
<a name="ln-547"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span>
<a name="ln-548"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="o">=</span> <span class="n">hopr_nodeCoords</span>
<a name="ln-549"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="o">=</span> <span class="n">hopr_globalNodeIDs</span>
<a name="ln-550"></a>
<a name="ln-551"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-552"></a>
<a name="ln-553"></a>    <span class="k">CALL </span><span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-554"></a>    <span class="k">CALL </span><span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-555"></a>    <span class="k">CALL </span><span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-556"></a>
<a name="ln-557"></a>  <span class="k">END SUBROUTINE </span><span class="n">Read_HOPr_Mesh1D_parallel</span>
<a name="ln-558"></a>
<a name="ln-559"></a>  <span class="k">SUBROUTINE </span><span class="n">Write_HOPr_Mesh1D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">meshFile</span><span class="p">)</span>
<a name="ln-560"></a>    <span class="c">! Writes mesh output in HOPR format (serial IO only)</span>
<a name="ln-561"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-562"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-563"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">meshFile</span>
<a name="ln-564"></a>    <span class="c">! Local</span>
<a name="ln-565"></a>    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">HID_T</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fileId</span>
<a name="ln-566"></a>
<a name="ln-567"></a>    <span class="k">CALL </span><span class="n">Open_HDF5</span><span class="p">(</span><span class="n">meshFile</span><span class="p">,</span><span class="n">H5F_ACC_RDWR_F</span><span class="p">,</span><span class="n">fileId</span><span class="p">)</span>
<a name="ln-568"></a>
<a name="ln-569"></a>    <span class="k">CALL </span><span class="n">WriteAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nElems&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-570"></a>    <span class="k">CALL </span><span class="n">WriteAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;Ngeo&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nGeo</span><span class="p">)</span>
<a name="ln-571"></a>    <span class="k">CALL </span><span class="n">WriteAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nBCs&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nBCs</span><span class="p">)</span>
<a name="ln-572"></a>
<a name="ln-573"></a>    <span class="k">CALL </span><span class="n">WriteArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;BCType&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">bcType</span><span class="p">)</span>
<a name="ln-574"></a>
<a name="ln-575"></a>    <span class="c">! Read local subarray of ElemInfo</span>
<a name="ln-576"></a>    <span class="k">CALL </span><span class="n">WriteArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;ElemInfo&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span><span class="p">)</span>
<a name="ln-577"></a>
<a name="ln-578"></a>    <span class="c">! Read local subarray of NodeCoords and GlobalNodeIDs</span>
<a name="ln-579"></a>    <span class="k">CALL </span><span class="n">WriteArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;NodeCoords&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span><span class="p">)</span>
<a name="ln-580"></a>    <span class="k">CALL </span><span class="n">WriteArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;GlobalNodeIDs&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span><span class="p">)</span>
<a name="ln-581"></a>
<a name="ln-582"></a>    <span class="k">CALL </span><span class="n">Close_HDF5</span><span class="p">(</span><span class="n">fileID</span><span class="p">)</span>
<a name="ln-583"></a>
<a name="ln-584"></a>  <span class="k">END SUBROUTINE </span><span class="n">Write_HOPr_Mesh1D</span>
<a name="ln-585"></a>
<a name="ln-586"></a>  <span class="k">SUBROUTINE </span><span class="n">Init_Mesh2D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">nSides</span><span class="p">,</span><span class="n">nNodes</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-587"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-588"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-589"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nGeo</span>
<a name="ln-590"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-591"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nSides</span>
<a name="ln-592"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nNodes</span>
<a name="ln-593"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nBCs</span>
<a name="ln-594"></a>    <span class="c">! Local</span>
<a name="ln-595"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">l</span>
<a name="ln-596"></a>
<a name="ln-597"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nGeo</span> <span class="o">=</span> <span class="n">nGeo</span>
<a name="ln-598"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-599"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nGlobalElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-600"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nNodes</span> <span class="o">=</span> <span class="n">nNodes</span>
<a name="ln-601"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nSides</span> <span class="o">=</span> <span class="n">nSides</span>
<a name="ln-602"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nCornerNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-603"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-604"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-605"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nBCs</span> <span class="o">=</span> <span class="n">nBCs</span>
<a name="ln-606"></a>
<a name="ln-607"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-608"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-609"></a>
<a name="ln-610"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-611"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-612"></a>
<a name="ln-613"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-614"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">nSides</span><span class="o">/</span><span class="p">))</span>
<a name="ln-615"></a>
<a name="ln-616"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-617"></a>                                          <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">nNodes</span><span class="o">/</span><span class="p">))</span>
<a name="ln-618"></a>
<a name="ln-619"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_nodeCoords</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-620"></a>                                          <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-621"></a>
<a name="ln-622"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-623"></a>                                             <span class="n">upBound</span><span class="o">=</span><span class="n">nNodes</span><span class="p">)</span>
<a name="ln-624"></a>
<a name="ln-625"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-626"></a>                                             <span class="n">upBound</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-627"></a>
<a name="ln-628"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-629"></a>                                           <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="p">))</span>
<a name="ln-630"></a>
<a name="ln-631"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_curveNodeMap</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-632"></a>                                            <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">))</span>
<a name="ln-633"></a>
<a name="ln-634"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_curveNodeMapInv</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-635"></a>                                               <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nGeo</span><span class="o">/</span><span class="p">))</span>
<a name="ln-636"></a>
<a name="ln-637"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-638"></a>                                 <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">nBCs</span><span class="o">/</span><span class="p">))</span>
<a name="ln-639"></a>
<a name="ln-640"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCNames</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nBCs</span><span class="p">))</span>
<a name="ln-641"></a>
<a name="ln-642"></a>    <span class="c">! Create lookup tables to assist with connectivity generation</span>
<a name="ln-643"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-644"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-645"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-646"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">nGeo</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-647"></a>
<a name="ln-648"></a>    <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-649"></a>    <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-650"></a>      <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-651"></a>        <span class="n">l</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-652"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_curveNodeMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">/</span><span class="p">)</span>
<a name="ln-653"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_curveNodeMapInv</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">l</span>
<a name="ln-654"></a>      <span class="k">END DO</span>
<a name="ln-655"></a><span class="k">    END DO</span>
<a name="ln-656"></a>
<a name="ln-657"></a>    <span class="c">! Maps from local corner node id to CGNS side</span>
<a name="ln-658"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="p">)</span>
<a name="ln-659"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="p">)</span>
<a name="ln-660"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="p">)</span>
<a name="ln-661"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="p">)</span>
<a name="ln-662"></a>
<a name="ln-663"></a>  <span class="k">END SUBROUTINE </span><span class="n">Init_Mesh2D</span>
<a name="ln-664"></a>
<a name="ln-665"></a>  <span class="k">SUBROUTINE </span><span class="n">Free_Mesh2D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-666"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-667"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-668"></a>
<a name="ln-669"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-670"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-671"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nSides</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-672"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nCornerNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-673"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-674"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-675"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nBCs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-676"></a>
<a name="ln-677"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-678"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-679"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-680"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-681"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_nodeCoords</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-682"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-683"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-684"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-685"></a>
<a name="ln-686"></a>    <span class="k">DEALLOCATE</span> <span class="p">(</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCNames</span><span class="p">)</span>
<a name="ln-687"></a>
<a name="ln-688"></a>  <span class="k">END SUBROUTINE </span><span class="n">Free_Mesh2D</span>
<a name="ln-689"></a>
<a name="ln-690"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateHost_Mesh2D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-691"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-692"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-693"></a>
<a name="ln-694"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-695"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-696"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-697"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-698"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_nodeCoords</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-699"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-700"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-701"></a>
<a name="ln-702"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateHost_Mesh2D</span>
<a name="ln-703"></a>
<a name="ln-704"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateDevice_Mesh2D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-705"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-706"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-707"></a>
<a name="ln-708"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-709"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-710"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-711"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-712"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_nodeCoords</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-713"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-714"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-715"></a>
<a name="ln-716"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateDevice_Mesh2D</span>
<a name="ln-717"></a>
<a name="ln-718"></a>  <span class="k">SUBROUTINE </span><span class="n">UniformBlockMesh_Mesh2D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<a name="ln-719"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-720"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-721"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nGeo</span>
<a name="ln-722"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-723"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-724"></a>    <span class="c">! Local</span>
<a name="ln-725"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iel</span><span class="p">,</span><span class="n">jel</span><span class="p">,</span><span class="n">nEl</span><span class="p">,</span><span class="n">elid</span>
<a name="ln-726"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">sid</span><span class="p">,</span><span class="n">nid</span><span class="p">,</span><span class="n">nNodes</span>
<a name="ln-727"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nSides</span>
<a name="ln-728"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span>
<a name="ln-729"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-730"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">yU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-731"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Lagrange</span><span class="p">),</span> <span class="k">TARGET</span> <span class="kd">::</span> <span class="n">linearInterp</span>
<a name="ln-732"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Lagrange</span><span class="p">),</span> <span class="k">TARGET</span> <span class="kd">::</span> <span class="n">nGeoInterp</span>
<a name="ln-733"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xLinear</span>
<a name="ln-734"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xGeo</span>
<a name="ln-735"></a>
<a name="ln-736"></a>    <span class="n">nEl</span> <span class="o">=</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-737"></a>    <span class="n">nNodes</span> <span class="o">=</span> <span class="n">nEl</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-738"></a>    <span class="n">nSides</span> <span class="o">=</span> <span class="n">nEl</span><span class="o">*</span><span class="mi">4</span>
<a name="ln-739"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nEl</span><span class="p">,</span><span class="n">nSides</span><span class="p">,</span><span class="n">nNodes</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-740"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span> <span class="o">=</span> <span class="p">(</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-741"></a>
<a name="ln-742"></a>    <span class="c">! Set the hopr_nodeCoords</span>
<a name="ln-743"></a>    <span class="n">xU</span> <span class="o">=</span> <span class="n">UniformPoints</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-744"></a>    <span class="n">yU</span> <span class="o">=</span> <span class="n">UniformPoints</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">x</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-745"></a>
<a name="ln-746"></a>    <span class="k">CALL </span><span class="n">linearInterp</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,&amp;</span>
<a name="ln-747"></a>            <span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">)</span>
<a name="ln-748"></a>
<a name="ln-749"></a>    <span class="k">CALL </span><span class="n">nGeoInterp</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,&amp;</span>
<a name="ln-750"></a>            <span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">)</span>
<a name="ln-751"></a>
<a name="ln-752"></a>    <span class="c">! Create a linear interpolant to interpolate to nGeo grid</span>
<a name="ln-753"></a>    <span class="k">CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">linearInterp</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nEl</span><span class="p">)</span>
<a name="ln-754"></a>    <span class="k">CALL </span><span class="n">xGeo</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeoInterp</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nEl</span><span class="p">)</span>
<a name="ln-755"></a>
<a name="ln-756"></a>    <span class="n">elid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-757"></a>    <span class="k">DO </span><span class="n">jel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-758"></a>      <span class="k">DO </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-759"></a>        <span class="c">! x component</span>
<a name="ln-760"></a>        <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xU</span><span class="p">(</span><span class="n">iel</span><span class="p">:</span><span class="n">iel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-761"></a>        <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xU</span><span class="p">(</span><span class="n">iel</span><span class="p">:</span><span class="n">iel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-762"></a>        <span class="c">! y component</span>
<a name="ln-763"></a>        <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">yU</span><span class="p">(</span><span class="n">jel</span><span class="p">:</span><span class="n">jel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-764"></a>        <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">yU</span><span class="p">(</span><span class="n">jel</span><span class="p">:</span><span class="n">jel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-765"></a>        <span class="c">! Incremenent the element ID</span>
<a name="ln-766"></a>        <span class="n">elid</span> <span class="o">=</span> <span class="n">elid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-767"></a>      <span class="k">END DO</span>
<a name="ln-768"></a><span class="k">    END DO</span>
<a name="ln-769"></a>
<a name="ln-770"></a><span class="k">    CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">GridInterp</span><span class="p">(</span><span class="n">xGeo</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-771"></a>
<a name="ln-772"></a>    <span class="c">! Set the element information</span>
<a name="ln-773"></a>    <span class="n">nid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-774"></a>    <span class="n">sid</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-775"></a>    <span class="n">elid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-776"></a>    <span class="k">DO </span><span class="n">jel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-777"></a>      <span class="k">DO </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-778"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfQuadLinear</span> <span class="c">! Element Type</span>
<a name="ln-779"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! Element Zone</span>
<a name="ln-780"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">sid</span> <span class="c">! Side Index Start</span>
<a name="ln-781"></a>        <span class="n">sid</span> <span class="o">=</span> <span class="n">sid</span> <span class="o">+</span> <span class="mi">4</span>
<a name="ln-782"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">sid</span> <span class="c">! Side Index End</span>
<a name="ln-783"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">nid</span> <span class="o">-</span> <span class="mi">1</span> <span class="c">! Node Index Start</span>
<a name="ln-784"></a>        <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-785"></a>          <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-786"></a>            <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">nid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xGeo</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span>
<a name="ln-787"></a>            <span class="n">nid</span> <span class="o">=</span> <span class="n">nid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-788"></a>          <span class="k">END DO</span>
<a name="ln-789"></a><span class="k">        END DO</span>
<a name="ln-790"></a><span class="k">        </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">nid</span> <span class="c">! Node Index End</span>
<a name="ln-791"></a>        <span class="n">elid</span> <span class="o">=</span> <span class="n">elid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-792"></a>      <span class="k">END DO</span>
<a name="ln-793"></a><span class="k">    END DO</span>
<a name="ln-794"></a>
<a name="ln-795"></a><span class="k">    CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">GenerateConnectivity</span><span class="p">()</span>
<a name="ln-796"></a>
<a name="ln-797"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-798"></a>
<a name="ln-799"></a>    <span class="k">CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-800"></a>    <span class="k">CALL </span><span class="n">xGeo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-801"></a>    <span class="k">CALL </span><span class="n">linearInterp</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-802"></a>    <span class="k">CALL </span><span class="n">nGeoInterp</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-803"></a>
<a name="ln-804"></a>  <span class="k">END SUBROUTINE </span><span class="n">UniformBlockMesh_Mesh2D</span>
<a name="ln-805"></a>
<a name="ln-806"></a>  <span class="k">SUBROUTINE </span><span class="n">Load_Mesh2D_serial</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">myMeshSpec</span><span class="p">)</span>
<a name="ln-807"></a><span class="cp">#undef __FUNC__</span>
<a name="ln-808"></a><span class="cp">#define __FUNC__ &quot;Load_Mesh2D&quot;</span>
<a name="ln-809"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-810"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-811"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MeshSpec</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMeshSpec</span>
<a name="ln-812"></a>
<a name="ln-813"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-814"></a>
<a name="ln-815"></a><span class="k">      CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UniformBlockMesh</span><span class="p">(</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_nGeo</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-816"></a>                                     <span class="p">(</span><span class="o">/</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_nElemX</span><span class="p">,</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_nElemY</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-817"></a>                                     <span class="p">(</span><span class="o">/</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_x0</span><span class="p">,</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_x1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-818"></a>                                       <span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_y0</span><span class="p">,</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_y1</span><span class="o">/</span><span class="p">))</span>
<a name="ln-819"></a>    <span class="k">ELSE</span>
<a name="ln-820"></a>
<a name="ln-821"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">fileType</span> <span class="o">==</span> <span class="n">SELF_MESH_ISM_V2_2D</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-822"></a>
<a name="ln-823"></a><span class="k">        CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Read_ISMv2</span><span class="p">(</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">filename</span><span class="p">)</span>
<a name="ln-824"></a>
<a name="ln-825"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">fileType</span> <span class="o">==</span> <span class="n">SELF_MESH_HOPR_2D</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-826"></a>
<a name="ln-827"></a><span class="k">        CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Read_HOPr</span><span class="p">(</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">filename</span><span class="p">)</span>
<a name="ln-828"></a>
<a name="ln-829"></a>      <span class="n">ENDIF</span>
<a name="ln-830"></a>
<a name="ln-831"></a>
<a name="ln-832"></a>    <span class="k">END IF</span>
<a name="ln-833"></a>
<a name="ln-834"></a><span class="k">    CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-835"></a>
<a name="ln-836"></a>  <span class="k">END SUBROUTINE </span><span class="n">Load_Mesh2D_serial</span>
<a name="ln-837"></a>
<a name="ln-838"></a>  <span class="k">SUBROUTINE </span><span class="n">Load_Mesh2D_parallel</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">myMeshSpec</span><span class="p">,</span><span class="n">decomp</span><span class="p">)</span>
<a name="ln-839"></a><span class="cp">#undef __FUNC__</span>
<a name="ln-840"></a><span class="cp">#define __FUNC__ &quot;Load_Mesh2D&quot;</span>
<a name="ln-841"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-842"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-843"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MeshSpec</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMeshSpec</span>
<a name="ln-844"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MPILayer</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">decomp</span>
<a name="ln-845"></a>
<a name="ln-846"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-847"></a>
<a name="ln-848"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">decomp</span> <span class="p">%</span> <span class="n">nRanks</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Error out</span>
<a name="ln-849"></a>        <span class="n">ERROR</span><span class="p">(</span><span class="s2">&quot;Block Mesh only supported in serial&quot;</span><span class="p">)</span>
<a name="ln-850"></a>        <span class="k">STOP</span> <span class="c">! TO DO : Safe exit</span>
<a name="ln-851"></a>      <span class="k">ELSE</span>
<a name="ln-852"></a><span class="k">        CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UniformBlockMesh</span><span class="p">(</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_nGeo</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-853"></a>                                       <span class="p">(</span><span class="o">/</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_nElemX</span><span class="p">,</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_nElemY</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-854"></a>                                       <span class="p">(</span><span class="o">/</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_x0</span><span class="p">,</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_x1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-855"></a>                                         <span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_y0</span><span class="p">,</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_y1</span><span class="o">/</span><span class="p">))</span>
<a name="ln-856"></a>      <span class="k">END IF</span>
<a name="ln-857"></a>
<a name="ln-858"></a><span class="k">    ELSE</span>
<a name="ln-859"></a>
<a name="ln-860"></a><span class="k">      CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Read_HOPr</span><span class="p">(</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">filename</span><span class="p">,</span><span class="n">decomp</span><span class="p">)</span>
<a name="ln-861"></a>
<a name="ln-862"></a>    <span class="k">END IF</span>
<a name="ln-863"></a>
<a name="ln-864"></a><span class="k">    CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-865"></a>
<a name="ln-866"></a>  <span class="k">END SUBROUTINE </span><span class="n">Load_Mesh2D_parallel</span>
<a name="ln-867"></a>
<a name="ln-868"></a>  <span class="k">SUBROUTINE </span><span class="n">Read_ISMv2_Mesh2D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">meshFile</span><span class="p">)</span>
<a name="ln-869"></a><span class="cp">#undef __FUNC__</span>
<a name="ln-870"></a><span class="cp">#define __FUNC__ &quot;Read_ISMv2_Mesh2D&quot;</span>
<a name="ln-871"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-872"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-873"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">meshFile</span>
<a name="ln-874"></a>    <span class="c">! Local</span>
<a name="ln-875"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nNodes</span><span class="p">,</span><span class="n">nSides</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-876"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">lnid</span><span class="p">,</span><span class="n">nid</span><span class="p">,</span><span class="n">usid</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">sid</span><span class="p">,</span><span class="n">eid</span>
<a name="ln-877"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">fUnit</span>
<a name="ln-878"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span>
<a name="ln-879"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="kd">::</span> <span class="n">line</span>
<a name="ln-880"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span> <span class="kd">::</span> <span class="n">msg</span>
<a name="ln-881"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span><span class="n">x0</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="n">x1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-882"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wSurf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="n">eSurf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="n">nSurf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="n">sSurf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-883"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">P1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="n">P2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-884"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">l1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="n">l2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-885"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">se</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="n">sw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="n">ne</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="n">nw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-886"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">bCurveFlag</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-887"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Lagrange</span><span class="p">)</span> <span class="kd">::</span> <span class="n">interp</span>
<a name="ln-888"></a>
<a name="ln-889"></a>    <span class="k">OPEN</span> <span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">NEWUNIT</span><span class="p">(</span><span class="n">fUnit</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-890"></a>          <span class="k">FILE</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">meshFile</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-891"></a>          <span class="n">FORM</span><span class="o">=</span><span class="s1">&#39;FORMATTED&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-892"></a>          <span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;OLD&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-893"></a>          <span class="nb">ACCESS</span><span class="o">=</span><span class="s1">&#39;SEQUENTIAL&#39;</span><span class="p">)</span>
<a name="ln-894"></a>
<a name="ln-895"></a>    <span class="k">READ</span> <span class="p">(</span><span class="n">fUnit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">line</span>
<a name="ln-896"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;ISM-V2&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-897"></a><span class="k">      </span><span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Unrecognized file format : &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-898"></a>      <span class="n">ERROR</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a name="ln-899"></a>      <span class="k">STOP</span>
<a name="ln-900"></a><span class="k">    END IF</span>
<a name="ln-901"></a>
<a name="ln-902"></a>    <span class="c">! Number of Nodes, Number of Edges (sides; unique!), number of elements, polynomial degree of elements</span>
<a name="ln-903"></a>    <span class="k">READ</span> <span class="p">(</span><span class="n">fUnit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">nNodes</span><span class="p">,</span><span class="n">nSides</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-904"></a>
<a name="ln-905"></a>    <span class="c">! HOHQMesh reports interpolant data on Chebyshev Lobatto points</span>
<a name="ln-906"></a>    <span class="c">! We want data to be interpolated to Legendre Gauss Lobatto points</span>
<a name="ln-907"></a>    <span class="k">CALL </span><span class="n">interp</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">)</span>
<a name="ln-908"></a>
<a name="ln-909"></a>    <span class="c">! When we initialize the mesh, we set nNodes=nElem*4*(nGeo+1)**2 and</span>
<a name="ln-910"></a>    <span class="c">! nSides = nElem*4 since we still use `nNodes` and `nSides`</span>
<a name="ln-911"></a>    <span class="c">! in the input correspond to the HOPR definitions of these</span>
<a name="ln-912"></a>    <span class="c">! variables.</span>
<a name="ln-913"></a>    <span class="c">! `nSides` in HOHQMesh corresponds to nUniqueSides in HOPR and SELF</span>
<a name="ln-914"></a>    <span class="c">! `nNodes` in HOHQMesh corresponds to nCornerNodes (unique) in HOPR and SELF</span>
<a name="ln-915"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">nElem</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span><span class="n">nElem</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">self_nBCsDefault</span><span class="p">)</span>
<a name="ln-916"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span> <span class="o">=</span> <span class="n">nSides</span>
<a name="ln-917"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nCornerNodes</span> <span class="o">=</span> <span class="n">nNodes</span>
<a name="ln-918"></a>
<a name="ln-919"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_cornerNodes</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">((</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-920"></a>                                           <span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">nNodes</span><span class="o">/</span><span class="p">))</span>
<a name="ln-921"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_sideInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">((</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-922"></a>                                        <span class="p">(</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span><span class="n">nSides</span><span class="o">/</span><span class="p">))</span>
<a name="ln-923"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_elemInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">((</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-924"></a>                                        <span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-925"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_sideCurves</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">((</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-926"></a>                                          <span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-927"></a>
<a name="ln-928"></a>    <span class="k">DO </span><span class="n">nid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nCornerNodes</span>
<a name="ln-929"></a>      <span class="k">READ</span> <span class="p">(</span><span class="n">fUnit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">x</span>
<a name="ln-930"></a>      <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_cornerNodes</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">nid</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-931"></a>    <span class="k">END DO</span>
<a name="ln-932"></a>
<a name="ln-933"></a><span class="k">    DO </span><span class="n">usid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span>
<a name="ln-934"></a>      <span class="k">READ</span> <span class="p">(</span><span class="n">fUnit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="n">usid</span><span class="p">)</span>
<a name="ln-935"></a>    <span class="k">END DO</span>
<a name="ln-936"></a>
<a name="ln-937"></a><span class="k">    DO </span><span class="n">eid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-938"></a>      <span class="k">READ</span> <span class="p">(</span><span class="n">fUnit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span>
<a name="ln-939"></a>      <span class="k">READ</span> <span class="p">(</span><span class="n">fUnit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">bCurveFlag</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-940"></a>      <span class="k">DO </span><span class="n">lsid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-941"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">bCurveFlag</span><span class="p">(</span><span class="n">lsid</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-942"></a><span class="k">          DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-943"></a>            <span class="k">READ</span> <span class="p">(</span><span class="n">fUnit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">x</span>
<a name="ln-944"></a>            <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_sideCurves</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-945"></a>          <span class="k">END DO</span>
<a name="ln-946"></a><span class="k">        ELSE</span>
<a name="ln-947"></a>
<a name="ln-948"></a>          <span class="c">! For non-polynomial sides, create the side curve through interpolation between corner nodes</span>
<a name="ln-949"></a>          <span class="n">lnid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">lsid</span><span class="p">)</span>
<a name="ln-950"></a>          <span class="n">nid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">lnid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span>
<a name="ln-951"></a>          <span class="n">x0</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_cornerNodes</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">nid</span><span class="p">)</span>
<a name="ln-952"></a>
<a name="ln-953"></a>          <span class="n">lnid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">lsid</span><span class="p">)</span>
<a name="ln-954"></a>          <span class="n">nid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">lnid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span>
<a name="ln-955"></a>          <span class="n">x1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_cornerNodes</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">nid</span><span class="p">)</span>
<a name="ln-956"></a>
<a name="ln-957"></a>          <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-958"></a>            <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_sideCurves</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5_prec</span><span class="o">*</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-959"></a>                                                           <span class="n">x0</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0_prec</span> <span class="o">-</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">controlPoints</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-960"></a>                                                              <span class="n">x1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">interp</span> <span class="p">%</span> <span class="n">controlPoints</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0_prec</span><span class="p">))</span>
<a name="ln-961"></a>          <span class="k">END DO</span>
<a name="ln-962"></a>
<a name="ln-963"></a><span class="k">        END IF</span>
<a name="ln-964"></a><span class="k">      END DO</span>
<a name="ln-965"></a><span class="k">      READ</span> <span class="p">(</span><span class="n">fUnit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">line</span>
<a name="ln-966"></a>      <span class="c">! TO DO : Parse line for boundary conditions</span>
<a name="ln-967"></a>    <span class="k">END DO</span>
<a name="ln-968"></a>
<a name="ln-969"></a><span class="k">    CLOSE</span> <span class="p">(</span><span class="n">fUnit</span><span class="p">)</span>
<a name="ln-970"></a>
<a name="ln-971"></a>    <span class="c">! Fill in hopr_elemInfo</span>
<a name="ln-972"></a>    <span class="c">! To fill in the element info, we apply the assumption of a mesh with all quadrilateral elements</span>
<a name="ln-973"></a>    <span class="c">! with uniform polynomial order</span>
<a name="ln-974"></a>    <span class="n">sid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-975"></a>    <span class="n">nid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-976"></a>    <span class="k">DO </span><span class="n">eid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-977"></a>      <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfQuadLinear</span> <span class="c">! Element Type</span>
<a name="ln-978"></a>      <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! Element Zone</span>
<a name="ln-979"></a>      <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="n">sid</span> <span class="c">! Side Index Start</span>
<a name="ln-980"></a>      <span class="n">sid</span> <span class="o">=</span> <span class="n">sid</span> <span class="o">+</span> <span class="mi">4</span>
<a name="ln-981"></a>      <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="n">sid</span> <span class="c">! Side Index End</span>
<a name="ln-982"></a>      <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="n">nid</span> <span class="o">-</span> <span class="mi">1</span> <span class="c">! Node Index Start</span>
<a name="ln-983"></a>      <span class="n">nid</span> <span class="o">=</span> <span class="n">nid</span> <span class="o">+</span> <span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-984"></a>      <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="n">nid</span> <span class="c">! Node Index End</span>
<a name="ln-985"></a>    <span class="k">END DO</span>
<a name="ln-986"></a>
<a name="ln-987"></a>    <span class="c">! Generate the self_nodeCoords through transfinite interpolation with linear blending</span>
<a name="ln-988"></a>    <span class="n">nid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-989"></a>    <span class="k">DO </span><span class="n">eid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-990"></a>      <span class="n">lnid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-991"></a>      <span class="c">! Evaluate for corner points of mapping. This requires computational coordinates</span>
<a name="ln-992"></a>      <span class="c">! that include -1 and 1 in each computational direction (e.g. Gauss Lobatto)</span>
<a name="ln-993"></a>      <span class="n">sw</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_sideCurves</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span>
<a name="ln-994"></a>      <span class="n">se</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_sideCurves</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span>
<a name="ln-995"></a>      <span class="n">ne</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_sideCurves</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span>
<a name="ln-996"></a>      <span class="n">nw</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_sideCurves</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span>
<a name="ln-997"></a>      <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-998"></a>        <span class="n">wSurf</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_sideCurves</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span>
<a name="ln-999"></a>        <span class="n">eSurf</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_sideCurves</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span>
<a name="ln-1000"></a>        <span class="n">l2</span> <span class="o">=</span> <span class="n">LinearBlend</span><span class="p">(</span><span class="n">interp</span> <span class="p">%</span> <span class="n">controlPoints</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
<a name="ln-1001"></a>        <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-1002"></a>          <span class="n">sSurf</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_sideCurves</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span>
<a name="ln-1003"></a>          <span class="n">nSurf</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hohq_sideCurves</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span>
<a name="ln-1004"></a>          <span class="n">l1</span> <span class="o">=</span> <span class="n">LinearBlend</span><span class="p">(</span><span class="n">interp</span> <span class="p">%</span> <span class="n">controlPoints</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-1005"></a>
<a name="ln-1006"></a>          <span class="n">P1</span> <span class="o">=</span> <span class="n">l1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">wSurf</span> <span class="o">+</span> <span class="n">l1</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">eSurf</span>
<a name="ln-1007"></a>          <span class="n">P2</span> <span class="o">=</span> <span class="n">l2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sSurf</span> <span class="o">+</span> <span class="n">l2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">nSurf</span>
<a name="ln-1008"></a>
<a name="ln-1009"></a>          <span class="c">! Apply transfinite interpolation with linear blending</span>
<a name="ln-1010"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">lnid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="n">P1</span> <span class="o">+</span> <span class="n">P2</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1011"></a>                                                              <span class="n">l1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">l2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sw</span> <span class="o">+</span> <span class="n">l2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">nw</span><span class="p">)</span> <span class="o">-</span> <span class="n">l1</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">l2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">se</span> <span class="o">+</span> <span class="n">l2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ne</span><span class="p">)</span>
<a name="ln-1012"></a>
<a name="ln-1013"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">nid</span><span class="p">)</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">lnid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span>
<a name="ln-1014"></a>
<a name="ln-1015"></a>          <span class="c">! Increment node ids</span>
<a name="ln-1016"></a>          <span class="n">nid</span> <span class="o">=</span> <span class="n">nid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1017"></a>          <span class="n">lnid</span> <span class="o">=</span> <span class="n">lnid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1018"></a>
<a name="ln-1019"></a>        <span class="k">END DO</span>
<a name="ln-1020"></a><span class="k">      END DO</span>
<a name="ln-1021"></a><span class="k">    END DO</span>
<a name="ln-1022"></a>
<a name="ln-1023"></a>    <span class="c">!CALL myMesh % GenerateConnectivity()</span>
<a name="ln-1024"></a>    <span class="c">! TO DO : Fill in self_sideInfo from hohq_sideInfo</span>
<a name="ln-1025"></a>    <span class="c">! hohq_sideInfo</span>
<a name="ln-1026"></a>    <span class="c">!    1 - start node ID</span>
<a name="ln-1027"></a>    <span class="c">!    2 - end node ID</span>
<a name="ln-1028"></a>    <span class="c">!    3 - element ID on the left</span>
<a name="ln-1029"></a>    <span class="c">!    4 - element ID on the right</span>
<a name="ln-1030"></a>    <span class="c">!    5 - local side of left element</span>
<a name="ln-1031"></a>    <span class="c">!    6 - local side of right element (negative if flipped)</span>
<a name="ln-1032"></a>    <span class="c">!</span>
<a name="ln-1033"></a>    <span class="c">! self_sideInfo</span>
<a name="ln-1034"></a>    <span class="c">!   1 - side type</span>
<a name="ln-1035"></a>    <span class="c">!   2 - global side id</span>
<a name="ln-1036"></a>    <span class="c">!   3 - neighbor element id</span>
<a name="ln-1037"></a>    <span class="c">!   4 - encoding for neighbor side id and flip (10*s2 + flip)</span>
<a name="ln-1038"></a>    <span class="c">!   5 - boundary condition ID</span>
<a name="ln-1039"></a>
<a name="ln-1040"></a>
<a name="ln-1041"></a>    <span class="k">CALL </span><span class="n">interp</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1042"></a>
<a name="ln-1043"></a>  <span class="k">END SUBROUTINE </span><span class="n">Read_ISMv2_Mesh2D</span>
<a name="ln-1044"></a>
<a name="ln-1045"></a>  <span class="k">SUBROUTINE </span><span class="n">GenerateConnectivity_Mesh2D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-1046"></a><span class="cp">#undef __FUNC__</span>
<a name="ln-1047"></a><span class="cp">#define __FUNC__ &quot;GenerateConnectivity_Mesh2D&quot;</span>
<a name="ln-1048"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1049"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-1050"></a>    <span class="c">! Local</span>
<a name="ln-1051"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nid</span><span class="p">,</span><span class="n">unid</span><span class="p">,</span><span class="n">cnid</span><span class="p">,</span><span class="n">lnid</span><span class="p">,</span><span class="n">rnid</span>
<a name="ln-1052"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">eid</span><span class="p">,</span><span class="n">sid</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">usid</span><span class="p">,</span><span class="n">gn1</span><span class="p">,</span><span class="n">gn2</span>
<a name="ln-1053"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">key1</span><span class="p">,</span><span class="n">key2</span><span class="p">,</span><span class="n">e2</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">e2gn1</span>
<a name="ln-1054"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nUniqueSides</span><span class="p">,</span><span class="n">flip</span>
<a name="ln-1055"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">side</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span><span class="p">)</span>
<a name="ln-1056"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">HashTable</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sideTable</span>
<a name="ln-1057"></a>
<a name="ln-1058"></a>    <span class="c">! Set the globalNodeIDs</span>
<a name="ln-1059"></a>    <span class="c">!  &gt; Nodes in the nodeCoords list are possibly repeated since elements may share common sides. When the sides are shared</span>
<a name="ln-1060"></a>    <span class="c">!    the nodeCoords have the same x,y values (to machine precision)</span>
<a name="ln-1061"></a>
<a name="ln-1062"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1063"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1064"></a>    <span class="k">DO </span><span class="n">nid</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nNodes</span>
<a name="ln-1065"></a>
<a name="ln-1066"></a>      <span class="n">unid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1067"></a>      <span class="k">DO </span><span class="n">rnid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nid</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-1068"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AlmostEqual</span><span class="p">(</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nid</span><span class="p">),</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">rnid</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1069"></a>            <span class="n">AlmostEqual</span><span class="p">(</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">nid</span><span class="p">),</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">rnid</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-1070"></a>
<a name="ln-1071"></a><span class="k">          </span><span class="n">unid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">rnid</span><span class="p">)</span>
<a name="ln-1072"></a>          <span class="k">EXIT</span>
<a name="ln-1073"></a>
<a name="ln-1074"></a><span class="k">        END IF</span>
<a name="ln-1075"></a><span class="k">      END DO</span>
<a name="ln-1076"></a>
<a name="ln-1077"></a><span class="k">      </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">nid</span><span class="p">)</span> <span class="o">=</span> <span class="n">unid</span>
<a name="ln-1078"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">unid</span> <span class="o">==</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1079"></a><span class="k">        </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1080"></a>      <span class="k">END IF</span>
<a name="ln-1081"></a>
<a name="ln-1082"></a><span class="k">    END DO</span>
<a name="ln-1083"></a>
<a name="ln-1084"></a><span class="k">    CALL </span><span class="n">sideTable</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span><span class="p">)</span>
<a name="ln-1085"></a>
<a name="ln-1086"></a>    <span class="c">! Set the sideInfo</span>
<a name="ln-1087"></a>    <span class="n">sid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1088"></a>    <span class="n">nUniqueSides</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1089"></a>    <span class="k">DO </span><span class="n">eid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-1090"></a>      <span class="k">DO </span><span class="n">lsid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-1091"></a>
<a name="ln-1092"></a>        <span class="n">cnid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">lsid</span><span class="p">)</span> <span class="c">! Local Corner ID</span>
<a name="ln-1093"></a>        <span class="n">lnid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">cnid</span><span class="p">)</span> <span class="c">! Reference to Local Node ID</span>
<a name="ln-1094"></a>        <span class="n">nid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">+</span> <span class="n">lnid</span> <span class="c">! Add the offSetIndNODE to get the hopr node id</span>
<a name="ln-1095"></a>        <span class="n">gn1</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">nid</span><span class="p">)</span> <span class="c">! Get the global Node ID for n1</span>
<a name="ln-1096"></a>
<a name="ln-1097"></a>        <span class="n">cnid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">lsid</span><span class="p">)</span> <span class="c">! Local Corner ID</span>
<a name="ln-1098"></a>        <span class="n">lnid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">cnid</span><span class="p">)</span> <span class="c">! Reference to Local Node ID</span>
<a name="ln-1099"></a>        <span class="n">nid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">+</span> <span class="n">lnid</span> <span class="c">! Add the offSetIndNODE to get the hopr node id</span>
<a name="ln-1100"></a>        <span class="n">gn2</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">nid</span><span class="p">)</span> <span class="c">! Get the global Node ID for n1</span>
<a name="ln-1101"></a>
<a name="ln-1102"></a>        <span class="c">! Fill side info for eid</span>
<a name="ln-1103"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfLineNonlinear</span> <span class="c">! SideType</span>
<a name="ln-1104"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Global Side ID</span>
<a name="ln-1105"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Neighbor Element ID</span>
<a name="ln-1106"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Encoding for neighbor side ID and flip (10*s2+flip)</span>
<a name="ln-1107"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! Boundary Condition ID</span>
<a name="ln-1108"></a>
<a name="ln-1109"></a>        <span class="n">key1</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">gn1</span><span class="p">,</span><span class="n">gn2</span><span class="p">)</span>
<a name="ln-1110"></a>        <span class="n">key2</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">gn1</span><span class="p">,</span><span class="n">gn2</span><span class="p">)</span>
<a name="ln-1111"></a>
<a name="ln-1112"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">sideTable</span> <span class="p">%</span> <span class="n">ContainsKeys</span><span class="p">(</span><span class="n">key1</span><span class="p">,</span><span class="n">key2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1113"></a>
<a name="ln-1114"></a>          <span class="c">! Get e2, s2, and flip</span>
<a name="ln-1115"></a>          <span class="k">CALL </span><span class="n">sideTable</span> <span class="p">%</span> <span class="n">GetDataForKeys</span><span class="p">(</span><span class="n">usid</span><span class="p">,</span><span class="n">key1</span><span class="p">,</span><span class="n">key2</span><span class="p">)</span>
<a name="ln-1116"></a>
<a name="ln-1117"></a>          <span class="n">e2</span> <span class="o">=</span> <span class="n">side</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">usid</span><span class="p">)</span>
<a name="ln-1118"></a>          <span class="n">s2</span> <span class="o">=</span> <span class="n">side</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">usid</span><span class="p">)</span>
<a name="ln-1119"></a>
<a name="ln-1120"></a>          <span class="c">! Calculate flip</span>
<a name="ln-1121"></a>          <span class="c">! &gt; Get the starting global node ID for the other element</span>
<a name="ln-1122"></a>          <span class="n">cnid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">s2</span><span class="p">)</span> <span class="c">! Local Corner ID</span>
<a name="ln-1123"></a>          <span class="n">lnid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">cnid</span><span class="p">)</span> <span class="c">! Reference to Local Node ID</span>
<a name="ln-1124"></a>          <span class="n">nid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">e2</span><span class="p">)</span> <span class="o">+</span> <span class="n">lnid</span> <span class="c">! Add the offSetIndNODE to get the hopr node id</span>
<a name="ln-1125"></a>          <span class="n">e2gn1</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">nid</span><span class="p">)</span> <span class="c">! Get the global Node ID for n1</span>
<a name="ln-1126"></a>
<a name="ln-1127"></a>          <span class="n">flip</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1128"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">e2gn1</span> <span class="o">/=</span> <span class="n">gn1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1129"></a><span class="k">            </span><span class="n">flip</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1130"></a>          <span class="k">END IF</span>
<a name="ln-1131"></a>
<a name="ln-1132"></a>          <span class="c">! Populate information for this element</span>
<a name="ln-1133"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="n">usid</span> <span class="c">! Global Side ID</span>
<a name="ln-1134"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="n">e2</span> <span class="c">! Neighbor Element ID</span>
<a name="ln-1135"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">s2</span> <span class="o">+</span> <span class="n">flip</span> <span class="c">! Neighbor Element ID</span>
<a name="ln-1136"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! boundary condition id</span>
<a name="ln-1137"></a>
<a name="ln-1138"></a>          <span class="c">! Population information for the other element</span>
<a name="ln-1139"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">e2</span><span class="p">)</span> <span class="o">=</span> <span class="n">usid</span> <span class="c">! Global Side ID</span>
<a name="ln-1140"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">e2</span><span class="p">)</span> <span class="o">=</span> <span class="n">eid</span> <span class="c">! Neighbor Element ID</span>
<a name="ln-1141"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">e2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">lsid</span> <span class="o">+</span> <span class="n">flip</span> <span class="c">! Neighbor Element ID</span>
<a name="ln-1142"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">e2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! boundary condition id</span>
<a name="ln-1143"></a>
<a name="ln-1144"></a>        <span class="k">ELSE</span>
<a name="ln-1145"></a>
<a name="ln-1146"></a><span class="k">          </span><span class="n">nUniqueSides</span> <span class="o">=</span> <span class="n">nUniqueSides</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1147"></a>          <span class="n">side</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nUniqueSides</span><span class="p">)</span> <span class="o">=</span> <span class="n">eid</span> <span class="c">! Store the element ID</span>
<a name="ln-1148"></a>          <span class="n">side</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">nUniqueSides</span><span class="p">)</span> <span class="o">=</span> <span class="n">lsid</span> <span class="c">! Store the local side ID</span>
<a name="ln-1149"></a>          <span class="c">! Add the side to the hash table</span>
<a name="ln-1150"></a>
<a name="ln-1151"></a>          <span class="k">CALL </span><span class="n">sideTable</span> <span class="p">%</span> <span class="n">AddDataForKeys</span><span class="p">(</span><span class="n">nUniqueSides</span><span class="p">,</span><span class="n">key1</span><span class="p">,</span><span class="n">key2</span><span class="p">)</span>
<a name="ln-1152"></a>
<a name="ln-1153"></a>        <span class="k">END IF</span>
<a name="ln-1154"></a>
<a name="ln-1155"></a><span class="k">        </span><span class="n">sid</span> <span class="o">=</span> <span class="n">sid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1156"></a>
<a name="ln-1157"></a>      <span class="k">END DO</span>
<a name="ln-1158"></a><span class="k">    END DO</span>
<a name="ln-1159"></a>
<a name="ln-1160"></a><span class="k">    CALL </span><span class="n">sideTable</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1161"></a>
<a name="ln-1162"></a>  <span class="k">END SUBROUTINE </span><span class="n">GenerateConnectivity_Mesh2D</span>
<a name="ln-1163"></a>
<a name="ln-1164"></a>  <span class="k">SUBROUTINE </span><span class="n">Read_HOPr_Mesh2D_serial</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">meshFile</span><span class="p">)</span>
<a name="ln-1165"></a>    <span class="c">! From https://www.hopr-project.org/externals/Meshformat.pdf, Algorithm 6</span>
<a name="ln-1166"></a>    <span class="c">! Adapted for 2D Mesh : Note that HOPR does not have 2D mesh output.</span>
<a name="ln-1167"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1168"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-1169"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">meshFile</span>
<a name="ln-1170"></a>    <span class="c">! Local</span>
<a name="ln-1171"></a>    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">HID_T</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fileId</span>
<a name="ln-1172"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGlobalElem</span>
<a name="ln-1173"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nLocalNodes</span>
<a name="ln-1174"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nLocalSides</span>
<a name="ln-1175"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nUniqueSides</span>
<a name="ln-1176"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGeo</span><span class="p">,</span><span class="n">nBCs</span>
<a name="ln-1177"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">eid</span><span class="p">,</span> <span class="n">lsid</span><span class="p">,</span> <span class="n">iSide</span>
<a name="ln-1178"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_elemInfo</span>
<a name="ln-1179"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_sideInfo</span>
<a name="ln-1180"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_nodeCoords</span>
<a name="ln-1181"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_globalNodeIDs</span>
<a name="ln-1182"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bcType</span>
<a name="ln-1183"></a>
<a name="ln-1184"></a>    <span class="k">CALL </span><span class="n">Open_HDF5</span><span class="p">(</span><span class="n">meshFile</span><span class="p">,</span><span class="n">H5F_ACC_RDWR_F</span><span class="p">,</span><span class="n">fileId</span><span class="p">)</span>
<a name="ln-1185"></a>
<a name="ln-1186"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nElems&#39;</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="p">)</span>
<a name="ln-1187"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;Ngeo&#39;</span><span class="p">,</span><span class="n">nGeo</span><span class="p">)</span>
<a name="ln-1188"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nBCs&#39;</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-1189"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nUniqueSides&#39;</span><span class="p">,</span><span class="n">nUniqueSides</span><span class="p">)</span>
<a name="ln-1190"></a>
<a name="ln-1191"></a>    <span class="c">! Read BCType</span>
<a name="ln-1192"></a>    <span class="k">CALL </span><span class="n">bcType</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1193"></a>                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">nBCs</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1194"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;BCType&#39;</span><span class="p">,</span><span class="n">bcType</span><span class="p">)</span>
<a name="ln-1195"></a>
<a name="ln-1196"></a>    <span class="c">! Allocate Space for hopr_elemInfo!</span>
<a name="ln-1197"></a>    <span class="k">CALL </span><span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1198"></a>                               <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1199"></a>
<a name="ln-1200"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;ElemInfo&#39;</span><span class="p">,</span><span class="n">hopr_elemInfo</span><span class="p">)</span>
<a name="ln-1201"></a>
<a name="ln-1202"></a>    <span class="c">! Read local subarray of NodeCoords and GlobalNodeIDs</span>
<a name="ln-1203"></a>    <span class="n">nLocalNodes</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="p">)</span> <span class="o">-</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1204"></a>
<a name="ln-1205"></a>    <span class="c">! Allocate Space for hopr_nodeCoords and hopr_globalNodeIDs !</span>
<a name="ln-1206"></a>    <span class="k">CALL </span><span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1207"></a>                                 <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">nLocalNodes</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1208"></a>
<a name="ln-1209"></a>    <span class="k">CALL </span><span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1210"></a>                                    <span class="n">upBound</span><span class="o">=</span><span class="n">nLocalNodes</span><span class="p">)</span>
<a name="ln-1211"></a>
<a name="ln-1212"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;NodeCoords&#39;</span><span class="p">,</span><span class="n">hopr_nodeCoords</span><span class="p">)</span>
<a name="ln-1213"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;GlobalNodeIDs&#39;</span><span class="p">,</span><span class="n">hopr_globalNodeIDs</span><span class="p">)</span>
<a name="ln-1214"></a>
<a name="ln-1215"></a>    <span class="c">! Read local subarray of SideInfo</span>
<a name="ln-1216"></a>    <span class="n">nLocalSides</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="p">)</span> <span class="o">-</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1217"></a>
<a name="ln-1218"></a>    <span class="c">! Allocate space for hopr_sideInfo</span>
<a name="ln-1219"></a>    <span class="k">CALL </span><span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1220"></a>                               <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">nLocalSides</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1221"></a>
<a name="ln-1222"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;SideInfo&#39;</span><span class="p">,</span><span class="n">hopr_sideInfo</span><span class="p">)</span>
<a name="ln-1223"></a>
<a name="ln-1224"></a>    <span class="k">CALL </span><span class="n">Close_HDF5</span><span class="p">(</span><span class="n">fileID</span><span class="p">)</span>
<a name="ln-1225"></a>
<a name="ln-1226"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="p">,</span><span class="n">nLocalSides</span><span class="p">,</span><span class="n">nLocalNodes</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-1227"></a>
<a name="ln-1228"></a>    <span class="c">! Copy data from local arrays into myMesh</span>
<a name="ln-1229"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span>
<a name="ln-1230"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="o">=</span> <span class="n">hopr_nodeCoords</span>
<a name="ln-1231"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="o">=</span> <span class="n">hopr_globalNodeIDs</span>
<a name="ln-1232"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="o">=</span> <span class="n">hopr_sideInfo</span>
<a name="ln-1233"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span> <span class="o">=</span> <span class="n">nUniqueSides</span>
<a name="ln-1234"></a>
<a name="ln-1235"></a>    <span class="n">iSide</span> <span class="o">=</span> <span class="mi">0</span> 
<a name="ln-1236"></a>    <span class="k">DO </span><span class="n">eid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-1237"></a>      <span class="k">DO </span><span class="n">lsid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-1238"></a>        <span class="n">iSide</span> <span class="o">=</span> <span class="n">iSide</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1239"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="n">iSide</span><span class="p">)</span>
<a name="ln-1240"></a>      <span class="n">ENDDO</span>
<a name="ln-1241"></a>    <span class="n">ENDDO</span>
<a name="ln-1242"></a>
<a name="ln-1243"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1244"></a>
<a name="ln-1245"></a>    <span class="k">CALL </span><span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1246"></a>    <span class="k">CALL </span><span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1247"></a>    <span class="k">CALL </span><span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1248"></a>    <span class="k">CALL </span><span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1249"></a>
<a name="ln-1250"></a>  <span class="k">END SUBROUTINE </span><span class="n">Read_HOPr_Mesh2D_serial</span>
<a name="ln-1251"></a>
<a name="ln-1252"></a>  <span class="k">SUBROUTINE </span><span class="n">Read_HOPr_Mesh2D_parallel</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">meshFile</span><span class="p">,</span><span class="n">decomp</span><span class="p">)</span>
<a name="ln-1253"></a>    <span class="c">! From https://www.hopr-project.org/externals/Meshformat.pdf, Algorithm 6</span>
<a name="ln-1254"></a>    <span class="c">! Adapted for 2D Mesh : Note that HOPR does not have 2D mesh output.</span>
<a name="ln-1255"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1256"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-1257"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">meshFile</span>
<a name="ln-1258"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MPILayer</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">decomp</span>
<a name="ln-1259"></a>    <span class="c">! Local</span>
<a name="ln-1260"></a>    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">HID_T</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fileId</span>
<a name="ln-1261"></a>    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">HID_T</span><span class="p">)</span> <span class="kd">::</span> <span class="n">offset</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="n">gOffset</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1262"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGlobalElem</span>
<a name="ln-1263"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">firstElem</span><span class="p">,</span><span class="n">nLocalElems</span>
<a name="ln-1264"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">firstNode</span><span class="p">,</span><span class="n">nLocalNodes</span>
<a name="ln-1265"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">firstSide</span><span class="p">,</span><span class="n">nLocalSides</span>
<a name="ln-1266"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nUniqueSides</span>
<a name="ln-1267"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGeo</span><span class="p">,</span><span class="n">nBCs</span>
<a name="ln-1268"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">eid</span><span class="p">,</span> <span class="n">lsid</span><span class="p">,</span> <span class="n">iSide</span>
<a name="ln-1269"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_elemInfo</span>
<a name="ln-1270"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_sideInfo</span>
<a name="ln-1271"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_nodeCoords</span>
<a name="ln-1272"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_globalNodeIDs</span>
<a name="ln-1273"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bcType</span>
<a name="ln-1274"></a>
<a name="ln-1275"></a>    <span class="k">CALL </span><span class="n">Open_HDF5</span><span class="p">(</span><span class="n">meshFile</span><span class="p">,</span><span class="n">H5F_ACC_RDWR_F</span><span class="p">,</span><span class="n">fileId</span><span class="p">,</span><span class="n">decomp</span> <span class="p">%</span> <span class="n">mpiComm</span><span class="p">)</span>
<a name="ln-1276"></a>
<a name="ln-1277"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nElems&#39;</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="p">)</span>
<a name="ln-1278"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;Ngeo&#39;</span><span class="p">,</span><span class="n">nGeo</span><span class="p">)</span>
<a name="ln-1279"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nBCs&#39;</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-1280"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nUniqueSides&#39;</span><span class="p">,</span><span class="n">nUniqueSides</span><span class="p">)</span>
<a name="ln-1281"></a>
<a name="ln-1282"></a>    <span class="c">! Read BCType</span>
<a name="ln-1283"></a>    <span class="k">CALL </span><span class="n">bcType</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1284"></a>                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">nBCs</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1285"></a>    <span class="n">offset</span><span class="p">(:)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1286"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;BCType&#39;</span><span class="p">,</span><span class="n">bcType</span><span class="p">,</span><span class="n">offset</span><span class="p">)</span>
<a name="ln-1287"></a>
<a name="ln-1288"></a>    <span class="c">! Read local subarray of ElemInfo</span>
<a name="ln-1289"></a>    <span class="k">CALL </span><span class="n">decomp</span> <span class="p">%</span> <span class="n">SetElemToRank</span><span class="p">(</span><span class="n">nGlobalElem</span><span class="p">)</span>
<a name="ln-1290"></a>    <span class="n">firstElem</span> <span class="o">=</span> <span class="n">decomp</span> <span class="p">%</span> <span class="n">offsetElem</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">decomp</span> <span class="p">%</span> <span class="n">rankId</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1291"></a>    <span class="n">nLocalElems</span> <span class="o">=</span> <span class="n">decomp</span> <span class="p">%</span> <span class="n">offsetElem</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">decomp</span> <span class="p">%</span> <span class="n">rankId</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1292"></a>                  <span class="n">decomp</span> <span class="p">%</span> <span class="n">offsetElem</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">decomp</span> <span class="p">%</span> <span class="n">rankId</span><span class="p">)</span>
<a name="ln-1293"></a>
<a name="ln-1294"></a>    <span class="c">! Allocate Space for hopr_elemInfo!</span>
<a name="ln-1295"></a>    <span class="k">CALL </span><span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1296"></a>                               <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span><span class="n">nLocalElems</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1297"></a>
<a name="ln-1298"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="n">firstElem</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1299"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;ElemInfo&#39;</span><span class="p">,</span><span class="n">hopr_elemInfo</span><span class="p">,</span><span class="n">offset</span><span class="p">)</span>
<a name="ln-1300"></a>
<a name="ln-1301"></a>    <span class="c">! Read local subarray of NodeCoords and GlobalNodeIDs</span>
<a name="ln-1302"></a>    <span class="n">firstNode</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1303"></a>    <span class="n">nLocalNodes</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">nLocalElems</span><span class="p">)</span> <span class="o">-</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1304"></a>
<a name="ln-1305"></a>    <span class="c">! Allocate Space for hopr_nodeCoords and hopr_globalNodeIDs !</span>
<a name="ln-1306"></a>    <span class="k">CALL </span><span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1307"></a>                                 <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">nLocalNodes</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1308"></a>
<a name="ln-1309"></a>    <span class="k">CALL </span><span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1310"></a>                                    <span class="n">upBound</span><span class="o">=</span><span class="n">nLocalNodes</span><span class="p">)</span>
<a name="ln-1311"></a>
<a name="ln-1312"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="n">firstNode</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1313"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;NodeCoords&#39;</span><span class="p">,</span><span class="n">hopr_nodeCoords</span><span class="p">,</span><span class="n">offset</span><span class="p">)</span>
<a name="ln-1314"></a>    <span class="n">gOffset</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">firstNode</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1315"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;GlobalNodeIDs&#39;</span><span class="p">,</span><span class="n">hopr_globalNodeIDs</span><span class="p">,</span><span class="n">gOffset</span><span class="p">)</span>
<a name="ln-1316"></a>
<a name="ln-1317"></a>    <span class="c">! Read local subarray of SideInfo</span>
<a name="ln-1318"></a>    <span class="n">firstSide</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1319"></a>    <span class="n">nLocalSides</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">nLocalElems</span><span class="p">)</span> <span class="o">-</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1320"></a>
<a name="ln-1321"></a>    <span class="c">! Allocate space for hopr_sideInfo</span>
<a name="ln-1322"></a>    <span class="k">CALL </span><span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1323"></a>                               <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">nLocalSides</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1324"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="n">firstSide</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1325"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;SideInfo&#39;</span><span class="p">,</span><span class="n">hopr_sideInfo</span><span class="p">,</span><span class="n">offset</span><span class="p">)</span>
<a name="ln-1326"></a>
<a name="ln-1327"></a>    <span class="k">CALL </span><span class="n">Close_HDF5</span><span class="p">(</span><span class="n">fileID</span><span class="p">)</span>
<a name="ln-1328"></a>
<a name="ln-1329"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nLocalElems</span><span class="p">,</span><span class="n">nLocalSides</span><span class="p">,</span><span class="n">nLocalNodes</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-1330"></a>
<a name="ln-1331"></a>    <span class="c">! Copy data from local arrays into myMesh</span>
<a name="ln-1332"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span>
<a name="ln-1333"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="o">=</span> <span class="n">hopr_nodeCoords</span>
<a name="ln-1334"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="o">=</span> <span class="n">hopr_globalNodeIDs</span>
<a name="ln-1335"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="o">=</span> <span class="n">hopr_sideInfo</span>
<a name="ln-1336"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span> <span class="o">=</span> <span class="n">nUniqueSides</span>
<a name="ln-1337"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nGlobalElem</span> <span class="o">=</span> <span class="n">nGlobalElem</span>
<a name="ln-1338"></a>
<a name="ln-1339"></a>    <span class="n">iSide</span> <span class="o">=</span> <span class="mi">0</span> 
<a name="ln-1340"></a>    <span class="k">DO </span><span class="n">eid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-1341"></a>      <span class="k">DO </span><span class="n">lsid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-1342"></a>        <span class="n">iSide</span> <span class="o">=</span> <span class="n">iSide</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1343"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="n">iSide</span><span class="p">)</span>
<a name="ln-1344"></a>      <span class="n">ENDDO</span>
<a name="ln-1345"></a>    <span class="n">ENDDO</span>
<a name="ln-1346"></a>
<a name="ln-1347"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1348"></a>
<a name="ln-1349"></a>    <span class="k">CALL </span><span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1350"></a>    <span class="k">CALL </span><span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1351"></a>    <span class="k">CALL </span><span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1352"></a>    <span class="k">CALL </span><span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1353"></a>
<a name="ln-1354"></a>  <span class="k">END SUBROUTINE </span><span class="n">Read_HOPr_Mesh2D_parallel</span>
<a name="ln-1355"></a>
<a name="ln-1356"></a>  <span class="k">SUBROUTINE </span><span class="n">Write_HOPr_Mesh2D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">meshFile</span><span class="p">)</span>
<a name="ln-1357"></a>    <span class="c">! Writes mesh output in HOPR format (serial only)</span>
<a name="ln-1358"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1359"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-1360"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">meshFile</span>
<a name="ln-1361"></a>    <span class="c">! Local</span>
<a name="ln-1362"></a>    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">HID_T</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fileId</span>
<a name="ln-1363"></a>
<a name="ln-1364"></a>    <span class="k">CALL </span><span class="n">Open_HDF5</span><span class="p">(</span><span class="n">meshFile</span><span class="p">,</span><span class="n">H5F_ACC_RDWR_F</span><span class="p">,</span><span class="n">fileId</span><span class="p">)</span>
<a name="ln-1365"></a>    <span class="k">CALL </span><span class="n">WriteAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nElems&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1366"></a>    <span class="k">CALL </span><span class="n">WriteAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;Ngeo&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nGeo</span><span class="p">)</span>
<a name="ln-1367"></a>    <span class="k">CALL </span><span class="n">WriteAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nBCs&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nBCs</span><span class="p">)</span>
<a name="ln-1368"></a>
<a name="ln-1369"></a>    <span class="k">CALL </span><span class="n">WriteArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;BCType&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">bcType</span><span class="p">)</span>
<a name="ln-1370"></a>
<a name="ln-1371"></a>    <span class="c">! Write local subarray of ElemInfo</span>
<a name="ln-1372"></a>    <span class="k">CALL </span><span class="n">WriteArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;ElemInfo&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span><span class="p">)</span>
<a name="ln-1373"></a>
<a name="ln-1374"></a>    <span class="c">! Write local subarray of NodeCoords and GlobalNodeIDs</span>
<a name="ln-1375"></a>    <span class="k">CALL </span><span class="n">WriteArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;NodeCoords&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span><span class="p">)</span>
<a name="ln-1376"></a>    <span class="k">CALL </span><span class="n">WriteArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;GlobalNodeIDs&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span><span class="p">)</span>
<a name="ln-1377"></a>
<a name="ln-1378"></a>    <span class="c">! Write local subarray of SideInfo</span>
<a name="ln-1379"></a>    <span class="k">CALL </span><span class="n">WriteArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;SideInfo&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span><span class="p">)</span>
<a name="ln-1380"></a>
<a name="ln-1381"></a>    <span class="k">CALL </span><span class="n">Close_HDF5</span><span class="p">(</span><span class="n">fileID</span><span class="p">)</span>
<a name="ln-1382"></a>
<a name="ln-1383"></a>  <span class="k">END SUBROUTINE </span><span class="n">Write_HOPr_Mesh2D</span>
<a name="ln-1384"></a>
<a name="ln-1385"></a>  <span class="k">SUBROUTINE </span><span class="n">Init_Mesh3D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">nSides</span><span class="p">,</span><span class="n">nNodes</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-1386"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1387"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-1388"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nGeo</span>
<a name="ln-1389"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-1390"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nSides</span>
<a name="ln-1391"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nNodes</span>
<a name="ln-1392"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nBCs</span>
<a name="ln-1393"></a>    <span class="c">! Local</span>
<a name="ln-1394"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">l</span>
<a name="ln-1395"></a>
<a name="ln-1396"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-1397"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nGlobalElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-1398"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nGeo</span> <span class="o">=</span> <span class="n">nGeo</span>
<a name="ln-1399"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nSides</span> <span class="o">=</span> <span class="n">nSides</span>
<a name="ln-1400"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nNodes</span> <span class="o">=</span> <span class="n">nNodes</span>
<a name="ln-1401"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nCornerNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1402"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1403"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1404"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nBCs</span> <span class="o">=</span> <span class="n">nBCs</span>
<a name="ln-1405"></a>
<a name="ln-1406"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1407"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1408"></a>
<a name="ln-1409"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1410"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">nSides</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1411"></a>
<a name="ln-1412"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1413"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1414"></a>
<a name="ln-1415"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1416"></a>                                          <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="n">nNodes</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1417"></a>
<a name="ln-1418"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_nodeCoords</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1419"></a>                                          <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1420"></a>
<a name="ln-1421"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1422"></a>                                             <span class="n">upBound</span><span class="o">=</span><span class="n">nNodes</span><span class="p">)</span>
<a name="ln-1423"></a>
<a name="ln-1424"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1425"></a>                                             <span class="n">upBound</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1426"></a>
<a name="ln-1427"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideMap</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1428"></a>                                       <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1429"></a>
<a name="ln-1430"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1431"></a>                                           <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1432"></a>
<a name="ln-1433"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_curveNodeMap</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1434"></a>                                            <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1435"></a>
<a name="ln-1436"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_curveNodeMapInv</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1437"></a>                                               <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nGeo</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1438"></a>
<a name="ln-1439"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1440"></a>                                 <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">nBCs</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1441"></a>
<a name="ln-1442"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCNames</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nBCs</span><span class="p">))</span>
<a name="ln-1443"></a>
<a name="ln-1444"></a>    <span class="c">! Create lookup tables to assist with connectivity generation</span>
<a name="ln-1445"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1446"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1447"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-1448"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">nGeo</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1449"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">nGeo</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1450"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">nGeo</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1451"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
<a name="ln-1452"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">nGeo</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1453"></a>
<a name="ln-1454"></a>    <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1455"></a>    <span class="k">DO </span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-1456"></a>      <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-1457"></a>        <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-1458"></a>          <span class="n">l</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1459"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_curveNodeMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1460"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_curveNodeMapInv</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">l</span>
<a name="ln-1461"></a>        <span class="k">END DO</span>
<a name="ln-1462"></a><span class="k">      END DO</span>
<a name="ln-1463"></a><span class="k">    END DO</span>
<a name="ln-1464"></a>
<a name="ln-1465"></a>    <span class="c">! Maps from local corner node id to CGNS side</span>
<a name="ln-1466"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1467"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1468"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1469"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1470"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1471"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1472"></a>
<a name="ln-1473"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="p">)</span> <span class="c">! Bottom</span>
<a name="ln-1474"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="o">/</span><span class="p">)</span> <span class="c">! South</span>
<a name="ln-1475"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="o">/</span><span class="p">)</span> <span class="c">! East</span>
<a name="ln-1476"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="o">/</span><span class="p">)</span> <span class="c">! North</span>
<a name="ln-1477"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="o">/</span><span class="p">)</span> <span class="c">! West</span>
<a name="ln-1478"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="o">/</span><span class="p">)</span> <span class="c">! Top</span>
<a name="ln-1479"></a>
<a name="ln-1480"></a>  <span class="k">END SUBROUTINE </span><span class="n">Init_Mesh3D</span>
<a name="ln-1481"></a>
<a name="ln-1482"></a>  <span class="k">SUBROUTINE </span><span class="n">Free_Mesh3D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-1483"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1484"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-1485"></a>
<a name="ln-1486"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1487"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nSides</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1488"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1489"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nCornerNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1490"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1491"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1492"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nBCs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1493"></a>
<a name="ln-1494"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1495"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1496"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1497"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1498"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_nodeCoords</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1499"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1500"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1501"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideMap</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1502"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1503"></a>
<a name="ln-1504"></a>    <span class="k">DEALLOCATE</span> <span class="p">(</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCNames</span><span class="p">)</span>
<a name="ln-1505"></a>
<a name="ln-1506"></a>  <span class="k">END SUBROUTINE </span><span class="n">Free_Mesh3D</span>
<a name="ln-1507"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateHost_Mesh3D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-1508"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1509"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-1510"></a>
<a name="ln-1511"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1512"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1513"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1514"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1515"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_nodeCoords</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1516"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1517"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1518"></a>
<a name="ln-1519"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateHost_Mesh3D</span>
<a name="ln-1520"></a>
<a name="ln-1521"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateDevice_Mesh3D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-1522"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1523"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-1524"></a>
<a name="ln-1525"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1526"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1527"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1528"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1529"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_nodeCoords</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1530"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1531"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1532"></a>
<a name="ln-1533"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateDevice_Mesh3D</span>
<a name="ln-1534"></a>
<a name="ln-1535"></a>  <span class="k">SUBROUTINE </span><span class="n">UniformBlockMesh_Mesh3D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<a name="ln-1536"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1537"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-1538"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nGeo</span>
<a name="ln-1539"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1540"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1541"></a>    <span class="c">! Local</span>
<a name="ln-1542"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iel</span><span class="p">,</span><span class="n">jel</span><span class="p">,</span><span class="n">kel</span><span class="p">,</span><span class="n">nEl</span><span class="p">,</span><span class="n">elid</span>
<a name="ln-1543"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">sid</span><span class="p">,</span><span class="n">nid</span><span class="p">,</span><span class="n">nNodes</span>
<a name="ln-1544"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nSides</span>
<a name="ln-1545"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">bcid</span>
<a name="ln-1546"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a name="ln-1547"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nbeid</span><span class="p">,</span> <span class="n">nbsid</span><span class="p">,</span> <span class="n">usid</span><span class="p">,</span> <span class="n">lsid</span>
<a name="ln-1548"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1549"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">yU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1550"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">zU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1551"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Lagrange</span><span class="p">),</span> <span class="k">TARGET</span> <span class="kd">::</span> <span class="n">linearInterp</span>
<a name="ln-1552"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Lagrange</span><span class="p">),</span> <span class="k">TARGET</span> <span class="kd">::</span> <span class="n">nGeoInterp</span>
<a name="ln-1553"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xLinear</span>
<a name="ln-1554"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xGeo</span>
<a name="ln-1555"></a>
<a name="ln-1556"></a>    <span class="n">nEl</span> <span class="o">=</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1557"></a>    <span class="n">nNodes</span> <span class="o">=</span> <span class="n">nEl</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1558"></a>    <span class="n">nSides</span> <span class="o">=</span> <span class="n">nEl</span><span class="o">*</span><span class="mi">6</span>
<a name="ln-1559"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nEl</span><span class="p">,</span><span class="n">nSides</span><span class="p">,</span><span class="n">nNodes</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1560"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span> <span class="o">=</span> <span class="p">(</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1561"></a>             <span class="p">(</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1562"></a>             <span class="p">(</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1563"></a>
<a name="ln-1564"></a>    <span class="c">! Set the hopr_nodeCoords</span>
<a name="ln-1565"></a>    <span class="n">xU</span> <span class="o">=</span> <span class="n">UniformPoints</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1566"></a>    <span class="n">yU</span> <span class="o">=</span> <span class="n">UniformPoints</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">x</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1567"></a>    <span class="n">zU</span> <span class="o">=</span> <span class="n">UniformPoints</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">x</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1568"></a>
<a name="ln-1569"></a>    <span class="k">CALL </span><span class="n">linearInterp</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,&amp;</span>
<a name="ln-1570"></a>            <span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">)</span>
<a name="ln-1571"></a>
<a name="ln-1572"></a>    <span class="k">CALL </span><span class="n">nGeoInterp</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,&amp;</span>
<a name="ln-1573"></a>            <span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">)</span>
<a name="ln-1574"></a>
<a name="ln-1575"></a>    <span class="c">! Create a linear interpolant to interpolate to nGeo grid</span>
<a name="ln-1576"></a>    <span class="k">CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">linearInterp</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nEl</span><span class="p">)</span>
<a name="ln-1577"></a>    <span class="k">CALL </span><span class="n">xGeo</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeoInterp</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nEl</span><span class="p">)</span>
<a name="ln-1578"></a>
<a name="ln-1579"></a>    <span class="n">elid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1580"></a>    <span class="k">DO </span><span class="n">kel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1581"></a>      <span class="k">DO </span><span class="n">jel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1582"></a>        <span class="k">DO </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1583"></a>          <span class="c">! x component</span>
<a name="ln-1584"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xU</span><span class="p">(</span><span class="n">iel</span><span class="p">:</span><span class="n">iel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1585"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xU</span><span class="p">(</span><span class="n">iel</span><span class="p">:</span><span class="n">iel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1586"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xU</span><span class="p">(</span><span class="n">iel</span><span class="p">:</span><span class="n">iel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1587"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xU</span><span class="p">(</span><span class="n">iel</span><span class="p">:</span><span class="n">iel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1588"></a>          <span class="c">! y component</span>
<a name="ln-1589"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">yU</span><span class="p">(</span><span class="n">jel</span><span class="p">:</span><span class="n">jel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1590"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">yU</span><span class="p">(</span><span class="n">jel</span><span class="p">:</span><span class="n">jel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1591"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">yU</span><span class="p">(</span><span class="n">jel</span><span class="p">:</span><span class="n">jel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1592"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">yU</span><span class="p">(</span><span class="n">jel</span><span class="p">:</span><span class="n">jel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1593"></a>          <span class="c">! z component</span>
<a name="ln-1594"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">zU</span><span class="p">(</span><span class="n">kel</span><span class="p">:</span><span class="n">kel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1595"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">zU</span><span class="p">(</span><span class="n">kel</span><span class="p">:</span><span class="n">kel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1596"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">zU</span><span class="p">(</span><span class="n">kel</span><span class="p">:</span><span class="n">kel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1597"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">zU</span><span class="p">(</span><span class="n">kel</span><span class="p">:</span><span class="n">kel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1598"></a>          <span class="c">! Incremenent the element ID</span>
<a name="ln-1599"></a>          <span class="n">elid</span> <span class="o">=</span> <span class="n">elid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1600"></a>        <span class="k">END DO</span>
<a name="ln-1601"></a><span class="k">      END DO</span>
<a name="ln-1602"></a><span class="k">    END DO</span>
<a name="ln-1603"></a>
<a name="ln-1604"></a><span class="k">    CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">GridInterp</span><span class="p">(</span><span class="n">xGeo</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-1605"></a>
<a name="ln-1606"></a>    <span class="c">! Set the element information</span>
<a name="ln-1607"></a>    <span class="n">nid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1608"></a>    <span class="n">sid</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1609"></a>    <span class="n">elid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1610"></a>    <span class="k">DO </span><span class="n">kel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1611"></a>      <span class="k">DO </span><span class="n">jel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1612"></a>        <span class="k">DO </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1613"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfQuadLinear</span> <span class="c">! Element Type</span>
<a name="ln-1614"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! Element Zone</span>
<a name="ln-1615"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">sid</span> <span class="c">! Side Index Start</span>
<a name="ln-1616"></a>          <span class="n">sid</span> <span class="o">=</span> <span class="n">sid</span> <span class="o">+</span> <span class="mi">6</span>
<a name="ln-1617"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">sid</span> <span class="c">! Side Index End</span>
<a name="ln-1618"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">nid</span> <span class="o">-</span> <span class="mi">1</span> <span class="c">! Node Index Start</span>
<a name="ln-1619"></a>          <span class="k">DO </span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-1620"></a>            <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-1621"></a>              <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-1622"></a>                <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">nid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xGeo</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span>
<a name="ln-1623"></a>                <span class="n">nid</span> <span class="o">=</span> <span class="n">nid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1624"></a>              <span class="k">END DO</span>
<a name="ln-1625"></a><span class="k">            END DO</span>
<a name="ln-1626"></a><span class="k">          END DO</span>
<a name="ln-1627"></a><span class="k">          </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">nid</span> <span class="c">! Node Index End</span>
<a name="ln-1628"></a>          <span class="n">elid</span> <span class="o">=</span> <span class="n">elid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1629"></a>        <span class="k">END DO</span>
<a name="ln-1630"></a><span class="k">      END DO</span>
<a name="ln-1631"></a><span class="k">    END DO</span>
<a name="ln-1632"></a>
<a name="ln-1633"></a>    <span class="c">! Set up the side info</span>
<a name="ln-1634"></a>    <span class="n">elid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1635"></a>    <span class="n">sid</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1636"></a>    <span class="n">usid</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1637"></a>    <span class="k">DO </span><span class="n">kel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1638"></a>      <span class="k">DO </span><span class="n">jel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1639"></a>        <span class="k">DO </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1640"></a>
<a name="ln-1641"></a>          <span class="c">! Bottom Face ! Local Side = 1</span>
<a name="ln-1642"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">kel</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1643"></a>
<a name="ln-1644"></a><span class="k">             </span><span class="n">sid</span> <span class="o">=</span> <span class="n">sid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1645"></a>             <span class="n">usid</span> <span class="o">=</span> <span class="n">usid</span> <span class="o">+</span> <span class="mi">1</span> <span class="c">! unique side id</span>
<a name="ln-1646"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfQuadLinear</span> <span class="c">! Side type set to linear quad</span>
<a name="ln-1647"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">usid</span> <span class="c">! Unique side id</span>
<a name="ln-1648"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Neighbor Element ID (0=boundary)</span>
<a name="ln-1649"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! 10*nbLocalSide + flip</span>
<a name="ln-1650"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">self_BCDefault</span> <span class="c">! Boundary condition ID</span>
<a name="ln-1651"></a>
<a name="ln-1652"></a>          <span class="k">ELSE</span>
<a name="ln-1653"></a>
<a name="ln-1654"></a><span class="k">             </span><span class="n">sid</span> <span class="o">=</span> <span class="n">sid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1655"></a>             <span class="n">nbeid</span> <span class="o">=</span> <span class="n">iel</span> <span class="o">+</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jel</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kel</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span> <span class="c">! Get the element id for the element below</span>
<a name="ln-1656"></a>             <span class="n">nbsid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">nbeid</span><span class="p">)</span> <span class="o">+</span> <span class="n">selfSide3D_Top</span><span class="o">-</span><span class="mi">1</span> <span class="c">! Get sid for the top face of the element below</span>
<a name="ln-1657"></a>             <span class="n">usid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">nbsid</span><span class="p">)</span> <span class="c">! Get the unique side address </span>
<a name="ln-1658"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfQuadLinear</span> <span class="c">! Side type set to linear quad</span>
<a name="ln-1659"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">usid</span> <span class="c">! Unique side id</span>
<a name="ln-1660"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">nbeid</span> <span class="c">! Neighbor Element ID (0=boundary)</span>
<a name="ln-1661"></a>             <span class="c">! flip == 1 indicates internal geometry of each neighboring element</span>
<a name="ln-1662"></a>             <span class="c">! has the same orientation</span>
<a name="ln-1663"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">selfSide3D_Top</span> <span class="o">+</span> <span class="mi">1</span> <span class="c">! 10*nbLocalSide + flip</span>
<a name="ln-1664"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Boundary condition ID</span>
<a name="ln-1665"></a>
<a name="ln-1666"></a>          <span class="n">ENDIF</span>
<a name="ln-1667"></a>
<a name="ln-1668"></a>          <span class="c">! South Face ! Local Side = 2</span>
<a name="ln-1669"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">jel</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1670"></a>
<a name="ln-1671"></a><span class="k">             </span><span class="n">sid</span> <span class="o">=</span> <span class="n">sid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1672"></a>             <span class="n">usid</span> <span class="o">=</span> <span class="n">usid</span> <span class="o">+</span> <span class="mi">1</span> <span class="c">! unique side id</span>
<a name="ln-1673"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfQuadLinear</span> <span class="c">! Side type set to linear quad</span>
<a name="ln-1674"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">usid</span> <span class="c">! Unique side id</span>
<a name="ln-1675"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Neighbor Element ID (0=boundary)</span>
<a name="ln-1676"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! 10*nbLocalSide + flip</span>
<a name="ln-1677"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">self_BCDefault</span> <span class="c">! Boundary condition ID</span>
<a name="ln-1678"></a>
<a name="ln-1679"></a>          <span class="k">ELSE</span>
<a name="ln-1680"></a>
<a name="ln-1681"></a><span class="k">             </span><span class="n">sid</span> <span class="o">=</span> <span class="n">sid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1682"></a>             <span class="n">nbeid</span> <span class="o">=</span> <span class="n">iel</span> <span class="o">+</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jel</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kel</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="c">! Get the element id for the element to the south</span>
<a name="ln-1683"></a>             <span class="n">nbsid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">nbeid</span><span class="p">)</span> <span class="o">+</span> <span class="n">selfSide3D_North</span><span class="o">-</span><span class="mi">1</span> <span class="c">! Get sid for the north face of the element to  the south</span>
<a name="ln-1684"></a>             <span class="n">usid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">nbsid</span><span class="p">)</span> <span class="c">! Get the unique side address </span>
<a name="ln-1685"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfQuadLinear</span> <span class="c">! Side type set to linear quad</span>
<a name="ln-1686"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">usid</span> <span class="c">! Unique side id</span>
<a name="ln-1687"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">nbeid</span> <span class="c">! Neighbor Element ID (0=boundary)</span>
<a name="ln-1688"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">selfSide3D_North</span> <span class="c">! 10*nbLocalSide + flip</span>
<a name="ln-1689"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Boundary condition ID</span>
<a name="ln-1690"></a>
<a name="ln-1691"></a>          <span class="n">ENDIF</span>
<a name="ln-1692"></a>
<a name="ln-1693"></a>          <span class="c">! East Face ! Local Side = 3</span>
<a name="ln-1694"></a>          <span class="n">sid</span> <span class="o">=</span> <span class="n">sid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1695"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">iel</span> <span class="o">==</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1696"></a><span class="k">            </span><span class="n">nbeid</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1697"></a>            <span class="n">bcid</span> <span class="o">=</span> <span class="n">self_BCDefault</span>
<a name="ln-1698"></a>          <span class="k">ELSE   </span>
<a name="ln-1699"></a><span class="k">            </span><span class="n">nbeid</span> <span class="o">=</span> <span class="n">iel</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jel</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kel</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="c">! Get the element id for the element to the east</span>
<a name="ln-1700"></a>            <span class="n">bcid</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1701"></a>          <span class="n">ENDIF</span>
<a name="ln-1702"></a>          <span class="n">usid</span> <span class="o">=</span> <span class="n">usid</span> <span class="o">+</span> <span class="mi">1</span> <span class="c">! unique side id</span>
<a name="ln-1703"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfQuadLinear</span> <span class="c">! Side type set to linear quad</span>
<a name="ln-1704"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">usid</span> <span class="c">! Unique side id</span>
<a name="ln-1705"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">nbeid</span> <span class="c">! Neighbor Element ID (0=boundary)</span>
<a name="ln-1706"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">selfSide3D_West</span> <span class="c">! 10*nbLocalSide + flip</span>
<a name="ln-1707"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">bcid</span> <span class="c">! Boundary condition ID</span>
<a name="ln-1708"></a>
<a name="ln-1709"></a>
<a name="ln-1710"></a>          <span class="c">! North Face ! Local Side = 4</span>
<a name="ln-1711"></a>          <span class="n">sid</span> <span class="o">=</span> <span class="n">sid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1712"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">jel</span> <span class="o">==</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1713"></a><span class="k">            </span><span class="n">nbeid</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1714"></a>            <span class="n">bcid</span> <span class="o">=</span> <span class="n">self_BCDefault</span>
<a name="ln-1715"></a>          <span class="k">ELSE   </span>
<a name="ln-1716"></a><span class="k">            </span><span class="n">nbeid</span> <span class="o">=</span> <span class="n">iel</span> <span class="o">+</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jel</span> <span class="o">+</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kel</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="c">! Get the element id for the element to the north</span>
<a name="ln-1717"></a>            <span class="n">bcid</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1718"></a>          <span class="n">ENDIF</span>
<a name="ln-1719"></a>          <span class="n">usid</span> <span class="o">=</span> <span class="n">usid</span> <span class="o">+</span> <span class="mi">1</span> <span class="c">! unique side id</span>
<a name="ln-1720"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfQuadLinear</span> <span class="c">! Side type set to linear quad</span>
<a name="ln-1721"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">usid</span> <span class="c">! Unique side id</span>
<a name="ln-1722"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">nbeid</span> <span class="c">! Neighbor Element ID (0=boundary)</span>
<a name="ln-1723"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">selfSide3D_South</span> <span class="c">! 10*nbLocalSide + flip</span>
<a name="ln-1724"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">bcid</span> <span class="c">! Boundary condition ID</span>
<a name="ln-1725"></a>
<a name="ln-1726"></a>          <span class="c">! West Face ! Local Side = 5</span>
<a name="ln-1727"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">iel</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1728"></a>
<a name="ln-1729"></a><span class="k">             </span><span class="n">sid</span> <span class="o">=</span> <span class="n">sid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1730"></a>             <span class="n">usid</span> <span class="o">=</span> <span class="n">usid</span> <span class="o">+</span> <span class="mi">1</span> <span class="c">! unique side id</span>
<a name="ln-1731"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfQuadLinear</span> <span class="c">! Side type set to linear quad</span>
<a name="ln-1732"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">usid</span> <span class="c">! Unique side id</span>
<a name="ln-1733"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Neighbor Element ID (0=boundary)</span>
<a name="ln-1734"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! 10*nbLocalSide + flip</span>
<a name="ln-1735"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">self_BCDefault</span> <span class="c">! Boundary condition ID</span>
<a name="ln-1736"></a>
<a name="ln-1737"></a>          <span class="k">ELSE</span>
<a name="ln-1738"></a>
<a name="ln-1739"></a><span class="k">             </span><span class="n">sid</span> <span class="o">=</span> <span class="n">sid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1740"></a>             <span class="n">nbeid</span> <span class="o">=</span> <span class="n">iel</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jel</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kel</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="c">! Get the element id for the element to the west</span>
<a name="ln-1741"></a>             <span class="n">nbsid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">nbeid</span><span class="p">)</span> <span class="o">+</span> <span class="n">selfSide3D_East</span><span class="o">-</span><span class="mi">1</span> <span class="c">! Get sid for the east face of the element to the west</span>
<a name="ln-1742"></a>             <span class="n">usid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">nbsid</span><span class="p">)</span> <span class="c">! Get the unique side address </span>
<a name="ln-1743"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfQuadLinear</span> <span class="c">! Side type set to linear quad</span>
<a name="ln-1744"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">usid</span> <span class="c">! Unique side id</span>
<a name="ln-1745"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">nbeid</span> <span class="c">! Neighbor Element ID (0=boundary)</span>
<a name="ln-1746"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">selfSide3D_East</span> <span class="c">! 10*nbLocalSide + flip</span>
<a name="ln-1747"></a>             <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Boundary condition ID</span>
<a name="ln-1748"></a>
<a name="ln-1749"></a>          <span class="n">ENDIF</span>
<a name="ln-1750"></a>
<a name="ln-1751"></a>          <span class="c">! Top Face ! Local Side = 6</span>
<a name="ln-1752"></a>          <span class="n">sid</span> <span class="o">=</span> <span class="n">sid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1753"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">kel</span> <span class="o">==</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1754"></a><span class="k">            </span><span class="n">nbeid</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1755"></a>            <span class="n">bcid</span> <span class="o">=</span> <span class="n">self_BCDefault</span>
<a name="ln-1756"></a>          <span class="k">ELSE   </span>
<a name="ln-1757"></a><span class="k">            </span><span class="n">nbeid</span> <span class="o">=</span> <span class="n">iel</span> <span class="o">+</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jel</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kel</span><span class="p">))</span> <span class="c">! Get the element id for the element above</span>
<a name="ln-1758"></a>            <span class="n">bcid</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1759"></a>          <span class="n">ENDIF</span>
<a name="ln-1760"></a>          <span class="n">usid</span> <span class="o">=</span> <span class="n">usid</span> <span class="o">+</span> <span class="mi">1</span> <span class="c">! unique side id</span>
<a name="ln-1761"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfQuadLinear</span> <span class="c">! Side type set to linear quad</span>
<a name="ln-1762"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">usid</span> <span class="c">! Unique side id</span>
<a name="ln-1763"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">nbeid</span> <span class="c">! Neighbor Element ID (0=boundary)</span>
<a name="ln-1764"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">selfSide3D_Bottom</span> <span class="c">! 10*nbLocalSide + flip</span>
<a name="ln-1765"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span> <span class="o">=</span> <span class="n">bcid</span> <span class="c">! Boundary condition ID</span>
<a name="ln-1766"></a>
<a name="ln-1767"></a>
<a name="ln-1768"></a>        <span class="n">ENDDO</span>
<a name="ln-1769"></a>      <span class="n">ENDDO</span>
<a name="ln-1770"></a>    <span class="n">ENDDO</span>
<a name="ln-1771"></a>
<a name="ln-1772"></a>    <span class="n">elid</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1773"></a>    <span class="n">sid</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1774"></a>    <span class="k">DO </span><span class="n">kel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1775"></a>      <span class="k">DO </span><span class="n">jel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1776"></a>        <span class="k">DO </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1777"></a>          <span class="n">elid</span> <span class="o">=</span> <span class="n">elid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1778"></a>          <span class="k">DO </span><span class="n">lsid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span>
<a name="ln-1779"></a>            <span class="n">sid</span> <span class="o">=</span> <span class="n">sid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1780"></a>            <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1781"></a>          <span class="n">ENDDO</span>
<a name="ln-1782"></a>        <span class="n">ENDDO</span>
<a name="ln-1783"></a>      <span class="n">ENDDO</span>
<a name="ln-1784"></a>    <span class="n">ENDDO</span>
<a name="ln-1785"></a>
<a name="ln-1786"></a>
<a name="ln-1787"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1788"></a>
<a name="ln-1789"></a>    <span class="k">CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1790"></a>    <span class="k">CALL </span><span class="n">xGeo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1791"></a>    <span class="k">CALL </span><span class="n">linearInterp</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1792"></a>    <span class="k">CALL </span><span class="n">nGeoInterp</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1793"></a>
<a name="ln-1794"></a>  <span class="k">END SUBROUTINE </span><span class="n">UniformBlockMesh_Mesh3D</span>
<a name="ln-1795"></a>
<a name="ln-1796"></a>  <span class="k">SUBROUTINE </span><span class="n">Load_Mesh3D_serial</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">myMeshSpec</span><span class="p">)</span>
<a name="ln-1797"></a><span class="cp">#undef __FUNC__</span>
<a name="ln-1798"></a><span class="cp">#define __FUNC__ &quot;Load_Mesh3D&quot;</span>
<a name="ln-1799"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1800"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-1801"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MeshSpec</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMeshSpec</span>
<a name="ln-1802"></a>
<a name="ln-1803"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1804"></a>
<a name="ln-1805"></a><span class="k">      CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UniformBlockMesh</span><span class="p">(</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_nGeo</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1806"></a>                        <span class="p">(</span><span class="o">/</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_nElemX</span><span class="p">,</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_nElemY</span><span class="p">,</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_nElemZ</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1807"></a>                                     <span class="p">(</span><span class="o">/</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_x0</span><span class="p">,</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_x1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1808"></a>                                       <span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_y0</span><span class="p">,</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_y1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1809"></a>                                       <span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_z0</span><span class="p">,</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_z1</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1810"></a>
<a name="ln-1811"></a>    <span class="k">ELSE</span>
<a name="ln-1812"></a>
<a name="ln-1813"></a><span class="k">      CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Read_HOPr</span><span class="p">(</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">filename</span><span class="p">)</span>
<a name="ln-1814"></a>
<a name="ln-1815"></a>    <span class="k">END IF</span>
<a name="ln-1816"></a>
<a name="ln-1817"></a><span class="k">  END SUBROUTINE </span><span class="n">Load_Mesh3D_serial</span>
<a name="ln-1818"></a>
<a name="ln-1819"></a>  <span class="k">SUBROUTINE </span><span class="n">Load_Mesh3D_parallel</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">myMeshSpec</span><span class="p">,</span><span class="n">decomp</span><span class="p">)</span>
<a name="ln-1820"></a><span class="cp">#undef __FUNC__</span>
<a name="ln-1821"></a><span class="cp">#define __FUNC__ &quot;Load_Mesh3D&quot;</span>
<a name="ln-1822"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1823"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-1824"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MeshSpec</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMeshSpec</span>
<a name="ln-1825"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MPILayer</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">decomp</span>
<a name="ln-1826"></a>
<a name="ln-1827"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1828"></a>
<a name="ln-1829"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">decomp</span> <span class="p">%</span> <span class="n">nRanks</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Error out</span>
<a name="ln-1830"></a>        <span class="n">ERROR</span><span class="p">(</span><span class="s2">&quot;Block Mesh only supported in serial&quot;</span><span class="p">)</span>
<a name="ln-1831"></a>        <span class="k">STOP</span> <span class="c">! TO DO : Safe exit for serial and parallel</span>
<a name="ln-1832"></a>      <span class="k">ELSE</span>
<a name="ln-1833"></a><span class="k">        CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UniformBlockMesh</span><span class="p">(</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_nGeo</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1834"></a>                        <span class="p">(</span><span class="o">/</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_nElemX</span><span class="p">,</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_nElemY</span><span class="p">,</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_nElemZ</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1835"></a>                                       <span class="p">(</span><span class="o">/</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_x0</span><span class="p">,</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_x1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1836"></a>                                         <span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_y0</span><span class="p">,</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_y1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1837"></a>                                         <span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_z0</span><span class="p">,</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">blockMesh_z1</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1838"></a>      <span class="k">END IF</span>
<a name="ln-1839"></a>
<a name="ln-1840"></a><span class="k">    ELSE</span>
<a name="ln-1841"></a>
<a name="ln-1842"></a><span class="k">      CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Read_HOPr</span><span class="p">(</span><span class="n">myMeshSpec</span> <span class="p">%</span> <span class="n">filename</span><span class="p">,</span><span class="n">decomp</span><span class="p">)</span>
<a name="ln-1843"></a>
<a name="ln-1844"></a>    <span class="k">END IF</span>
<a name="ln-1845"></a>
<a name="ln-1846"></a><span class="k">  END SUBROUTINE </span><span class="n">Load_Mesh3D_parallel</span>
<a name="ln-1847"></a>
<a name="ln-1848"></a>  <span class="k">SUBROUTINE </span><span class="n">RecalculateFlip_Mesh3D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">decomp</span><span class="p">)</span>  
<a name="ln-1849"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1850"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-1851"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MPILayer</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span><span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">decomp</span>
<a name="ln-1852"></a>    <span class="c">! Local</span>
<a name="ln-1853"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">e1</span>
<a name="ln-1854"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">s1</span>
<a name="ln-1855"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">e2</span>
<a name="ln-1856"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">e2Global</span>
<a name="ln-1857"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">s2</span>
<a name="ln-1858"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">flip</span>
<a name="ln-1859"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">bcid</span>
<a name="ln-1860"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">lnid1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1861"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">lnid2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1862"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nid1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1863"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nid2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1864"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nloc1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1865"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nloc2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1866"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">n1</span>
<a name="ln-1867"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">n1Global</span>
<a name="ln-1868"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">n2</span>
<a name="ln-1869"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">n2Global</span>
<a name="ln-1870"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">c1</span>
<a name="ln-1871"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">c2</span>
<a name="ln-1872"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-1873"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">l</span>
<a name="ln-1874"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nShifts</span>
<a name="ln-1875"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">neighborRank</span>
<a name="ln-1876"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">rankId</span>
<a name="ln-1877"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">offset</span>
<a name="ln-1878"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">msgCount</span>
<a name="ln-1879"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">globalSideId</span>
<a name="ln-1880"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">requests</span><span class="p">(:)</span>
<a name="ln-1881"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">stats</span><span class="p">(:,:)</span>
<a name="ln-1882"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iError</span>
<a name="ln-1883"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">theyMatch</span>
<a name="ln-1884"></a>
<a name="ln-1885"></a>
<a name="ln-1886"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">requests</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nSides</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1887"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">stats</span><span class="p">(</span><span class="n">MPI_STATUS_SIZE</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nSides</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1888"></a>
<a name="ln-1889"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">decomp</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1890"></a><span class="k">      </span><span class="n">rankId</span> <span class="o">=</span> <span class="n">decomp</span> <span class="p">%</span> <span class="n">rankId</span>
<a name="ln-1891"></a>      <span class="n">offset</span> <span class="o">=</span> <span class="n">decomp</span> <span class="p">%</span> <span class="n">offsetElem</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">rankId</span><span class="p">)</span>
<a name="ln-1892"></a>    <span class="k">ELSE</span>
<a name="ln-1893"></a><span class="k">      </span><span class="n">rankId</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1894"></a>      <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1895"></a>    <span class="n">ENDIF</span>
<a name="ln-1896"></a>
<a name="ln-1897"></a>    <span class="n">msgCount</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1898"></a>    <span class="k">DO </span><span class="n">e1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-1899"></a>      <span class="k">DO </span><span class="n">s1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">6</span>
<a name="ln-1900"></a>
<a name="ln-1901"></a>        <span class="n">e2Global</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span>
<a name="ln-1902"></a>        <span class="n">e2</span> <span class="o">=</span> <span class="n">e2Global</span> <span class="o">-</span> <span class="n">offset</span>
<a name="ln-1903"></a>        <span class="n">s2</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span>
<a name="ln-1904"></a>        <span class="n">flip</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span> <span class="o">-</span> <span class="n">s2</span><span class="o">*</span><span class="mi">10</span>
<a name="ln-1905"></a>        <span class="n">bcid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span>
<a name="ln-1906"></a>
<a name="ln-1907"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">bcid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1908"></a>
<a name="ln-1909"></a><span class="k">          IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">decomp</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1910"></a><span class="k">            </span><span class="n">neighborRank</span> <span class="o">=</span> <span class="n">decomp</span> <span class="p">%</span> <span class="n">elemToRank</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">e2Global</span><span class="p">)</span>
<a name="ln-1911"></a>          <span class="k">ELSE</span>
<a name="ln-1912"></a><span class="k">            </span><span class="n">neighborRank</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1913"></a>          <span class="n">ENDIF</span>
<a name="ln-1914"></a>
<a name="ln-1915"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">neighborRank</span> <span class="o">==</span> <span class="n">rankId</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1916"></a>
<a name="ln-1917"></a>            <span class="c">! With 8 nodes per element, and the nodes provided in order, we can also shift the node indices</span>
<a name="ln-1918"></a>            <span class="n">n1Global</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span> <span class="c">! Starting node index for element 1</span>
<a name="ln-1919"></a>            <span class="n">n1</span> <span class="o">=</span> <span class="n">n1Global</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">offset</span>
<a name="ln-1920"></a>
<a name="ln-1921"></a>            <span class="n">n2Global</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">e2</span><span class="p">)</span> <span class="c">! Starting node index for element 2</span>
<a name="ln-1922"></a>            <span class="n">n2</span> <span class="o">=</span> <span class="n">n2Global</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">offset</span>
<a name="ln-1923"></a>
<a name="ln-1924"></a>            <span class="n">lnid1</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="n">s1</span><span class="p">)</span> <span class="c">! local CGNS corner node ids for element 1 side</span>
<a name="ln-1925"></a>            <span class="n">lnid2</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="n">s2</span><span class="p">)</span> <span class="c">! local CGNS corner node ids for element 2 side</span>
<a name="ln-1926"></a>
<a name="ln-1927"></a>            <span class="k">DO </span><span class="n">l</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-1928"></a>              
<a name="ln-1929"></a>              <span class="n">c1</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">lnid1</span><span class="p">(</span><span class="n">l</span><span class="p">))</span> <span class="c">! Get the local HOPR node id for element 1</span>
<a name="ln-1930"></a>              <span class="n">c2</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">lnid2</span><span class="p">(</span><span class="n">l</span><span class="p">))</span> <span class="c">! Get the local HOPR node id for element 2</span>
<a name="ln-1931"></a>              <span class="n">nid1</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="n">c1</span><span class="p">)</span> <span class="c">! Global node IDs for element 1 side</span>
<a name="ln-1932"></a>              <span class="n">nid2</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">n2</span><span class="o">+</span><span class="n">c2</span><span class="p">)</span> <span class="c">! Global node IDs for element 2 side</span>
<a name="ln-1933"></a>
<a name="ln-1934"></a>            <span class="n">ENDDO</span>
<a name="ln-1935"></a>
<a name="ln-1936"></a>          <span class="k">ELSE</span> <span class="c">! In this case, we need to exchange</span>
<a name="ln-1937"></a>
<a name="ln-1938"></a>            <span class="n">globalSideId</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostdata</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">))</span>
<a name="ln-1939"></a>
<a name="ln-1940"></a>            <span class="n">n1Global</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span> <span class="c">! Starting node index for element 1</span>
<a name="ln-1941"></a>            <span class="n">n1</span> <span class="o">=</span> <span class="n">n1Global</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">offset</span>
<a name="ln-1942"></a>
<a name="ln-1943"></a>            <span class="n">lnid1</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="n">s1</span><span class="p">)</span> <span class="c">! local CGNS corner node ids for element 1 side</span>
<a name="ln-1944"></a>
<a name="ln-1945"></a>            <span class="k">DO </span><span class="n">l</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-1946"></a>              
<a name="ln-1947"></a>              <span class="n">c1</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">lnid1</span><span class="p">(</span><span class="n">l</span><span class="p">))</span> <span class="c">! Get the local HOPR node id for element 1</span>
<a name="ln-1948"></a>              <span class="n">nid1</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="n">c1</span><span class="p">)</span> <span class="c">! Global node IDs for element 1 side</span>
<a name="ln-1949"></a>
<a name="ln-1950"></a>              <span class="c">! Receive nid2(l) on this rank from  nid1(l) on the other rank</span>
<a name="ln-1951"></a>              <span class="n">msgCount</span> <span class="o">=</span> <span class="n">msgCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1952"></a>              <span class="k">CALL </span><span class="n">MPI_IRECV</span><span class="p">(</span><span class="n">nid2</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1953"></a>                             <span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1954"></a>                             <span class="n">MPI_INTEGER</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1955"></a>                             <span class="n">neighborRank</span><span class="p">,</span><span class="n">globalSideId</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1956"></a>                             <span class="n">decomp</span> <span class="p">%</span> <span class="n">mpiComm</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1957"></a>                             <span class="n">requests</span><span class="p">(</span><span class="n">msgCount</span><span class="p">),</span><span class="n">iError</span><span class="p">)</span>
<a name="ln-1958"></a>  
<a name="ln-1959"></a>              <span class="c">! Send nid1(l) from this rank to nid2(l) on the other rank</span>
<a name="ln-1960"></a>              <span class="n">msgCount</span> <span class="o">=</span> <span class="n">msgCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1961"></a>              <span class="k">CALL </span><span class="n">MPI_ISEND</span><span class="p">(</span><span class="n">nid1</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1962"></a>                             <span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1963"></a>                             <span class="n">MPI_INTEGER</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1964"></a>                             <span class="n">neighborRank</span><span class="p">,</span><span class="n">globalSideId</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1965"></a>                             <span class="n">decomp</span> <span class="p">%</span> <span class="n">mpiComm</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1966"></a>                             <span class="n">requests</span><span class="p">(</span><span class="n">msgCount</span><span class="p">),</span><span class="n">iError</span><span class="p">)</span>
<a name="ln-1967"></a>  
<a name="ln-1968"></a>            <span class="n">ENDDO</span>
<a name="ln-1969"></a>
<a name="ln-1970"></a>          <span class="n">ENDIF</span> <span class="c">! MPI or not</span>
<a name="ln-1971"></a>
<a name="ln-1972"></a>        <span class="n">ENDIF</span> <span class="c">! If not physical boundary</span>
<a name="ln-1973"></a>
<a name="ln-1974"></a>      <span class="n">ENDDO</span>
<a name="ln-1975"></a>    <span class="n">ENDDO</span>
<a name="ln-1976"></a>
<a name="ln-1977"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">decomp</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">msgCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1978"></a><span class="k">      CALL </span><span class="n">MPI_WaitAll</span><span class="p">(</span><span class="n">msgCount</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1979"></a>                       <span class="n">requests</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">msgCount</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1980"></a>                       <span class="n">stats</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MPI_STATUS_SIZE</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">msgCount</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1981"></a>                       <span class="n">iError</span><span class="p">)</span>
<a name="ln-1982"></a>    <span class="n">ENDIF</span>
<a name="ln-1983"></a>
<a name="ln-1984"></a>    <span class="k">DO </span><span class="n">e1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-1985"></a>      <span class="k">DO </span><span class="n">s1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">6</span>
<a name="ln-1986"></a>
<a name="ln-1987"></a>        <span class="n">s2</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span>
<a name="ln-1988"></a>        <span class="n">bcid</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span>
<a name="ln-1989"></a>        <span class="n">nloc1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">nid1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span>
<a name="ln-1990"></a>        <span class="n">nloc2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">nid2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span>
<a name="ln-1991"></a>
<a name="ln-1992"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">bcid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1993"></a><span class="k">          </span><span class="n">nShifts</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1994"></a>          <span class="n">theyMatch</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1995"></a>
<a name="ln-1996"></a>          <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-1997"></a>
<a name="ln-1998"></a>            <span class="n">theyMatch</span> <span class="o">=</span> <span class="n">CompareArray</span><span class="p">(</span> <span class="n">nloc1</span><span class="p">,</span> <span class="n">nloc2</span><span class="p">,</span> <span class="mi">4</span> <span class="p">)</span>
<a name="ln-1999"></a>
<a name="ln-2000"></a>            <span class="k">IF</span><span class="p">(</span> <span class="n">theyMatch</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-2001"></a><span class="k">              EXIT</span>
<a name="ln-2002"></a><span class="k">            ELSE</span>
<a name="ln-2003"></a><span class="k">              </span><span class="n">nShifts</span> <span class="o">=</span> <span class="n">nShifts</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2004"></a>              <span class="k">CALL </span><span class="n">ForwardShift</span><span class="p">(</span> <span class="n">nloc1</span><span class="p">,</span> <span class="mi">4</span> <span class="p">)</span>
<a name="ln-2005"></a>            <span class="n">ENDIF</span>
<a name="ln-2006"></a>
<a name="ln-2007"></a>          <span class="n">ENDDO</span>
<a name="ln-2008"></a>
<a name="ln-2009"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">s2</span><span class="o">+</span><span class="n">nShifts</span>
<a name="ln-2010"></a>
<a name="ln-2011"></a>        <span class="n">ENDIF</span>
<a name="ln-2012"></a>
<a name="ln-2013"></a>      <span class="n">ENDDO</span>
<a name="ln-2014"></a>    <span class="n">ENDDO</span>
<a name="ln-2015"></a>
<a name="ln-2016"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">requests</span><span class="p">)</span>
<a name="ln-2017"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span>
<a name="ln-2018"></a>
<a name="ln-2019"></a>  <span class="k">END SUBROUTINE </span><span class="n">RecalculateFlip_Mesh3D</span>
<a name="ln-2020"></a>
<a name="ln-2021"></a>  <span class="k">SUBROUTINE </span><span class="n">Read_HOPr_Mesh3D_serial</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">meshFile</span><span class="p">)</span>
<a name="ln-2022"></a>    <span class="c">! From https://www.hopr-project.org/externals/Meshformat.pdf, Algorithm 6</span>
<a name="ln-2023"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2024"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-2025"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">meshFile</span>
<a name="ln-2026"></a>    <span class="c">! Local</span>
<a name="ln-2027"></a>    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">HID_T</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fileId</span>
<a name="ln-2028"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGlobalElem</span>
<a name="ln-2029"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nLocalNodes</span>
<a name="ln-2030"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nLocalSides</span>
<a name="ln-2031"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nUniqueSides</span>
<a name="ln-2032"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGeo</span><span class="p">,</span><span class="n">nBCs</span>
<a name="ln-2033"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">eid</span><span class="p">,</span> <span class="n">lsid</span><span class="p">,</span> <span class="n">iSide</span>
<a name="ln-2034"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_elemInfo</span>
<a name="ln-2035"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_sideInfo</span>
<a name="ln-2036"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_nodeCoords</span>
<a name="ln-2037"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_globalNodeIDs</span>
<a name="ln-2038"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bcType</span>
<a name="ln-2039"></a>
<a name="ln-2040"></a>    <span class="k">CALL </span><span class="n">Open_HDF5</span><span class="p">(</span><span class="n">meshFile</span><span class="p">,</span><span class="n">H5F_ACC_RDWR_F</span><span class="p">,</span><span class="n">fileId</span><span class="p">)</span>
<a name="ln-2041"></a>
<a name="ln-2042"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nElems&#39;</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="p">)</span>
<a name="ln-2043"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;Ngeo&#39;</span><span class="p">,</span><span class="n">nGeo</span><span class="p">)</span>
<a name="ln-2044"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nBCs&#39;</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-2045"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nUniqueSides&#39;</span><span class="p">,</span><span class="n">nUniqueSides</span><span class="p">)</span>
<a name="ln-2046"></a>
<a name="ln-2047"></a>    <span class="k">PRINT</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Reading mesh file &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">meshFile</span><span class="p">)</span>
<a name="ln-2048"></a>    <span class="k">PRINT</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Number of Elements : &#39;</span><span class="p">,</span> <span class="n">nGlobalElem</span>
<a name="ln-2049"></a>    <span class="k">PRINT</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Input polynomial degree : &#39;</span><span class="p">,</span> <span class="n">nGeo</span>
<a name="ln-2050"></a>    <span class="k">PRINT</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Number of BC types : &#39;</span><span class="p">,</span> <span class="n">nBCs</span>
<a name="ln-2051"></a>
<a name="ln-2052"></a>    <span class="c">! Read BCType</span>
<a name="ln-2053"></a>    <span class="k">CALL </span><span class="n">bcType</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2054"></a>                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">nBCs</span><span class="o">/</span><span class="p">))</span>
<a name="ln-2055"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;BCType&#39;</span><span class="p">,</span><span class="n">bcType</span><span class="p">)</span>
<a name="ln-2056"></a>
<a name="ln-2057"></a>    <span class="c">! Allocate Space for hopr_elemInfo!</span>
<a name="ln-2058"></a>    <span class="k">CALL </span><span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2059"></a>                               <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-2060"></a>
<a name="ln-2061"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;ElemInfo&#39;</span><span class="p">,</span><span class="n">hopr_elemInfo</span><span class="p">)</span>
<a name="ln-2062"></a>
<a name="ln-2063"></a>    <span class="c">! Read local subarray of NodeCoords and GlobalNodeIDs</span>
<a name="ln-2064"></a>    <span class="n">nLocalNodes</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="p">)</span> <span class="o">-</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2065"></a>
<a name="ln-2066"></a>    <span class="c">! Allocate Space for hopr_nodeCoords and hopr_globalNodeIDs !</span>
<a name="ln-2067"></a>    <span class="k">CALL </span><span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2068"></a>                                 <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="n">nLocalNodes</span><span class="o">/</span><span class="p">))</span>
<a name="ln-2069"></a>
<a name="ln-2070"></a>    <span class="k">CALL </span><span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2071"></a>                                    <span class="n">upBound</span><span class="o">=</span><span class="n">nLocalNodes</span><span class="p">)</span>
<a name="ln-2072"></a>
<a name="ln-2073"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;NodeCoords&#39;</span><span class="p">,</span><span class="n">hopr_nodeCoords</span><span class="p">)</span>
<a name="ln-2074"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;GlobalNodeIDs&#39;</span><span class="p">,</span><span class="n">hopr_globalNodeIDs</span><span class="p">)</span>
<a name="ln-2075"></a>    <span class="c">! Read local subarray of SideInfo</span>
<a name="ln-2076"></a>    <span class="n">nLocalSides</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="p">)</span> <span class="o">-</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2077"></a>    <span class="k">PRINT</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Number of local sides : &#39;</span><span class="p">,</span> <span class="n">nLocalSides</span>
<a name="ln-2078"></a>
<a name="ln-2079"></a>    <span class="c">! Allocate space for hopr_sideInfo</span>
<a name="ln-2080"></a>    <span class="k">CALL </span><span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2081"></a>                               <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">nLocalSides</span><span class="o">/</span><span class="p">))</span>
<a name="ln-2082"></a>
<a name="ln-2083"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;SideInfo&#39;</span><span class="p">,</span><span class="n">hopr_sideInfo</span><span class="p">)</span>
<a name="ln-2084"></a>
<a name="ln-2085"></a>    <span class="k">CALL </span><span class="n">Close_HDF5</span><span class="p">(</span><span class="n">fileID</span><span class="p">)</span>
<a name="ln-2086"></a>
<a name="ln-2087"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="p">,</span><span class="n">nLocalSides</span><span class="p">,</span><span class="n">nLocalNodes</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-2088"></a>
<a name="ln-2089"></a>    <span class="c">! Copy data from local arrays into myMesh</span>
<a name="ln-2090"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-2091"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-2092"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-2093"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-2094"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span> <span class="o">=</span> <span class="n">nUniqueSides</span>
<a name="ln-2095"></a>
<a name="ln-2096"></a>    <span class="n">iSide</span> <span class="o">=</span> <span class="mi">0</span> 
<a name="ln-2097"></a>    <span class="k">DO </span><span class="n">eid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-2098"></a>      <span class="k">DO </span><span class="n">lsid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">6</span>
<a name="ln-2099"></a>        <span class="n">iSide</span> <span class="o">=</span> <span class="n">iSide</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2100"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="n">iSide</span><span class="p">)</span>
<a name="ln-2101"></a>      <span class="n">ENDDO</span>
<a name="ln-2102"></a>    <span class="n">ENDDO</span>
<a name="ln-2103"></a>
<a name="ln-2104"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">RecalculateFlip</span><span class="p">()</span>
<a name="ln-2105"></a>
<a name="ln-2106"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-2107"></a>
<a name="ln-2108"></a>    <span class="k">CALL </span><span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-2109"></a>    <span class="k">CALL </span><span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-2110"></a>    <span class="k">CALL </span><span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-2111"></a>    <span class="k">CALL </span><span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-2112"></a>
<a name="ln-2113"></a>  <span class="k">END SUBROUTINE </span><span class="n">Read_HOPr_Mesh3D_serial</span>
<a name="ln-2114"></a>
<a name="ln-2115"></a>  <span class="k">SUBROUTINE </span><span class="n">Read_HOPr_Mesh3D_parallel</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">meshFile</span><span class="p">,</span><span class="n">decomp</span><span class="p">)</span>
<a name="ln-2116"></a>    <span class="c">! From https://www.hopr-project.org/externals/Meshformat.pdf, Algorithm 6</span>
<a name="ln-2117"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2118"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-2119"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">meshFile</span>
<a name="ln-2120"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MPILayer</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">decomp</span>
<a name="ln-2121"></a>    <span class="c">! Local</span>
<a name="ln-2122"></a>    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">HID_T</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fileId</span>
<a name="ln-2123"></a>    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">HID_T</span><span class="p">)</span> <span class="kd">::</span> <span class="n">offset</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">),</span><span class="n">gOffset</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2124"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGlobalElem</span>
<a name="ln-2125"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">firstElem</span><span class="p">,</span><span class="n">nLocalElems</span>
<a name="ln-2126"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">firstNode</span><span class="p">,</span><span class="n">nLocalNodes</span>
<a name="ln-2127"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">firstSide</span><span class="p">,</span><span class="n">nLocalSides</span>
<a name="ln-2128"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nUniqueSides</span>
<a name="ln-2129"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGeo</span><span class="p">,</span><span class="n">nBCs</span>
<a name="ln-2130"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">eid</span><span class="p">,</span> <span class="n">lsid</span><span class="p">,</span> <span class="n">iSide</span>
<a name="ln-2131"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_elemInfo</span>
<a name="ln-2132"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_sideInfo</span>
<a name="ln-2133"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_nodeCoords</span>
<a name="ln-2134"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hopr_globalNodeIDs</span>
<a name="ln-2135"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bcType</span>
<a name="ln-2136"></a>
<a name="ln-2137"></a>    <span class="k">PRINT</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Reading mesh file &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">meshFile</span><span class="p">)</span>
<a name="ln-2138"></a>    <span class="k">CALL </span><span class="n">Open_HDF5</span><span class="p">(</span><span class="n">meshFile</span><span class="p">,</span><span class="n">H5F_ACC_RDONLY_F</span><span class="p">,</span><span class="n">fileId</span><span class="p">,</span><span class="n">decomp</span> <span class="p">%</span> <span class="n">mpiComm</span><span class="p">)</span>
<a name="ln-2139"></a>
<a name="ln-2140"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nElems&#39;</span><span class="p">,</span><span class="n">nGlobalElem</span><span class="p">)</span>
<a name="ln-2141"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;Ngeo&#39;</span><span class="p">,</span><span class="n">nGeo</span><span class="p">)</span>
<a name="ln-2142"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nBCs&#39;</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-2143"></a>    <span class="k">CALL </span><span class="n">ReadAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nUniqueSides&#39;</span><span class="p">,</span><span class="n">nUniqueSides</span><span class="p">)</span>
<a name="ln-2144"></a>
<a name="ln-2145"></a>    <span class="k">PRINT</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Number of Global Elements : &#39;</span><span class="p">,</span> <span class="n">nGlobalElem</span>
<a name="ln-2146"></a>    <span class="k">PRINT</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Input polynomial degree : &#39;</span><span class="p">,</span> <span class="n">nGeo</span>
<a name="ln-2147"></a>    <span class="k">PRINT</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Number of BC types : &#39;</span><span class="p">,</span> <span class="n">nBCs</span>
<a name="ln-2148"></a>
<a name="ln-2149"></a>    <span class="c">! Read BCType</span>
<a name="ln-2150"></a>    <span class="k">CALL </span><span class="n">bcType</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2151"></a>                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">nBCs</span><span class="o">/</span><span class="p">))</span>
<a name="ln-2152"></a>    <span class="n">offset</span><span class="p">(:)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2153"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;BCType&#39;</span><span class="p">,</span><span class="n">bcType</span><span class="p">,</span><span class="n">offset</span><span class="p">)</span>
<a name="ln-2154"></a>
<a name="ln-2155"></a>    <span class="c">! Read local subarray of ElemInfo</span>
<a name="ln-2156"></a>    <span class="k">CALL </span><span class="n">decomp</span> <span class="p">%</span> <span class="n">SetElemToRank</span><span class="p">(</span><span class="n">nGlobalElem</span><span class="p">)</span>
<a name="ln-2157"></a>    <span class="n">firstElem</span> <span class="o">=</span> <span class="n">decomp</span> <span class="p">%</span> <span class="n">offsetElem</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">decomp</span> <span class="p">%</span> <span class="n">rankId</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2158"></a>    <span class="n">nLocalElems</span> <span class="o">=</span> <span class="n">decomp</span> <span class="p">%</span> <span class="n">offsetElem</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">decomp</span> <span class="p">%</span> <span class="n">rankId</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="p">&amp;</span> 
<a name="ln-2159"></a>                  <span class="n">decomp</span> <span class="p">%</span> <span class="n">offsetElem</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">decomp</span> <span class="p">%</span> <span class="n">rankId</span><span class="p">)</span> 
<a name="ln-2160"></a>
<a name="ln-2161"></a>    <span class="k">PRINT</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Number of Local Elements : &#39;</span><span class="p">,</span> <span class="n">nLocalElems</span>
<a name="ln-2162"></a>
<a name="ln-2163"></a>    <span class="c">! Allocate Space for hopr_elemInfo!</span>
<a name="ln-2164"></a>    <span class="k">CALL </span><span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2165"></a>                               <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span><span class="n">nLocalElems</span><span class="o">/</span><span class="p">))</span>
<a name="ln-2166"></a>
<a name="ln-2167"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="n">firstElem</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">)</span>
<a name="ln-2168"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;ElemInfo&#39;</span><span class="p">,</span><span class="n">hopr_elemInfo</span><span class="p">,</span><span class="n">offset</span><span class="p">)</span>
<a name="ln-2169"></a>
<a name="ln-2170"></a>    <span class="c">! Read local subarray of NodeCoords and GlobalNodeIDs</span>
<a name="ln-2171"></a>    <span class="n">firstNode</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2172"></a>    <span class="n">nLocalNodes</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">nLocalElems</span><span class="p">)</span> <span class="o">-</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2173"></a>
<a name="ln-2174"></a>    <span class="c">! Allocate Space for hopr_nodeCoords and hopr_globalNodeIDs !</span>
<a name="ln-2175"></a>    <span class="k">CALL </span><span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2176"></a>                                 <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="n">nLocalNodes</span><span class="o">/</span><span class="p">))</span>
<a name="ln-2177"></a>
<a name="ln-2178"></a>    <span class="k">CALL </span><span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2179"></a>                                    <span class="n">upBound</span><span class="o">=</span><span class="n">nLocalNodes</span><span class="p">)</span>
<a name="ln-2180"></a>
<a name="ln-2181"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="n">firstNode</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">)</span>
<a name="ln-2182"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;NodeCoords&#39;</span><span class="p">,</span><span class="n">hopr_nodeCoords</span><span class="p">,</span><span class="n">offset</span><span class="p">)</span>
<a name="ln-2183"></a>    <span class="n">gOffset</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">firstNode</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">)</span>
<a name="ln-2184"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;GlobalNodeIDs&#39;</span><span class="p">,</span><span class="n">hopr_globalNodeIDs</span><span class="p">,</span><span class="n">gOffset</span><span class="p">)</span>
<a name="ln-2185"></a>
<a name="ln-2186"></a>    <span class="c">! Read local subarray of SideInfo</span>
<a name="ln-2187"></a>    <span class="n">firstSide</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2188"></a>    <span class="n">nLocalSides</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">nLocalElems</span><span class="p">)</span> <span class="o">-</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2189"></a>    <span class="k">PRINT</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Number of local sides : &#39;</span><span class="p">,</span> <span class="n">nLocalSides</span>
<a name="ln-2190"></a>
<a name="ln-2191"></a>    <span class="c">! Allocate space for hopr_sideInfo</span>
<a name="ln-2192"></a>    <span class="k">CALL </span><span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2193"></a>                               <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">nLocalSides</span><span class="o">/</span><span class="p">))</span>
<a name="ln-2194"></a>
<a name="ln-2195"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="n">firstSide</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">)</span>
<a name="ln-2196"></a>    <span class="k">CALL </span><span class="n">ReadArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;SideInfo&#39;</span><span class="p">,</span><span class="n">hopr_sideInfo</span><span class="p">,</span><span class="n">offset</span><span class="p">)</span>
<a name="ln-2197"></a>
<a name="ln-2198"></a>    <span class="k">CALL </span><span class="n">Close_HDF5</span><span class="p">(</span><span class="n">fileID</span><span class="p">)</span>
<a name="ln-2199"></a>
<a name="ln-2200"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nLocalElems</span><span class="p">,</span><span class="n">nLocalSides</span><span class="p">,</span><span class="n">nLocalNodes</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-2201"></a>
<a name="ln-2202"></a>    <span class="c">! Copy data from local arrays into myMesh</span>
<a name="ln-2203"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-2204"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-2205"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-2206"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-2207"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span> <span class="o">=</span> <span class="n">nUniqueSides</span>
<a name="ln-2208"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nGlobalElem</span> <span class="o">=</span> <span class="n">nGlobalElem</span>
<a name="ln-2209"></a>
<a name="ln-2210"></a>    <span class="n">iSide</span> <span class="o">=</span> <span class="mi">0</span> 
<a name="ln-2211"></a>    <span class="k">DO </span><span class="n">eid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-2212"></a>      <span class="k">DO </span><span class="n">lsid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">6</span>
<a name="ln-2213"></a>        <span class="n">iSide</span> <span class="o">=</span> <span class="n">iSide</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2214"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">self_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="n">lsid</span><span class="p">,</span><span class="n">eid</span><span class="p">)</span> <span class="o">=</span> <span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="n">iSide</span><span class="p">)</span>
<a name="ln-2215"></a>      <span class="n">ENDDO</span>
<a name="ln-2216"></a>    <span class="n">ENDDO</span>
<a name="ln-2217"></a>
<a name="ln-2218"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">RecalculateFlip</span><span class="p">(</span><span class="n">decomp</span><span class="p">)</span>
<a name="ln-2219"></a>
<a name="ln-2220"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-2221"></a>
<a name="ln-2222"></a>    <span class="k">CALL </span><span class="n">hopr_elemInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-2223"></a>    <span class="k">CALL </span><span class="n">hopr_nodeCoords</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-2224"></a>    <span class="k">CALL </span><span class="n">hopr_globalNodeIDs</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-2225"></a>    <span class="k">CALL </span><span class="n">hopr_sideInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-2226"></a>
<a name="ln-2227"></a>  <span class="k">END SUBROUTINE </span><span class="n">Read_HOPr_Mesh3D_parallel</span>
<a name="ln-2228"></a>
<a name="ln-2229"></a>  <span class="k">SUBROUTINE </span><span class="n">Write_HOPr_Mesh3D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">meshFile</span><span class="p">)</span>
<a name="ln-2230"></a>    <span class="c">! Writes mesh output in HOPR format (serial only)</span>
<a name="ln-2231"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2232"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-2233"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">meshFile</span>
<a name="ln-2234"></a>    <span class="c">! Local</span>
<a name="ln-2235"></a>    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">HID_T</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fileId</span>
<a name="ln-2236"></a>
<a name="ln-2237"></a>    <span class="k">CALL </span><span class="n">Open_HDF5</span><span class="p">(</span><span class="n">meshFile</span><span class="p">,</span><span class="n">H5F_ACC_RDWR_F</span><span class="p">,</span><span class="n">fileId</span><span class="p">)</span>
<a name="ln-2238"></a>
<a name="ln-2239"></a>    <span class="k">CALL </span><span class="n">WriteAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nElems&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-2240"></a>    <span class="k">CALL </span><span class="n">WriteAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;Ngeo&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nGeo</span><span class="p">)</span>
<a name="ln-2241"></a>    <span class="k">CALL </span><span class="n">WriteAttribute_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;nBCs&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nBCs</span><span class="p">)</span>
<a name="ln-2242"></a>
<a name="ln-2243"></a>    <span class="k">CALL </span><span class="n">WriteArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;BCType&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">bcType</span><span class="p">)</span>
<a name="ln-2244"></a>    <span class="k">CALL </span><span class="n">WriteArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;ElemInfo&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_elemInfo</span><span class="p">)</span>
<a name="ln-2245"></a>
<a name="ln-2246"></a>    <span class="c">! Read local subarray of NodeCoords and GlobalNodeIDs</span>
<a name="ln-2247"></a>    <span class="k">CALL </span><span class="n">WriteArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;NodeCoords&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_nodeCoords</span><span class="p">)</span>
<a name="ln-2248"></a>    <span class="k">CALL </span><span class="n">WriteArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;GlobalNodeIDs&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_globalNodeIDs</span><span class="p">)</span>
<a name="ln-2249"></a>
<a name="ln-2250"></a>    <span class="c">! Read local subarray of SideInfo</span>
<a name="ln-2251"></a>    <span class="k">CALL </span><span class="n">WriteArray_HDF5</span><span class="p">(</span><span class="n">fileId</span><span class="p">,</span><span class="s1">&#39;SideInfo&#39;</span><span class="p">,</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">hopr_sideInfo</span><span class="p">)</span>
<a name="ln-2252"></a>
<a name="ln-2253"></a>    <span class="k">CALL </span><span class="n">Close_HDF5</span><span class="p">(</span><span class="n">fileID</span><span class="p">)</span>
<a name="ln-2254"></a>
<a name="ln-2255"></a>  <span class="k">END SUBROUTINE </span><span class="n">Write_HOPr_Mesh3D</span>
<a name="ln-2256"></a>
<a name="ln-2257"></a><span class="c">!  FUNCTION TransfiniteInterpolation_2D( interp, bCurves, iEl, a, b ) RESULT( P )</span>
<a name="ln-2258"></a><span class="c">!    ! TransfiniteInterpolation</span>
<a name="ln-2259"></a><span class="c">!    !  Takes in the six surfaces (south, east, north, west, bottom, top) and evaluates the</span>
<a name="ln-2260"></a><span class="c">!    !  bidirectional mapping at xi^1 = a, xi^2 = b, xi^3 = c. The boundary of the computational</span>
<a name="ln-2261"></a><span class="c">!    !  coordinate system is assumed to be at +/- 1 in each direction.</span>
<a name="ln-2262"></a><span class="c">!    !</span>
<a name="ln-2263"></a><span class="c">!    ! =============================================================================================== !</span>
<a name="ln-2264"></a><span class="c">!    ! DECLARATIONS</span>
<a name="ln-2265"></a><span class="c">!    IMPLICIT NONE</span>
<a name="ln-2266"></a><span class="c">!    REAL(prec) :: bCurves(1:2,1:4)</span>
<a name="ln-2267"></a><span class="c">!    INTEGER :: i,j</span>
<a name="ln-2268"></a><span class="c">!    REAL(prec) :: P(1:2)</span>
<a name="ln-2269"></a><span class="c">!    ! LOCAL</span>
<a name="ln-2270"></a><span class="c">!    REAL(prec)  :: P1(1:2), P2(1:2), P2(1:2)</span>
<a name="ln-2271"></a><span class="c">!    REAL(prec)  :: sSurf(1:2), nSurf(1:2), eSurf(1:2), wSurf(1:2)</span>
<a name="ln-2272"></a><span class="c">!    REAL(prec)  :: l1(1:2), l2(1:2), l2(1:2)</span>
<a name="ln-2273"></a><span class="c">!    REAL(prec)  :: ref(1:2)</span>
<a name="ln-2274"></a><span class="c">!    INTEGER     :: i, j, iSurf</span>
<a name="ln-2275"></a><span class="c">!</span>
<a name="ln-2276"></a><span class="c">!    ref = (/ -1.0_prec, 1.0_prec /)</span>
<a name="ln-2277"></a><span class="c">!</span>
<a name="ln-2278"></a><span class="c">!    ! Transfinite interpolation with linear blending USEs linear lagrange interpolating polynomials</span>
<a name="ln-2279"></a><span class="c">!    ! to blend the bounding surfaces.</span>
<a name="ln-2280"></a><span class="c">!    ! The linear blending weights in the first computational direction are calculated.</span>
<a name="ln-2281"></a><span class="c">!</span>
<a name="ln-2282"></a><span class="c">!    l1 = LinearBlend(a)</span>
<a name="ln-2283"></a><span class="c">!    l2 = LinearBlend(b)</span>
<a name="ln-2284"></a><span class="c">!    l3 = LinearBlend(c)</span>
<a name="ln-2285"></a><span class="c">!</span>
<a name="ln-2286"></a><span class="c">!    ! The bounding surfaces need to be evaluated at the provided computational coordinates</span>
<a name="ln-2287"></a><span class="c">!</span>
<a name="ln-2288"></a><span class="c">!    wSurf = bCurves(1:2,4)</span>
<a name="ln-2289"></a><span class="c">!    eSurf = bCurves(1:2,2)</span>
<a name="ln-2290"></a><span class="c">!    sSurf = bCurves(1:2,1)</span>
<a name="ln-2291"></a><span class="c">!    nSurf = bCurves(1:2,3)</span>
<a name="ln-2292"></a><span class="c">!</span>
<a name="ln-2293"></a><span class="c">!    ! P1 CONTAINS the interpolation in the first computational coordinate</span>
<a name="ln-2294"></a><span class="c">!    ! The first computational coordinate is assumed to vary between the (computational) east and</span>
<a name="ln-2295"></a><span class="c">!    ! west boundaries.</span>
<a name="ln-2296"></a><span class="c">!</span>
<a name="ln-2297"></a><span class="c">!    P1 = l1(1)*wSurf + l1(2)*eSurf</span>
<a name="ln-2298"></a><span class="c">!</span>
<a name="ln-2299"></a><span class="c">!    ! P2 CONTAINS the interpolation in the second computational coordinate</span>
<a name="ln-2300"></a><span class="c">!    ! The second computational coordinate is assumed to vary between the (computational) south and</span>
<a name="ln-2301"></a><span class="c">!    ! north boundaries.</span>
<a name="ln-2302"></a><span class="c">!</span>
<a name="ln-2303"></a><span class="c">!    P2 = l2(1)*sSurf + l2(2)*nSurf</span>
<a name="ln-2304"></a><span class="c">!</span>
<a name="ln-2305"></a><span class="c">!    ! P3 CONTAINS the interpolation in the first computational coordinate</span>
<a name="ln-2306"></a><span class="c">!    ! The first computational coordinate is assumed to vary between the (computational) bottom and</span>
<a name="ln-2307"></a><span class="c">!    ! top boundaries.</span>
<a name="ln-2308"></a><span class="c">!</span>
<a name="ln-2309"></a><span class="c">!    P3 = l3(1)*bSurf + l3(2)*tSurf</span>
<a name="ln-2310"></a><span class="c">!</span>
<a name="ln-2311"></a><span class="c">!    DO i = 1, 2</span>
<a name="ln-2312"></a><span class="c">!</span>
<a name="ln-2313"></a><span class="c">!      ! Now we need to compute the tensor product of the first and second computational direction</span>
<a name="ln-2314"></a><span class="c">!      ! interpolants and subtract from P1.</span>
<a name="ln-2315"></a><span class="c">!</span>
<a name="ln-2316"></a><span class="c">!      wSurf = boundingsurfaces % Evaluate( (/ref(i), c/), west + (iEl-1)*6 )</span>
<a name="ln-2317"></a><span class="c">!      eSurf = boundingsurfaces % Evaluate( (/ref(i), c/), east + (iEl-1)*6 )</span>
<a name="ln-2318"></a><span class="c">!      P1 = P1 - l2(i)*( wSurf*l1(1) + eSurf*l1(2) )</span>
<a name="ln-2319"></a><span class="c">!</span>
<a name="ln-2320"></a><span class="c">!      ! Now we need to compute the tensor product of the first and third computational direction</span>
<a name="ln-2321"></a><span class="c">!      ! interpolants and subtract from P1.</span>
<a name="ln-2322"></a><span class="c">!</span>
<a name="ln-2323"></a><span class="c">!      wSurf = boundingsurfaces % Evaluate( (/b, ref(i)/), west + (iEl-1)*6 )</span>
<a name="ln-2324"></a><span class="c">!      eSurf = boundingsurfaces % Evaluate( (/b, ref(i)/), east + (iEl-1)*6 )</span>
<a name="ln-2325"></a><span class="c">!</span>
<a name="ln-2326"></a><span class="c">!      P1 = P1 - l3(i)*( wSurf*l1(1) + eSurf*l1(2) )</span>
<a name="ln-2327"></a><span class="c">!</span>
<a name="ln-2328"></a><span class="c">!      ! Now we need to compute the tensor product of the second and third computational direction</span>
<a name="ln-2329"></a><span class="c">!      ! interpolants and subtract from P2.</span>
<a name="ln-2330"></a><span class="c">!</span>
<a name="ln-2331"></a><span class="c">!      sSurf = boundingsurfaces % Evaluate( (/a, ref(i)/), south + (iEl-1)*6 )</span>
<a name="ln-2332"></a><span class="c">!      nSurf = boundingsurfaces % Evaluate( (/a, ref(i)/), north + (iEl-1)*6 )</span>
<a name="ln-2333"></a><span class="c">!</span>
<a name="ln-2334"></a><span class="c">!      P2 = P2 - l3(i)*( sSurf*l2(1) + nSurf*l2(2) )</span>
<a name="ln-2335"></a><span class="c">!</span>
<a name="ln-2336"></a><span class="c">!    ENDDO</span>
<a name="ln-2337"></a><span class="c">!</span>
<a name="ln-2338"></a><span class="c">!    ! Next, the compounded tensor product is computed and added to P3.</span>
<a name="ln-2339"></a><span class="c">!    DO j = 1,2</span>
<a name="ln-2340"></a><span class="c">!      DO i = 1,2</span>
<a name="ln-2341"></a><span class="c">!</span>
<a name="ln-2342"></a><span class="c">!        wSurf = boundingsurfaces % Evaluate( (/ref(i), ref(j)/), west + (iEl-1)*6 )</span>
<a name="ln-2343"></a><span class="c">!        eSurf = boundingsurfaces % Evaluate( (/ref(i), ref(j)/), east + (iEl-1)*6 )</span>
<a name="ln-2344"></a><span class="c">!        P3 = P3 + l2(i)*l3(j)*( wSurf*l1(1) + eSurf*l1(2) )</span>
<a name="ln-2345"></a><span class="c">!</span>
<a name="ln-2346"></a><span class="c">!      ENDDO</span>
<a name="ln-2347"></a><span class="c">!    ENDDO</span>
<a name="ln-2348"></a><span class="c">!</span>
<a name="ln-2349"></a><span class="c">!    !Finally, the sum the interpolants is computed to yield the computational coordinate</span>
<a name="ln-2350"></a><span class="c">!    P = P1 + P2 + P3</span>
<a name="ln-2351"></a><span class="c">!</span>
<a name="ln-2352"></a><span class="c">!  END FUNCTION TransfiniteInterpolation_2D</span>
<a name="ln-2353"></a>
<a name="ln-2354"></a><span class="c">!  FUNCTION TransfiniteInterpolation( boundingSurfaces, iEl, a, b, c ) RESULT( P )</span>
<a name="ln-2355"></a><span class="c">!    ! TransfiniteInterpolation</span>
<a name="ln-2356"></a><span class="c">!    !  Takes in the six surfaces (south, east, north, west, bottom, top) and evaluates the</span>
<a name="ln-2357"></a><span class="c">!    !  bidirectional mapping at xi^1 = a, xi^2 = b, xi^3 = c. The boundary of the computational</span>
<a name="ln-2358"></a><span class="c">!    !  coordinate system is assumed to be at +/- 1 in each direction.</span>
<a name="ln-2359"></a><span class="c">!    !</span>
<a name="ln-2360"></a><span class="c">!    ! =============================================================================================== !</span>
<a name="ln-2361"></a><span class="c">!    ! DECLARATIONS</span>
<a name="ln-2362"></a><span class="c">!    IMPLICIT NONE</span>
<a name="ln-2363"></a><span class="c">!    TYPE( Surfaces )  :: boundingSurfaces</span>
<a name="ln-2364"></a><span class="c">!    INTEGER           :: iEl</span>
<a name="ln-2365"></a><span class="c">!    REAL(prec)       :: a, b, c</span>
<a name="ln-2366"></a><span class="c">!    REAL(prec)       :: P(1:3)</span>
<a name="ln-2367"></a><span class="c">!    ! LOCAL</span>
<a name="ln-2368"></a><span class="c">!    REAL(prec)  :: P1(1:3), P2(1:3), P3(1:3)</span>
<a name="ln-2369"></a><span class="c">!    REAL(prec)  :: sSurf(1:3), nSurf(1:3), eSurf(1:3), wSurf(1:3), bSurf(1:3), tSurf(1:3)</span>
<a name="ln-2370"></a><span class="c">!    REAL(prec)  :: l1(1:2), l2(1:2), l3(1:2)</span>
<a name="ln-2371"></a><span class="c">!    REAL(prec)  :: ref(1:2)</span>
<a name="ln-2372"></a><span class="c">!    INTEGER     :: i, j, iSurf</span>
<a name="ln-2373"></a><span class="c">!</span>
<a name="ln-2374"></a><span class="c">!    ref = (/ -1.0_prec, 1.0_prec /)</span>
<a name="ln-2375"></a><span class="c">!</span>
<a name="ln-2376"></a><span class="c">!    ! Transfinite interpolation with linear blending USEs linear lagrange interpolating polynomials</span>
<a name="ln-2377"></a><span class="c">!    ! to blend the bounding surfaces.</span>
<a name="ln-2378"></a><span class="c">!    ! The linear blending weights in the first computational direction are calculated.</span>
<a name="ln-2379"></a><span class="c">!</span>
<a name="ln-2380"></a><span class="c">!    l1 = LinearBlend( a )</span>
<a name="ln-2381"></a><span class="c">!    l2 = LinearBlend( b )</span>
<a name="ln-2382"></a><span class="c">!    l3 = LinearBlend( c )</span>
<a name="ln-2383"></a><span class="c">!</span>
<a name="ln-2384"></a><span class="c">!    ! The bounding surfaces need to be evaluated at the provided computational coordinates</span>
<a name="ln-2385"></a><span class="c">!</span>
<a name="ln-2386"></a><span class="c">!    wSurf = boundingSurfaces % Evaluate( (/b, c/), west + (iEl-1)*6 )   ! west</span>
<a name="ln-2387"></a><span class="c">!    eSurf = boundingSurfaces % Evaluate( (/b, c/), east + (iEl-1)*6 )   ! east</span>
<a name="ln-2388"></a><span class="c">!    sSurf = boundingSurfaces % Evaluate( (/a, c/), south + (iEl-1)*6 )  ! south</span>
<a name="ln-2389"></a><span class="c">!    nSurf = boundingSurfaces % Evaluate( (/a, c/), north + (iEl-1)*6 )  ! north</span>
<a name="ln-2390"></a><span class="c">!    bSurf = boundingSurfaces % Evaluate( (/a, b/), bottom + (iEl-1)*6 ) ! bottom</span>
<a name="ln-2391"></a><span class="c">!    tSurf = boundingSurfaces % Evaluate( (/a, b/), top + (iEl-1)*6 )    ! top</span>
<a name="ln-2392"></a><span class="c">!</span>
<a name="ln-2393"></a><span class="c">!    ! P1 CONTAINS the interpolation in the first computational coordinate</span>
<a name="ln-2394"></a><span class="c">!    ! The first computational coordinate is assumed to vary between the (computational) east and</span>
<a name="ln-2395"></a><span class="c">!    ! west boundaries.</span>
<a name="ln-2396"></a><span class="c">!</span>
<a name="ln-2397"></a><span class="c">!    P1 = l1(1)*wSurf + l1(2)*eSurf</span>
<a name="ln-2398"></a><span class="c">!</span>
<a name="ln-2399"></a><span class="c">!    ! P2 CONTAINS the interpolation in the second computational coordinate</span>
<a name="ln-2400"></a><span class="c">!    ! The second computational coordinate is assumed to vary between the (computational) south and</span>
<a name="ln-2401"></a><span class="c">!    ! north boundaries.</span>
<a name="ln-2402"></a><span class="c">!</span>
<a name="ln-2403"></a><span class="c">!    P2 = l2(1)*sSurf + l2(2)*nSurf</span>
<a name="ln-2404"></a><span class="c">!</span>
<a name="ln-2405"></a><span class="c">!    ! P3 CONTAINS the interpolation in the first computational coordinate</span>
<a name="ln-2406"></a><span class="c">!    ! The first computational coordinate is assumed to vary between the (computational) bottom and</span>
<a name="ln-2407"></a><span class="c">!    ! top boundaries.</span>
<a name="ln-2408"></a><span class="c">!</span>
<a name="ln-2409"></a><span class="c">!    P3 = l3(1)*bSurf + l3(2)*tSurf</span>
<a name="ln-2410"></a><span class="c">!</span>
<a name="ln-2411"></a><span class="c">!    DO i = 1, 2</span>
<a name="ln-2412"></a><span class="c">!</span>
<a name="ln-2413"></a><span class="c">!      ! Now we need to compute the tensor product of the first and second computational direction</span>
<a name="ln-2414"></a><span class="c">!      ! interpolants and subtract from P1.</span>
<a name="ln-2415"></a><span class="c">!</span>
<a name="ln-2416"></a><span class="c">!      wSurf = boundingsurfaces % Evaluate( (/ref(i), c/), west + (iEl-1)*6 )</span>
<a name="ln-2417"></a><span class="c">!      eSurf = boundingsurfaces % Evaluate( (/ref(i), c/), east + (iEl-1)*6 )</span>
<a name="ln-2418"></a><span class="c">!      P1 = P1 - l2(i)*( wSurf*l1(1) + eSurf*l1(2) )</span>
<a name="ln-2419"></a><span class="c">!</span>
<a name="ln-2420"></a><span class="c">!      ! Now we need to compute the tensor product of the first and third computational direction</span>
<a name="ln-2421"></a><span class="c">!      ! interpolants and subtract from P1.</span>
<a name="ln-2422"></a><span class="c">!</span>
<a name="ln-2423"></a><span class="c">!      wSurf = boundingsurfaces % Evaluate( (/b, ref(i)/), west + (iEl-1)*6 )</span>
<a name="ln-2424"></a><span class="c">!      eSurf = boundingsurfaces % Evaluate( (/b, ref(i)/), east + (iEl-1)*6 )</span>
<a name="ln-2425"></a><span class="c">!</span>
<a name="ln-2426"></a><span class="c">!      P1 = P1 - l3(i)*( wSurf*l1(1) + eSurf*l1(2) )</span>
<a name="ln-2427"></a><span class="c">!</span>
<a name="ln-2428"></a><span class="c">!      ! Now we need to compute the tensor product of the second and third computational direction</span>
<a name="ln-2429"></a><span class="c">!      ! interpolants and subtract from P2.</span>
<a name="ln-2430"></a><span class="c">!</span>
<a name="ln-2431"></a><span class="c">!      sSurf = boundingsurfaces % Evaluate( (/a, ref(i)/), south + (iEl-1)*6 )</span>
<a name="ln-2432"></a><span class="c">!      nSurf = boundingsurfaces % Evaluate( (/a, ref(i)/), north + (iEl-1)*6 )</span>
<a name="ln-2433"></a><span class="c">!</span>
<a name="ln-2434"></a><span class="c">!      P2 = P2 - l3(i)*( sSurf*l2(1) + nSurf*l2(2) )</span>
<a name="ln-2435"></a><span class="c">!</span>
<a name="ln-2436"></a><span class="c">!    ENDDO</span>
<a name="ln-2437"></a><span class="c">!</span>
<a name="ln-2438"></a><span class="c">!    ! Next, the compounded tensor product is computed and added to P3.</span>
<a name="ln-2439"></a><span class="c">!    DO j = 1,2</span>
<a name="ln-2440"></a><span class="c">!      DO i = 1,2</span>
<a name="ln-2441"></a><span class="c">!</span>
<a name="ln-2442"></a><span class="c">!        wSurf = boundingsurfaces % Evaluate( (/ref(i), ref(j)/), west + (iEl-1)*6 )</span>
<a name="ln-2443"></a><span class="c">!        eSurf = boundingsurfaces % Evaluate( (/ref(i), ref(j)/), east + (iEl-1)*6 )</span>
<a name="ln-2444"></a><span class="c">!        P3 = P3 + l2(i)*l3(j)*( wSurf*l1(1) + eSurf*l1(2) )</span>
<a name="ln-2445"></a><span class="c">!</span>
<a name="ln-2446"></a><span class="c">!      ENDDO</span>
<a name="ln-2447"></a><span class="c">!    ENDDO</span>
<a name="ln-2448"></a><span class="c">!</span>
<a name="ln-2449"></a><span class="c">!    !Finally, the sum the interpolants is computed to yield the computational coordinate</span>
<a name="ln-2450"></a><span class="c">!    P = P1 + P2 + P3</span>
<a name="ln-2451"></a><span class="c">!</span>
<a name="ln-2452"></a><span class="c">!  END FUNCTION TransfiniteInterpolation</span>
<a name="ln-2453"></a>  <span class="k">FUNCTION </span><span class="n">Unidirectional</span><span class="p">(</span><span class="n">valLeft</span><span class="p">,</span><span class="n">valRight</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<a name="ln-2454"></a>    <span class="c">!</span>
<a name="ln-2455"></a>    <span class="c">! =============================================================================================== !</span>
<a name="ln-2456"></a>    <span class="c">! DECLARATIONS</span>
<a name="ln-2457"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2458"></a><span class="k">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">valLeft</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span><span class="n">valRight</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2459"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span>
<a name="ln-2460"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2461"></a>
<a name="ln-2462"></a>    <span class="n">P</span> <span class="o">=</span> <span class="mf">0.5_prec</span><span class="o">*</span><span class="p">((</span><span class="mf">1.0_prec</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">valLeft</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0_prec</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">valRight</span><span class="p">)</span>
<a name="ln-2463"></a>
<a name="ln-2464"></a>  <span class="k">END FUNCTION </span><span class="n">Unidirectional</span>
<a name="ln-2465"></a>  <span class="k">FUNCTION </span><span class="n">LinearBlend</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<a name="ln-2466"></a>
<a name="ln-2467"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2468"></a><span class="k">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span>
<a name="ln-2469"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">weights</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2470"></a>
<a name="ln-2471"></a>    <span class="n">weights</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5_prec</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0_prec</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
<a name="ln-2472"></a>    <span class="n">weights</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5_prec</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0_prec</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span>
<a name="ln-2473"></a>
<a name="ln-2474"></a>  <span class="k">END FUNCTION </span><span class="n">LinearBlend</span>
<a name="ln-2475"></a>
<a name="ln-2476"></a>  <span class="k">SUBROUTINE </span><span class="n">Init_MPILayer</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">enableMPI</span><span class="p">)</span>
<a name="ln-2477"></a><span class="cp">#undef __FUNC__</span>
<a name="ln-2478"></a><span class="cp">#define __FUNC__ &quot;Init_MPILayer&quot;</span>
<a name="ln-2479"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2480"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">MPILayer</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2481"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">enableMPI</span>
<a name="ln-2482"></a>    <span class="c">! Local</span>
<a name="ln-2483"></a>    <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">ierror</span>
<a name="ln-2484"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="kd">::</span> <span class="n">msg</span>
<a name="ln-2485"></a>
<a name="ln-2486"></a>    <span class="n">this</span> <span class="p">%</span> <span class="n">mpiComm</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2487"></a>    <span class="n">this</span> <span class="p">%</span> <span class="n">mpiPrec</span> <span class="o">=</span> <span class="n">prec</span>
<a name="ln-2488"></a>    <span class="n">this</span> <span class="p">%</span> <span class="n">rankId</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2489"></a>    <span class="n">this</span> <span class="p">%</span> <span class="n">nRanks</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2490"></a>    <span class="n">this</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2491"></a>    <span class="n">this</span> <span class="p">%</span> <span class="n">mpiEnabled</span> <span class="o">=</span> <span class="n">enableMPI</span>
<a name="ln-2492"></a>
<a name="ln-2493"></a>
<a name="ln-2494"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">enableMPI</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2495"></a><span class="k">      </span><span class="n">this</span> <span class="p">%</span> <span class="n">mpiComm</span> <span class="o">=</span> <span class="n">MPI_COMM_WORLD</span>
<a name="ln-2496"></a>      <span class="k">CALL </span><span class="n">MPI_INIT</span><span class="p">(</span><span class="n">ierror</span><span class="p">)</span>
<a name="ln-2497"></a>      <span class="k">CALL </span><span class="n">MPI_COMM_RANK</span><span class="p">(</span><span class="n">this</span> <span class="p">%</span> <span class="n">mpiComm</span><span class="p">,</span><span class="n">this</span> <span class="p">%</span> <span class="n">rankId</span><span class="p">,</span><span class="n">ierror</span><span class="p">)</span>
<a name="ln-2498"></a>      <span class="k">CALL </span><span class="n">MPI_COMM_SIZE</span><span class="p">(</span><span class="n">this</span> <span class="p">%</span> <span class="n">mpiComm</span><span class="p">,</span><span class="n">this</span> <span class="p">%</span> <span class="n">nRanks</span><span class="p">,</span><span class="n">ierror</span><span class="p">)</span>
<a name="ln-2499"></a>    <span class="k">END IF</span>
<a name="ln-2500"></a>
<a name="ln-2501"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">prec</span> <span class="o">==</span> <span class="n">real32</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2502"></a><span class="k">      </span><span class="n">this</span> <span class="p">%</span> <span class="n">mpiPrec</span> <span class="o">=</span> <span class="n">MPI_FLOAT</span>
<a name="ln-2503"></a>    <span class="k">ELSE</span>
<a name="ln-2504"></a><span class="k">      </span><span class="n">this</span> <span class="p">%</span> <span class="n">mpiPrec</span> <span class="o">=</span> <span class="n">MPI_DOUBLE</span>
<a name="ln-2505"></a>    <span class="k">END IF</span>
<a name="ln-2506"></a>
<a name="ln-2507"></a><span class="k">    CALL </span><span class="n">this</span> <span class="p">%</span> <span class="n">offSetElem</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">this</span> <span class="p">%</span> <span class="n">nRanks</span><span class="p">)</span>
<a name="ln-2508"></a>
<a name="ln-2509"></a>    <span class="k">WRITE</span> <span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="s1">&#39;(I5)&#39;</span><span class="p">)</span> <span class="n">this</span> <span class="p">%</span> <span class="n">rankId</span>
<a name="ln-2510"></a>    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Greetings from rank &quot;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;.&quot;</span>
<a name="ln-2511"></a>    <span class="n">INFO</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
<a name="ln-2512"></a>
<a name="ln-2513"></a>  <span class="k">END SUBROUTINE </span><span class="n">Init_MPILayer</span>
<a name="ln-2514"></a>
<a name="ln-2515"></a>  <span class="k">SUBROUTINE </span><span class="n">Free_MPILayer</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2516"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2517"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">MPILayer</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2518"></a>
<a name="ln-2519"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ASSOCIATED</span><span class="p">(</span><span class="n">this</span> <span class="p">%</span> <span class="n">offSetElem</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2520"></a><span class="k">      CALL </span><span class="n">this</span> <span class="p">%</span> <span class="n">offSetElem</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-2521"></a>    <span class="n">ENDIF</span>
<a name="ln-2522"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ASSOCIATED</span><span class="p">(</span><span class="n">this</span> <span class="p">%</span> <span class="n">elemToRank</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2523"></a><span class="k">      CALL </span><span class="n">this</span> <span class="p">%</span> <span class="n">elemToRank</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-2524"></a>    <span class="n">ENDIF</span>
<a name="ln-2525"></a>
<a name="ln-2526"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span> <span class="n">this</span> <span class="p">%</span> <span class="n">requests</span> <span class="p">)</span>
<a name="ln-2527"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span> <span class="n">this</span> <span class="p">%</span> <span class="n">stats</span> <span class="p">)</span>
<a name="ln-2528"></a>
<a name="ln-2529"></a>  <span class="k">END SUBROUTINE </span><span class="n">Free_MPILayer</span>
<a name="ln-2530"></a>
<a name="ln-2531"></a>  <span class="k">SUBROUTINE </span><span class="n">Finalize_MPILayer</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2532"></a><span class="cp">#undef __FUNC__</span>
<a name="ln-2533"></a><span class="cp">#define __FUNC__ &quot;Finalize_MPILayer&quot;</span>
<a name="ln-2534"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2535"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">MPILayer</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2536"></a>    <span class="c">! Local</span>
<a name="ln-2537"></a>    <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">ierror</span>
<a name="ln-2538"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="kd">::</span> <span class="n">msg</span>
<a name="ln-2539"></a>
<a name="ln-2540"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">this</span> <span class="p">%</span> <span class="n">mpiEnabled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2541"></a><span class="k">      WRITE</span> <span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="s1">&#39;(I5)&#39;</span><span class="p">)</span> <span class="n">this</span> <span class="p">%</span> <span class="n">rankId</span>
<a name="ln-2542"></a>      <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Goodbye from rank &quot;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;.&quot;</span>
<a name="ln-2543"></a>      <span class="n">INFO</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
<a name="ln-2544"></a>      <span class="k">CALL </span><span class="n">MPI_FINALIZE</span><span class="p">(</span><span class="n">ierror</span><span class="p">)</span>
<a name="ln-2545"></a>    <span class="n">ENDIF</span>
<a name="ln-2546"></a>
<a name="ln-2547"></a>  <span class="k">END SUBROUTINE </span><span class="n">Finalize_MPILayer</span>
<a name="ln-2548"></a>
<a name="ln-2549"></a>  <span class="k">SUBROUTINE </span><span class="n">GenerateDecomposition_MPILayer</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">mesh</span><span class="p">,</span><span class="n">maxMsg</span><span class="p">)</span>
<a name="ln-2550"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2551"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">MPILayer</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2552"></a>    <span class="k">CLASS</span><span class="p">(</span><span class="n">SEMMesh</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mesh</span>
<a name="ln-2553"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">OPTIONAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">maxMsg</span>
<a name="ln-2554"></a>    <span class="c">! Local</span>
<a name="ln-2555"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">maxMsgLoc</span>
<a name="ln-2556"></a>
<a name="ln-2557"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">maxMsg</span><span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-2558"></a><span class="k">      </span><span class="n">maxMsgLoc</span> <span class="o">=</span> <span class="n">maxMsg</span>
<a name="ln-2559"></a>    <span class="k">ELSE</span>
<a name="ln-2560"></a><span class="k">      </span><span class="n">maxMsgLoc</span> <span class="o">=</span> <span class="n">mesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span>
<a name="ln-2561"></a>    <span class="n">ENDIF</span>
<a name="ln-2562"></a>
<a name="ln-2563"></a>    <span class="k">CALL </span><span class="n">this</span> <span class="p">%</span> <span class="n">setElemToRank</span><span class="p">(</span><span class="n">mesh</span> <span class="p">%</span> <span class="n">nGlobalElem</span><span class="p">)</span>
<a name="ln-2564"></a>    <span class="k">CALL </span><span class="n">this</span> <span class="p">%</span> <span class="n">SetMaxMsg</span><span class="p">(</span><span class="n">maxMsgLoc</span><span class="p">)</span>
<a name="ln-2565"></a>
<a name="ln-2566"></a>  <span class="k">END SUBROUTINE </span><span class="n">GenerateDecomposition_MPILayer</span>
<a name="ln-2567"></a>
<a name="ln-2568"></a>  <span class="k">SUBROUTINE </span><span class="n">SetMaxMsg</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">maxMsg</span><span class="p">)</span>
<a name="ln-2569"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2570"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">MPILayer</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2571"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">maxMsg</span>
<a name="ln-2572"></a>
<a name="ln-2573"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">this</span> <span class="p">%</span> <span class="n">requests</span><span class="p">)</span> <span class="p">)</span> <span class="k">DEALLOCATE</span><span class="p">(</span> <span class="n">this</span> <span class="p">%</span> <span class="n">requests</span> <span class="p">)</span>
<a name="ln-2574"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">this</span> <span class="p">%</span> <span class="n">stats</span><span class="p">)</span> <span class="p">)</span> <span class="k">DEALLOCATE</span><span class="p">(</span> <span class="n">this</span> <span class="p">%</span> <span class="n">stats</span> <span class="p">)</span>
<a name="ln-2575"></a>
<a name="ln-2576"></a>    <span class="k">ALLOCATE</span><span class="p">(</span> <span class="n">this</span> <span class="p">%</span> <span class="n">requests</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">maxMsg</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2577"></a>    <span class="k">ALLOCATE</span><span class="p">(</span> <span class="n">this</span> <span class="p">%</span> <span class="n">stats</span><span class="p">(</span><span class="n">MPI_STATUS_SIZE</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">maxMsg</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2578"></a>    <span class="n">this</span> <span class="p">%</span> <span class="n">maxMsg</span> <span class="o">=</span> <span class="n">maxMsg</span>
<a name="ln-2579"></a>
<a name="ln-2580"></a>  <span class="k">END SUBROUTINE </span><span class="n">SetMaxMsg</span>
<a name="ln-2581"></a>
<a name="ln-2582"></a>  <span class="k">SUBROUTINE </span><span class="n">SetElemToRank</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">nElem</span><span class="p">)</span>
<a name="ln-2583"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2584"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">MPILayer</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2585"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-2586"></a>    <span class="c">! Local</span>
<a name="ln-2587"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iel</span>
<a name="ln-2588"></a>
<a name="ln-2589"></a>    <span class="n">this</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-2590"></a>
<a name="ln-2591"></a>    <span class="k">CALL </span><span class="n">this</span> <span class="p">%</span> <span class="n">elemToRank</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">)</span>
<a name="ln-2592"></a>
<a name="ln-2593"></a>    <span class="k">CALL </span><span class="n">DomainDecomp</span><span class="p">(</span><span class="n">nElem</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2594"></a>                      <span class="n">this</span> <span class="p">%</span> <span class="n">nRanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2595"></a>                      <span class="n">this</span> <span class="p">%</span> <span class="n">offSetElem</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">)</span>
<a name="ln-2596"></a>
<a name="ln-2597"></a>    <span class="k">DO </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span>
<a name="ln-2598"></a>      <span class="k">CALL </span><span class="n">ElemToRank</span><span class="p">(</span><span class="n">this</span> <span class="p">%</span> <span class="n">nRanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2599"></a>                      <span class="n">this</span> <span class="p">%</span> <span class="n">offSetElem</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2600"></a>                      <span class="n">iel</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2601"></a>                      <span class="n">this</span> <span class="p">%</span> <span class="n">elemToRank</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">iel</span><span class="p">))</span>
<a name="ln-2602"></a>    <span class="k">END DO</span>
<a name="ln-2603"></a>
<a name="ln-2604"></a><span class="k">    CALL </span><span class="n">this</span> <span class="p">%</span> <span class="n">offSetElem</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-2605"></a>    <span class="k">CALL </span><span class="n">this</span> <span class="p">%</span> <span class="n">elemToRank</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-2606"></a>
<a name="ln-2607"></a>  <span class="k">END SUBROUTINE </span><span class="n">SetElemToRank</span>
<a name="ln-2608"></a>
<a name="ln-2609"></a>  <span class="k">SUBROUTINE </span><span class="n">DomainDecomp</span><span class="p">(</span><span class="n">nElems</span><span class="p">,</span><span class="n">nDomains</span><span class="p">,</span><span class="n">offSetElem</span><span class="p">)</span>
<a name="ln-2610"></a>    <span class="c">! From https://www.hopr-project.org/externals/Meshformat.pdf, Algorithm 4</span>
<a name="ln-2611"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2612"></a><span class="k">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElems</span>
<a name="ln-2613"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nDomains</span>
<a name="ln-2614"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">offsetElem</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nDomains</span><span class="p">)</span>
<a name="ln-2615"></a>    <span class="c">! Local</span>
<a name="ln-2616"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nLocalElems</span>
<a name="ln-2617"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">remainElems</span>
<a name="ln-2618"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iDom</span>
<a name="ln-2619"></a>
<a name="ln-2620"></a>    <span class="n">nLocalElems</span> <span class="o">=</span> <span class="n">nElems</span><span class="o">/</span><span class="n">nDomains</span>
<a name="ln-2621"></a>    <span class="n">remainElems</span> <span class="o">=</span> <span class="n">nElems</span> <span class="o">-</span> <span class="n">nLocalElems</span><span class="o">*</span><span class="n">nDomains</span>
<a name="ln-2622"></a>    <span class="k">DO </span><span class="n">iDom</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nDomains</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-2623"></a>      <span class="n">offSetElem</span><span class="p">(</span><span class="n">iDom</span><span class="p">)</span> <span class="o">=</span> <span class="n">iDom</span><span class="o">*</span><span class="n">nLocalElems</span> <span class="o">+</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">iDom</span><span class="p">,</span><span class="n">remainElems</span><span class="p">)</span>
<a name="ln-2624"></a>    <span class="k">END DO</span>
<a name="ln-2625"></a><span class="k">    </span><span class="n">offSetElem</span><span class="p">(</span><span class="n">nDomains</span><span class="p">)</span> <span class="o">=</span> <span class="n">nElems</span>
<a name="ln-2626"></a>
<a name="ln-2627"></a>  <span class="k">END SUBROUTINE </span><span class="n">DomainDecomp</span>
<a name="ln-2628"></a>
<a name="ln-2629"></a>  <span class="k">SUBROUTINE </span><span class="n">ElemToRank</span><span class="p">(</span><span class="n">nDomains</span><span class="p">,</span><span class="n">offsetElem</span><span class="p">,</span><span class="n">elemID</span><span class="p">,</span><span class="n">domain</span><span class="p">)</span>
<a name="ln-2630"></a>    <span class="c">! From https://www.hopr-project.org/externals/Meshformat.pdf, Algorithm 7</span>
<a name="ln-2631"></a>    <span class="c">!   &quot;Find domain containing element index&quot;</span>
<a name="ln-2632"></a>    <span class="c">!</span>
<a name="ln-2633"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2634"></a><span class="k">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nDomains</span>
<a name="ln-2635"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">offsetElem</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nDomains</span><span class="p">)</span>
<a name="ln-2636"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">elemID</span>
<a name="ln-2637"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">domain</span>
<a name="ln-2638"></a>    <span class="c">! Local</span>
<a name="ln-2639"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">maxSteps</span>
<a name="ln-2640"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">low</span><span class="p">,</span><span class="n">up</span><span class="p">,</span><span class="n">mid</span>
<a name="ln-2641"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-2642"></a>
<a name="ln-2643"></a>    <span class="n">domain</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2644"></a>    <span class="n">maxSteps</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">LOG10</span><span class="p">(</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nDomains</span><span class="p">))</span><span class="o">/</span><span class="n">LOG10</span><span class="p">(</span><span class="mf">2.0</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2645"></a>    <span class="n">low</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2646"></a>    <span class="n">up</span> <span class="o">=</span> <span class="n">nDomains</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-2647"></a>
<a name="ln-2648"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">offsetElem</span><span class="p">(</span><span class="n">low</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">elemID</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">elemID</span> <span class="o">&lt;=</span> <span class="n">offsetElem</span><span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2649"></a><span class="k">      </span><span class="n">domain</span> <span class="o">=</span> <span class="n">low</span>
<a name="ln-2650"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">offsetElem</span><span class="p">(</span><span class="n">up</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">elemID</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">elemID</span> <span class="o">&lt;=</span> <span class="n">offsetElem</span><span class="p">(</span><span class="n">up</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2651"></a><span class="k">      </span><span class="n">domain</span> <span class="o">=</span> <span class="n">up</span>
<a name="ln-2652"></a>    <span class="k">ELSE</span>
<a name="ln-2653"></a><span class="k">      DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">maxSteps</span>
<a name="ln-2654"></a>        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">up</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">low</span>
<a name="ln-2655"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">offsetElem</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">elemID</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">elemID</span> <span class="o">&lt;=</span> <span class="n">offsetElem</span><span class="p">(</span><span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2656"></a><span class="k">          </span><span class="n">domain</span> <span class="o">=</span> <span class="n">mid</span>
<a name="ln-2657"></a>          <span class="k">RETURN</span>
<a name="ln-2658"></a><span class="k">        </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">elemID</span> <span class="o">&gt;</span> <span class="n">offsetElem</span><span class="p">(</span><span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2659"></a><span class="k">          </span><span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2660"></a>        <span class="k">ELSE</span>
<a name="ln-2661"></a><span class="k">          </span><span class="n">up</span> <span class="o">=</span> <span class="n">mid</span>
<a name="ln-2662"></a>        <span class="k">END IF</span>
<a name="ln-2663"></a><span class="k">      END DO</span>
<a name="ln-2664"></a><span class="k">    END IF</span>
<a name="ln-2665"></a>
<a name="ln-2666"></a><span class="k">  END SUBROUTINE </span><span class="n">ElemToRank</span>
<a name="ln-2667"></a>
<a name="ln-2668"></a>  <span class="k">SUBROUTINE </span><span class="n">FinalizeMPIExchangeAsync</span><span class="p">(</span><span class="n">mpiHandler</span><span class="p">)</span>
<a name="ln-2669"></a>    <span class="k">CLASS</span><span class="p">(</span><span class="n">MPILayer</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mpiHandler</span>
<a name="ln-2670"></a>    <span class="c">! Local</span>
<a name="ln-2671"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ierror</span>
<a name="ln-2672"></a>
<a name="ln-2673"></a>    <span class="k">CALL </span><span class="n">MPI_WaitAll</span><span class="p">(</span><span class="n">mpiHandler</span> <span class="p">%</span> <span class="n">msgCount</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2674"></a>                     <span class="n">mpiHandler</span> <span class="p">%</span> <span class="n">requests</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">mpiHandler</span> <span class="p">%</span> <span class="n">msgCount</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2675"></a>                     <span class="n">mpiHandler</span> <span class="p">%</span> <span class="n">stats</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MPI_STATUS_SIZE</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">mpiHandler</span> <span class="p">%</span> <span class="n">msgCount</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2676"></a>                     <span class="n">iError</span><span class="p">)</span>
<a name="ln-2677"></a>
<a name="ln-2678"></a>  <span class="k">END SUBROUTINE </span><span class="n">FinalizeMPIExchangeAsync</span>
<a name="ln-2679"></a>
<a name="ln-2680"></a><span class="k">END MODULE </span><span class="n">SELF_Mesh</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>SELF was developed by Joe Schoonover<br>&copy; 2022 Anti-Capitalist Software License
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
             on 2022-02-16 21:12  
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>