<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="SELF -- Spectral Element Libraries in Fortran. Fortran classes for implementing spectral element methods on CPU and GPU hardware.">
    
    <meta name="author" content="Joe Schoonover" >
    <link rel="icon" href="../favicon.png">

    <title>SELF_Mesh.f90 &ndash; SELF</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SELF </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/self.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/self.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>SELF_Mesh.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 5.8% of total for source files.">495 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/SELF_Mesh.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">SELF_Mesh.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/self_mesh.html">SELF_Mesh</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/self_mesh.f90.html#src">SELF_Mesh.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.30.1 (20201013.1554)
 -->
<!-- Title: sourcefile~~self_mesh.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileself_meshf90EfferentGraph" width="641pt" height="178pt"
 viewBox="0.00 0.00 641.00 178.22" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~self_mesh.f90~~EfferentGraph" class="graph" transform="scale(0.892758 0.892758) rotate(0) translate(4 195.626)">
<title>sourcefile~~self_mesh.f90~~EfferentGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-195.626 715,-195.626 715,5 -4,5"/>
<!-- sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node1" class="node"><title>sourcefile~self_mesh.f90</title>
<polygon fill="none" stroke="black" points="709.5,-65.9209 618.5,-65.9209 618.5,-41.9209 709.5,-41.9209 709.5,-65.9209"/>
<text text-anchor="middle" x="664" y="-51.5209" font-family="Helvetica,sans-Serif" font-size="10.50">SELF_Mesh.f90</text>
</g>
<!-- sourcefile~self_data.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node3" class="node"><title>sourcefile~self_data.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/self_data.f90.html" xlink:title="SELF_Data.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="581.5,-86.9209 492.5,-86.9209 492.5,-62.9209 581.5,-62.9209 581.5,-86.9209"/>
<text text-anchor="middle" x="537" y="-72.5209" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Data.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_data.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge1" class="edge"><title>sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M618.225,-61.443C609.572,-62.8967 600.426,-64.4333 591.527,-65.9284"/>
<polygon fill="#ff0000" stroke="#ff0000" points="590.906,-62.4835 581.624,-67.592 592.066,-69.3867 590.906,-62.4835"/>
</g>
<!-- sourcefile~self_supportroutines.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node5" class="node"><title>sourcefile~self_supportroutines.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/self_supportroutines.f90.html" xlink:title="SELF_SupportRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="303.5,-45.9209 152.5,-45.9209 152.5,-21.9209 303.5,-21.9209 303.5,-45.9209"/>
<text text-anchor="middle" x="228" y="-31.5209" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_SupportRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_supportroutines.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge2" class="edge"><title>sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_supportroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397,-33.9209C370.02,-32.3392 340.561,-31.9026 313.952,-31.9893"/>
<polygon fill="#ff0000" stroke="#ff0000" points="313.884,-28.4895 303.904,-32.0468 313.924,-35.4894 313.884,-28.4895"/>
</g>
<!-- sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node4" class="node"><title>sourcefile~self_constants.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/self_constants.f90.html" xlink:title="SELF_Constants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="116,-107.921 0,-107.921 0,-83.9209 116,-83.9209 116,-107.921"/>
<text text-anchor="middle" x="58" y="-93.5209" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Constants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge3" class="edge"><title>sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M618.438,-43.384C594.701,-38.6376 564.922,-34.0524 538,-33.9209"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M536,-33.9209C475.112,-33.6234 459.785,-37.4841 399,-33.9209"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397,-33.9209C354.699,-31.4411 346.113,-17.6164 304,-12.9209 236.86,-5.43483 215.122,11.1502 152,-12.9209 119.091,-25.4705 90.4377,-55.6094 73.9298,-75.9009"/>
<polygon fill="#ff0000" stroke="#ff0000" points="71.0569,-73.892 67.6215,-83.9144 76.5571,-78.2218 71.0569,-73.892"/>
</g>
<!-- sourcefile~self_lagrange.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node2" class="node"><title>sourcefile~self_lagrange.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/self_lagrange.f90.html" xlink:title="SELF_Lagrange.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="455.5,-86.9209 340.5,-86.9209 340.5,-62.9209 455.5,-62.9209 455.5,-86.9209"/>
<text text-anchor="middle" x="398" y="-72.5209" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Lagrange.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_lagrange.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge4" class="edge"><title>sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_lagrange.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M536,-33.9209C499.738,-33.7437 460.256,-47.1156 433.034,-58.6333"/>
<polygon fill="#ff0000" stroke="#ff0000" points="431.348,-55.5505 423.588,-62.7642 434.153,-61.9641 431.348,-55.5505"/>
</g>
<!-- sourcefile~self_memory.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node6" class="node"><title>sourcefile~self_memory.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/self_memory.f90.html" xlink:title="SELF_Memory.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281,-167.921 175,-167.921 175,-143.921 281,-143.921 281,-167.921"/>
<text text-anchor="middle" x="228" y="-153.521" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Memory.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_memory.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge5" class="edge"><title>sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_memory.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M379.063,-87.0002C360.752,-98.9734 331.232,-117.303 304,-129.921 295.824,-133.709 286.931,-137.259 278.221,-140.444"/>
<polygon fill="#ff0000" stroke="#ff0000" points="276.773,-137.244 268.513,-143.879 279.108,-143.843 276.773,-137.244"/>
</g>
<!-- sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge6" class="edge"><title>sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M355.239,-86.9804C339.344,-90.9923 320.974,-94.9405 304,-96.9209 244.244,-103.893 175.731,-102.855 126.378,-100.531"/>
<polygon fill="#ff0000" stroke="#ff0000" points="126.31,-97.0231 116.148,-100.018 125.96,-104.014 126.31,-97.0231"/>
</g>
<!-- sourcefile~self_quadrature.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_node7" class="node"><title>sourcefile~self_quadrature.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/self_quadrature.f90.html" xlink:title="SELF_Quadrature.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="290.5,-87.9209 165.5,-87.9209 165.5,-63.9209 290.5,-63.9209 290.5,-87.9209"/>
<text text-anchor="middle" x="228" y="-73.5209" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Quadrature.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_quadrature.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge7" class="edge"><title>sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_quadrature.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M340.123,-75.2594C327.579,-75.3341 314.131,-75.4141 301.076,-75.4918"/>
<polygon fill="#ff0000" stroke="#ff0000" points="300.694,-71.994 290.715,-75.5535 300.735,-78.9938 300.694,-71.994"/>
</g>
<!-- sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_supportroutines.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge8" class="edge"><title>sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_supportroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M347.503,-62.8413C328.958,-58.3154 307.698,-53.1269 288.351,-48.4054"/>
<polygon fill="#ff0000" stroke="#ff0000" points="288.978,-44.9557 278.433,-45.9849 287.318,-51.7561 288.978,-44.9557"/>
</g>
<!-- sourcefile~self_data.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge9" class="edge"><title>sourcefile~self_data.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M516.166,-87.0608C477.23,-110.098 387.318,-159.414 304,-176.921 237.888,-190.812 215.266,-200.61 152,-176.921 119.541,-164.767 90.9469,-135.597 74.3079,-115.79"/>
<polygon fill="#7fff00" stroke="#7fff00" points="76.9576,-113.501 67.9324,-107.951 71.527,-117.918 76.9576,-113.501"/>
</g>
<!-- sourcefile~self_data.f90&#45;&gt;sourcefile~self_lagrange.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge10" class="edge"><title>sourcefile~self_data.f90&#45;&gt;sourcefile~self_lagrange.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M492.276,-74.9209C483.855,-74.9209 474.857,-74.9209 465.896,-74.9209"/>
<polygon fill="#7fff00" stroke="#7fff00" points="465.827,-71.421 455.827,-74.9209 465.827,-78.421 465.827,-71.421"/>
</g>
<!-- sourcefile~self_supportroutines.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge11" class="edge"><title>sourcefile~self_supportroutines.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M179.867,-46.0121C170.555,-48.7106 160.91,-51.7276 152,-54.9209 132.098,-62.0532 110.454,-71.4901 93.0585,-79.5121"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="91.4515,-76.3996 83.8692,-83.7996 94.4113,-82.7431 91.4515,-76.3996"/>
</g>
<!-- sourcefile~self_memory.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge12" class="edge"><title>sourcefile~self_memory.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M191.854,-143.873C179.266,-139.523 164.982,-134.544 152,-129.921 135.37,-123.999 117.118,-117.357 101.22,-111.526"/>
<polygon fill="#ff0000" stroke="#ff0000" points="102.255,-108.178 91.6618,-108.014 99.8409,-114.748 102.255,-108.178"/>
</g>
<!-- sourcefile~self_quadrature.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_mesh.f90~~EfferentGraph_edge13" class="edge"><title>sourcefile~self_quadrature.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M165.397,-83.2546C152.687,-84.7676 139.24,-86.3685 126.338,-87.9044"/>
<polygon fill="#00ffff" stroke="#00ffff" points="125.65,-84.4616 116.134,-89.1192 126.477,-91.4125 125.65,-84.4616"/>
</g>
</g>
</svg>
</div><script>var pansourcefileself_meshf90EfferentGraph = svgPanZoom('#sourcefileself_meshf90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.30.1 (20201013.1554)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="201pt" height="32pt"
 viewBox="0.00 0.00 201.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-28 198,-28 198,5 -4,5"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="70.25,-24 -0.25,-24 -0.25,-0 70.25,-0 70.25,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="193,-24 89,-24 89,-0 193,-0 193,-24"/>
<text text-anchor="middle" x="141" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.30.1 (20201013.1554)
 -->
<!-- Title: sourcefile~~self_mesh.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileself_meshf90AfferentGraph" width="641pt" height="91pt"
 viewBox="0.00 0.00 641.00 91.31" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~self_mesh.f90~~AfferentGraph" class="graph" transform="scale(0.968278 0.968278) rotate(0) translate(4 90.2997)">
<title>sourcefile~~self_mesh.f90~~AfferentGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-90.2997 659,-90.2997 659,5 -4,5"/>
<!-- sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_node1" class="node"><title>sourcefile~self_mesh.f90</title>
<polygon fill="none" stroke="black" points="91.5,-55 0.5,-55 0.5,-31 91.5,-31 91.5,-55"/>
<text text-anchor="middle" x="46" y="-40.6" font-family="Helvetica,sans-Serif" font-size="10.50">SELF_Mesh.f90</text>
</g>
<!-- sourcefile~self_tests.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_node2" class="node"><title>sourcefile~self_tests.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/self_tests.f90.html" xlink:title="SELF_Tests.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="549,-24 459,-24 459,-0 549,-0 549,-24"/>
<text text-anchor="middle" x="504" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Tests.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_tests.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge1" class="edge"><title>sourcefile~self_tests.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M458.855,-9.95517C388.471,-7.41667 246.659,-5.25811 128,-22 117.535,-23.4765 106.476,-25.8098 96.0068,-28.3936"/>
<polygon fill="#ff0000" stroke="#ff0000" points="94.996,-25.0397 86.188,-30.9278 96.7454,-31.8176 94.996,-25.0397"/>
</g>
<!-- sourcefile~self_mappeddata.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_node5" class="node"><title>sourcefile~self_mappeddata.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/self_mappeddata.f90.html" xlink:title="SELF_MappedData.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="412,-55 280,-55 280,-31 412,-31 412,-55"/>
<text text-anchor="middle" x="346" y="-40.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_MappedData.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_tests.f90&#45;&gt;sourcefile~self_mappeddata.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge7" class="edge"><title>sourcefile~self_tests.f90&#45;&gt;sourcefile~self_mappeddata.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M458.714,-20.8004C445.884,-23.35 431.547,-26.199 417.535,-28.9835"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="416.541,-25.6125 407.415,-30.9945 417.905,-32.4782 416.541,-25.6125"/>
</g>
<!-- sourcefile~self_geometry.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_node3" class="node"><title>sourcefile~self_geometry.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/self_geometry.f90.html" xlink:title="SELF_Geometry.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="243.5,-55 128.5,-55 128.5,-31 243.5,-31 243.5,-55"/>
<text text-anchor="middle" x="186" y="-40.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Geometry.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_geometry.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge2" class="edge"><title>sourcefile~self_geometry.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M128.472,-43C119.698,-43 110.646,-43 101.908,-43"/>
<polygon fill="#ff0000" stroke="#ff0000" points="101.831,-39.5001 91.8315,-43 101.831,-46.5001 101.831,-39.5001"/>
</g>
<!-- sourcefile~self_mpilayer.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_node4" class="node"><title>sourcefile~self_mpilayer.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/self_mpilayer.f90.html" xlink:title="SELF_MPILayer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="559.5,-85 448.5,-85 448.5,-61 559.5,-61 559.5,-85"/>
<text text-anchor="middle" x="504" y="-70.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_MPILayer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_mpilayer.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge3" class="edge"><title>sourcefile~self_mpilayer.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.398,-78.3175C385.34,-83.6263 278.529,-90.0592 187,-83"/>
</g>
<!-- sourcefile~self_mpilayer.f90&#45;&gt;sourcefile~self_mappeddata.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge8" class="edge"><title>sourcefile~self_mpilayer.f90&#45;&gt;sourcefile~self_mappeddata.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M448.439,-62.5075C439.114,-60.7142 429.296,-58.8261 419.59,-56.9596"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="420.023,-53.4788 409.542,-55.0273 418.701,-60.3528 420.023,-53.4788"/>
</g>
<!-- sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge4" class="edge"><title>sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M308.829,-55.025C269.899,-67.451 210.416,-84.806 187,-83"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M185,-83C150.335,-80.3264 112.508,-68.7066 85.2397,-58.6748"/>
<polygon fill="#ff0000" stroke="#ff0000" points="86.288,-55.3295 75.6963,-55.0702 83.8146,-61.8779 86.288,-55.3295"/>
</g>
<!-- sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_geometry.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge6" class="edge"><title>sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_geometry.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M279.823,-43C271.362,-43 262.683,-43 254.191,-43"/>
<polygon fill="#7fff00" stroke="#7fff00" points="253.951,-39.5001 243.951,-43 253.951,-46.5001 253.951,-39.5001"/>
</g>
<!-- sourcefile~self.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_node6" class="node"><title>sourcefile~self.f90</title>
<g id="a_sourcefile~~self_mesh.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/self.f90.html" xlink:title="SELF.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="653.5,-24 596.5,-24 596.5,-0 653.5,-0 653.5,-24"/>
<text text-anchor="middle" x="625" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self.f90&#45;&gt;sourcefile~self_tests.f90 -->
<g id="sourcefile~~self_mesh.f90~~AfferentGraph_edge5" class="edge"><title>sourcefile~self.f90&#45;&gt;sourcefile~self_tests.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M596.4,-12C585.348,-12 572.211,-12 559.393,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="559.227,-8.5001 549.227,-12 559.227,-15.5001 559.227,-8.5001"/>
</g>
</g>
</svg>
</div><script>var pansourcefileself_meshf90AfferentGraph = svgPanZoom('#sourcefileself_meshf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.30.1 (20201013.1554)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="201pt" height="32pt"
 viewBox="0.00 0.00 201.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-28 198,-28 198,5 -4,5"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="70.25,-24 -0.25,-24 -0.25,-0 70.25,-0 70.25,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="193,-24 89,-24 89,-0 193,-0 193,-24"/>
<text text-anchor="middle" x="141" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/self_mesh.html">SELF_Mesh</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/self_mesh.f90.html#src">SELF_Mesh.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">SELF_Mesh</span>
<a name="ln-2"></a>
<a name="ln-3"></a>  <span class="k">USE </span><span class="n">SELF_Constants</span>
<a name="ln-4"></a>  <span class="k">USE </span><span class="n">SELF_Lagrange</span>
<a name="ln-5"></a>  <span class="k">USE </span><span class="n">SELF_Data</span>
<a name="ln-6"></a>  <span class="k">USE </span><span class="n">SELF_SupportRoutines</span>
<a name="ln-7"></a>
<a name="ln-8"></a>  <span class="k">USE </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9"></a>
<a name="ln-10"></a><span class="nb">  </span><span class="k">IMPLICIT NONE</span>
<a name="ln-11"></a>
<a name="ln-12"></a><span class="cp">#include &quot;SELF_Macros.h&quot;</span>
<a name="ln-13"></a><span class="c">! ========================================================================= !</span>
<a name="ln-14"></a><span class="c">! Node, Edge, Face, Element and Connectivity Standard</span>
<a name="ln-15"></a><span class="c">! ========================================================================= !</span>
<a name="ln-16"></a><span class="c">!</span>
<a name="ln-17"></a><span class="c">! To define the element corner nodes, the side order and side connectivity,</span>
<a name="ln-18"></a><span class="c">! we follow the standard from CGNS SIDS (CFD General Notation System,</span>
<a name="ln-19"></a><span class="c">! Standard Interface Data Structures, http: //cgns.sourceforge.net/ ).</span>
<a name="ln-20"></a><span class="c">!</span>
<a name="ln-21"></a><span class="c">! Computational coordinate directions are defined as follows</span>
<a name="ln-22"></a><span class="c">!</span>
<a name="ln-23"></a><span class="c">! xi1 direction points from &quot;West&quot; (xi1=-1) to &quot;East&quot; (xi1=1)</span>
<a name="ln-24"></a><span class="c">! xi2 direction points from &quot;South&quot; (xi2=-1) to &quot;North&quot; (xi2=1)</span>
<a name="ln-25"></a><span class="c">! xi3 direction points from &quot;Bottom&quot; (xi3=-1) to &quot;Top&quot; (xi3=1)</span>
<a name="ln-26"></a><span class="c">!</span>
<a name="ln-27"></a><span class="c">! 2-D Hexahedreal Element sides are defined as</span>
<a name="ln-28"></a><span class="c">!</span>
<a name="ln-29"></a><span class="c">! Side 1 = South  (xi2 = -1) = [CN1, CN2]</span>
<a name="ln-30"></a><span class="c">! Side 2 = East   (xi1 = 1) = [CN2, CN3]</span>
<a name="ln-31"></a><span class="c">! Side 3 = North  (xi2 = 1) = [CN4, CN3]</span>
<a name="ln-32"></a><span class="c">! Side 4 = West   (xi1 = -1) = [CN1, CN4]</span>
<a name="ln-33"></a><span class="c">!</span>
<a name="ln-34"></a><span class="c">! 3-D Hexahedreal Element sides are defined as</span>
<a name="ln-35"></a><span class="c">!</span>
<a name="ln-36"></a><span class="c">! Side 1 = Bottom (xi3 = -1) = [CN1, CN4, CN3, CN2]</span>
<a name="ln-37"></a><span class="c">! Side 2 = South  (xi2 = -1) = [CN1, CN2, CN6, CN5]</span>
<a name="ln-38"></a><span class="c">! Side 3 = East   (xi1 = 1) = [CN2, CN3, CN7, CN6]</span>
<a name="ln-39"></a><span class="c">! Side 4 = North  (xi2 = 1) = [CN3, CN4, CN8, CN7]</span>
<a name="ln-40"></a><span class="c">! Side 5 = West   (xi1 = -1) = [CN1, CN5, CN8, CN4]</span>
<a name="ln-41"></a><span class="c">! Side 6 = Top    (xi3 = 1) = [CN5, CN6, CN7, CN8]</span>
<a name="ln-42"></a><span class="c">!</span>
<a name="ln-43"></a><span class="c">! In 2-D, corner nodes are order counter-clockwise (looking in the -xi3 direction).</span>
<a name="ln-44"></a><span class="c">!</span>
<a name="ln-45"></a><span class="c">! CornerNode 1 = South-West = (-1,-1)</span>
<a name="ln-46"></a><span class="c">! CornerNode 2 = South-East = ( 1,-1)</span>
<a name="ln-47"></a><span class="c">! CornerNode 3 = North-East = ( 1, 1)</span>
<a name="ln-48"></a><span class="c">! CornerNode 4 = North-West = (-1, 1)</span>
<a name="ln-49"></a><span class="c">!</span>
<a name="ln-50"></a><span class="c">! In 3-D, corner nodes are order counter-clockwise (looking in the -xi3 direction) from</span>
<a name="ln-51"></a><span class="c">! bottom to top.</span>
<a name="ln-52"></a><span class="c">!</span>
<a name="ln-53"></a><span class="c">! CornerNode 1 = Bottom-South-West = (-1,-1,-1)</span>
<a name="ln-54"></a><span class="c">! CornerNode 2 = Bottom-South-East = ( 1,-1,-1)</span>
<a name="ln-55"></a><span class="c">! CornerNode 3 = Bottom-North-East = ( 1, 1,-1)</span>
<a name="ln-56"></a><span class="c">! CornerNode 4 = Bottom-North-West = (-1, 1,-1)</span>
<a name="ln-57"></a><span class="c">! CornerNode 5 = Top-South-West = (-1,-1, 1)</span>
<a name="ln-58"></a><span class="c">! CornerNode 6 = Top-South-East = ( 1,-1, 1)</span>
<a name="ln-59"></a><span class="c">! CornerNode 7 = Top-North-East = ( 1, 1, 1)</span>
<a name="ln-60"></a><span class="c">! CornerNode 8 = Top-North-West = (-1, 1, 1)</span>
<a name="ln-61"></a><span class="c">!</span>
<a name="ln-62"></a><span class="c">!</span>
<a name="ln-63"></a><span class="c">! Notes:</span>
<a name="ln-64"></a><span class="c">!  * cornerNode attributes have not been implemented yet</span>
<a name="ln-65"></a><span class="c">!</span>
<a name="ln-66"></a><span class="c">!  * For line segments, quads, and hexes, Gauss-Lobatto quadrature is required</span>
<a name="ln-67"></a><span class="c">!</span>
<a name="ln-68"></a><span class="c">! ========================================================================= !</span>
<a name="ln-69"></a>
<a name="ln-70"></a>  <span class="c">! Element Types - From Table 4.1 of https://www.hopr-project.org/externals/Meshformat.pdf</span>
<a name="ln-71"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfLineLinear</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-72"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfLineNonlinear</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-73"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfTriangleLinear</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-74"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfQuadLinear</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-75"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfQuadBilinear</span> <span class="o">=</span> <span class="mi">14</span>
<a name="ln-76"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfTriangleNonlinear</span> <span class="o">=</span> <span class="mi">23</span>
<a name="ln-77"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfQuadNonlinear</span> <span class="o">=</span> <span class="mi">24</span>
<a name="ln-78"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfTetrahedronLinear</span> <span class="o">=</span> <span class="mi">104</span>
<a name="ln-79"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfPyramidLinear</span> <span class="o">=</span> <span class="mi">105</span>
<a name="ln-80"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfPrismLinear</span> <span class="o">=</span> <span class="mi">106</span>
<a name="ln-81"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfHexahedronLinear</span> <span class="o">=</span> <span class="mi">108</span>
<a name="ln-82"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfPyramidBilinear</span> <span class="o">=</span> <span class="mi">115</span>
<a name="ln-83"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfPrismBilinear</span> <span class="o">=</span> <span class="mi">116</span>
<a name="ln-84"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfHexahedronBilinear</span> <span class="o">=</span> <span class="mi">118</span>
<a name="ln-85"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfTetrahedronNonlinear</span> <span class="o">=</span> <span class="mi">204</span>
<a name="ln-86"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfPyramidNonlinear</span> <span class="o">=</span> <span class="mi">205</span>
<a name="ln-87"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfPrismNonlinear</span> <span class="o">=</span> <span class="mi">206</span>
<a name="ln-88"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfHexahedronNonlinear</span> <span class="o">=</span> <span class="mi">208</span>
<a name="ln-89"></a>
<a name="ln-90"></a>  <span class="c">!</span>
<a name="ln-91"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfMinNodalValence2D</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-92"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfMinNodalValence3D</span> <span class="o">=</span> <span class="mi">8</span>
<a name="ln-93"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfMaxNodalValence2D</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-94"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfMaxNodalValence3D</span> <span class="o">=</span> <span class="mi">10</span>
<a name="ln-95"></a>  <span class="c">! Side Ordering</span>
<a name="ln-96"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide2D_South</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-97"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide2D_East</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-98"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide2D_North</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-99"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide2D_West</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-100"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide3D_Bottom</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-101"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide3D_South</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-102"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide3D_East</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-103"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide3D_North</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-104"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide3D_West</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-105"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfSide3D_Top</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-106"></a>
<a name="ln-107"></a>  <span class="k">TYPE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Mesh1D</span>
<a name="ln-108"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGeo</span>
<a name="ln-109"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-110"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nNodes</span>
<a name="ln-111"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nCornerNodes</span>
<a name="ln-112"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nUniqueNodes</span>
<a name="ln-113"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nBCs</span>
<a name="ln-114"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">elemInfo</span>
<a name="ln-115"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nodeCoords</span>
<a name="ln-116"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">globalNodeIDs</span>
<a name="ln-117"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BCType</span>
<a name="ln-118"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">255</span><span class="p">),</span><span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">BCNames</span><span class="p">(:)</span>
<a name="ln-119"></a>
<a name="ln-120"></a>  <span class="k">CONTAINS</span>
<a name="ln-121"></a><span class="k">    PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Init</span> <span class="o">=&gt;</span> <span class="n">Init_Mesh1D</span>
<a name="ln-122"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Free</span> <span class="o">=&gt;</span> <span class="n">Free_Mesh1D</span>
<a name="ln-123"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateHost</span> <span class="o">=&gt;</span> <span class="n">UpdateHost_Mesh1D</span>
<a name="ln-124"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateDevice</span> <span class="o">=&gt;</span> <span class="n">UpdateDevice_Mesh1D</span>
<a name="ln-125"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UniformBlockMesh</span> <span class="o">=&gt;</span> <span class="n">UniformBlockMesh_Mesh1D</span>
<a name="ln-126"></a>
<a name="ln-127"></a>  <span class="k">END TYPE </span><span class="n">Mesh1D</span>
<a name="ln-128"></a>
<a name="ln-129"></a>  <span class="c">! Mesh format is set up as the HOPr format</span>
<a name="ln-130"></a>  <span class="c">! See https://hopr-project.org/externals/MeshFormat.pdf</span>
<a name="ln-131"></a>
<a name="ln-132"></a>  <span class="k">TYPE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Mesh2D</span>
<a name="ln-133"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGeo</span>
<a name="ln-134"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-135"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nNodes</span>
<a name="ln-136"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nSides</span>
<a name="ln-137"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nCornerNodes</span>
<a name="ln-138"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nUniqueNodes</span>
<a name="ln-139"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nUniqueSides</span>
<a name="ln-140"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nBCs</span>
<a name="ln-141"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">elemInfo</span>
<a name="ln-142"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sideInfo</span>
<a name="ln-143"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nodeCoords</span>
<a name="ln-144"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">globalNodeIDs</span>
<a name="ln-145"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CGNSCornerMap</span>
<a name="ln-146"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CGNSSideMap</span>
<a name="ln-147"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">curveNodeMap</span>
<a name="ln-148"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">curveNodeMapInv</span>
<a name="ln-149"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BCType</span>
<a name="ln-150"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">255</span><span class="p">),</span><span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">BCNames</span><span class="p">(:)</span>
<a name="ln-151"></a>
<a name="ln-152"></a>  <span class="k">CONTAINS</span>
<a name="ln-153"></a><span class="k">    PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Init</span> <span class="o">=&gt;</span> <span class="n">Init_Mesh2D</span>
<a name="ln-154"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Free</span> <span class="o">=&gt;</span> <span class="n">Free_Mesh2D</span>
<a name="ln-155"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateHost</span> <span class="o">=&gt;</span> <span class="n">UpdateHost_Mesh2D</span>
<a name="ln-156"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateDevice</span> <span class="o">=&gt;</span> <span class="n">UpdateDevice_Mesh2D</span>
<a name="ln-157"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UniformBlockMesh</span> <span class="o">=&gt;</span> <span class="n">UniformBlockMesh_Mesh2D</span>
<a name="ln-158"></a>
<a name="ln-159"></a><span class="c">!    PROCEDURE, PUBLIC :: GenerateConnectivity =&gt; GenerateConnectivity_Mesh2D</span>
<a name="ln-160"></a>
<a name="ln-161"></a>  <span class="k">END TYPE </span><span class="n">Mesh2D</span>
<a name="ln-162"></a>
<a name="ln-163"></a>  <span class="k">TYPE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Mesh3D</span>
<a name="ln-164"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nGeo</span>
<a name="ln-165"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-166"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nNodes</span>
<a name="ln-167"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nSides</span>
<a name="ln-168"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nCornerNodes</span>
<a name="ln-169"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nUniqueNodes</span>
<a name="ln-170"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nUniqueSides</span>
<a name="ln-171"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nBCs</span>
<a name="ln-172"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">elemInfo</span>
<a name="ln-173"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sideInfo</span>
<a name="ln-174"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nodeCoords</span>
<a name="ln-175"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">globalNodeIDs</span>
<a name="ln-176"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CGNSCornerMap</span>
<a name="ln-177"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CGNSSideMap</span>
<a name="ln-178"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">curveNodeMap</span>
<a name="ln-179"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">curveNodeMapInv</span>
<a name="ln-180"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfInt32_r2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BCType</span>
<a name="ln-181"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">255</span><span class="p">),</span><span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">BCNames</span><span class="p">(:)</span>
<a name="ln-182"></a>
<a name="ln-183"></a>  <span class="k">CONTAINS</span>
<a name="ln-184"></a>
<a name="ln-185"></a><span class="k">    PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Init</span> <span class="o">=&gt;</span> <span class="n">Init_Mesh3D</span>
<a name="ln-186"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Free</span> <span class="o">=&gt;</span> <span class="n">Free_Mesh3D</span>
<a name="ln-187"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateHost</span> <span class="o">=&gt;</span> <span class="n">UpdateHost_Mesh3D</span>
<a name="ln-188"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateDevice</span> <span class="o">=&gt;</span> <span class="n">UpdateDevice_Mesh3D</span>
<a name="ln-189"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UniformBlockMesh</span> <span class="o">=&gt;</span> <span class="n">UniformBlockMesh_Mesh3D</span>
<a name="ln-190"></a>
<a name="ln-191"></a><span class="c">!      PROCEDURE, PUBLIC :: LoadHOPRMesh =&gt; LoadHOPRMesh_3D</span>
<a name="ln-192"></a><span class="c">!</span>
<a name="ln-193"></a><span class="c">!      PROCEDURE, PUBLIC :: Read_CGNSMesh</span>
<a name="ln-194"></a><span class="c">!      PROCEDURE, PUBLIC :: Read_UCDMesh</span>
<a name="ln-195"></a><span class="c">!      PROCEDURE, PUBLIC :: Read_TrellisUCDMesh</span>
<a name="ln-196"></a><span class="c">!</span>
<a name="ln-197"></a><span class="c">!    PROCEDURE, PUBLIC :: GenerateConnectivity =&gt; GenerateConnectivity_Mesh3D</span>
<a name="ln-198"></a>
<a name="ln-199"></a>  <span class="k">END TYPE </span><span class="n">Mesh3D</span>
<a name="ln-200"></a>
<a name="ln-201"></a><span class="k">CONTAINS</span>
<a name="ln-202"></a>
<a name="ln-203"></a><span class="k">  SUBROUTINE </span><span class="n">Init_Mesh1D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">nNodes</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-204"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-205"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-206"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nGeo</span>
<a name="ln-207"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-208"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nNodes</span>
<a name="ln-209"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nBCs</span>
<a name="ln-210"></a>
<a name="ln-211"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nGeo</span> <span class="o">=</span> <span class="n">nGeo</span>
<a name="ln-212"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-213"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nNodes</span> <span class="o">=</span> <span class="n">nNodes</span>
<a name="ln-214"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nCornerNodes</span> <span class="o">=</span> <span class="n">nElem</span><span class="o">*</span><span class="mi">2</span>
<a name="ln-215"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-216"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nBCs</span> <span class="o">=</span> <span class="n">nBCs</span>
<a name="ln-217"></a>
<a name="ln-218"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">elemInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-219"></a>                                   <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-220"></a>
<a name="ln-221"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nodeCoords</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-222"></a>                                     <span class="n">upBound</span><span class="o">=</span><span class="n">nNodes</span><span class="p">)</span>
<a name="ln-223"></a>
<a name="ln-224"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">globalNodeIDs</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-225"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="n">nNodes</span><span class="p">)</span>
<a name="ln-226"></a>
<a name="ln-227"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-228"></a>                                 <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">nBCs</span><span class="o">/</span><span class="p">))</span>
<a name="ln-229"></a>
<a name="ln-230"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCNames</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nBCs</span><span class="p">))</span>
<a name="ln-231"></a>
<a name="ln-232"></a>  <span class="k">END SUBROUTINE </span><span class="n">Init_Mesh1D</span>
<a name="ln-233"></a>
<a name="ln-234"></a>  <span class="k">SUBROUTINE </span><span class="n">Free_Mesh1D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-235"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-236"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-237"></a>
<a name="ln-238"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-239"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-240"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nCornerNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-241"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-242"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nBCs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-243"></a>
<a name="ln-244"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">elemInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-245"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nodeCoords</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-246"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">globalNodeIDs</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-247"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-248"></a>
<a name="ln-249"></a>    <span class="k">DEALLOCATE</span> <span class="p">(</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCNames</span><span class="p">)</span>
<a name="ln-250"></a>
<a name="ln-251"></a>  <span class="k">END SUBROUTINE </span><span class="n">Free_Mesh1D</span>
<a name="ln-252"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateHost_Mesh1D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-253"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-254"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-255"></a>
<a name="ln-256"></a><span class="cp">#ifdef GPU</span>
<a name="ln-257"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">elemInfo</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-258"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nodeCoords</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-259"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">globalNodeIDs</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-260"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-261"></a><span class="cp">#endif</span>
<a name="ln-262"></a>
<a name="ln-263"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateHost_Mesh1D</span>
<a name="ln-264"></a>
<a name="ln-265"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateDevice_Mesh1D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-266"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-267"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-268"></a>
<a name="ln-269"></a><span class="cp">#ifdef GPU</span>
<a name="ln-270"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">elemInfo</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-271"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nodeCoords</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-272"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">globalNodeIDs</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-273"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-274"></a><span class="cp">#endif</span>
<a name="ln-275"></a>
<a name="ln-276"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateDevice_Mesh1D</span>
<a name="ln-277"></a>
<a name="ln-278"></a>  <span class="k">SUBROUTINE </span><span class="n">UniformBlockMesh_Mesh1D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<a name="ln-279"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-280"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-281"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nGeo</span>
<a name="ln-282"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-283"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-284"></a>    <span class="c">! Local</span>
<a name="ln-285"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iel</span>
<a name="ln-286"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nid</span><span class="p">,</span><span class="n">nNodes</span>
<a name="ln-287"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-288"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nElem</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-289"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xLinear</span>
<a name="ln-290"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xGeo</span>
<a name="ln-291"></a>
<a name="ln-292"></a>    <span class="n">nNodes</span> <span class="o">=</span> <span class="n">nElem</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-293"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">nNodes</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-294"></a>
<a name="ln-295"></a>    <span class="c">! Set the nodeCoords</span>
<a name="ln-296"></a>    <span class="n">xU</span> <span class="o">=</span> <span class="n">UniformPoints</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">nElem</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-297"></a>
<a name="ln-298"></a>    <span class="c">! Create a linear interpolant to interpolate to nGeo grid</span>
<a name="ln-299"></a>    <span class="k">CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-300"></a>                        <span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-301"></a>                        <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">)</span>
<a name="ln-302"></a>
<a name="ln-303"></a>    <span class="k">CALL </span><span class="n">xGeo</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-304"></a>                     <span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-305"></a>                     <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">)</span>
<a name="ln-306"></a>    <span class="k">DO </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span>
<a name="ln-307"></a>      <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">xU</span><span class="p">(</span><span class="n">iel</span><span class="p">:</span><span class="n">iel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-308"></a>    <span class="k">END DO</span>
<a name="ln-309"></a>
<a name="ln-310"></a><span class="k">    CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">GridInterp</span><span class="p">(</span><span class="n">xGeo</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-311"></a>
<a name="ln-312"></a>    <span class="c">! Set the element information</span>
<a name="ln-313"></a>    <span class="n">nid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-314"></a>    <span class="k">DO </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span>
<a name="ln-315"></a>      <span class="n">myMesh</span> <span class="p">%</span> <span class="n">eleminfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfLineLinear</span> <span class="c">! Element Type</span>
<a name="ln-316"></a>      <span class="n">myMesh</span> <span class="p">%</span> <span class="n">eleminfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! Element Zone</span>
<a name="ln-317"></a>      <span class="n">myMesh</span> <span class="p">%</span> <span class="n">eleminfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">nid</span> <span class="c">! Node Index Start</span>
<a name="ln-318"></a>      <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-319"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">nid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xGeo</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span>
<a name="ln-320"></a>        <span class="n">nid</span> <span class="o">=</span> <span class="n">nid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-321"></a>      <span class="k">END DO</span>
<a name="ln-322"></a><span class="k">      </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">eleminfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">nid</span> <span class="o">-</span> <span class="mi">1</span> <span class="c">! Node Index End</span>
<a name="ln-323"></a>    <span class="k">END DO</span>
<a name="ln-324"></a>
<a name="ln-325"></a><span class="k">    CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-326"></a>
<a name="ln-327"></a>    <span class="k">CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-328"></a>    <span class="k">CALL </span><span class="n">xGeo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-329"></a>
<a name="ln-330"></a>  <span class="k">END SUBROUTINE </span><span class="n">UniformBlockMesh_Mesh1D</span>
<a name="ln-331"></a>
<a name="ln-332"></a>  <span class="k">SUBROUTINE </span><span class="n">Init_Mesh2D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">nSides</span><span class="p">,</span><span class="n">nNodes</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-333"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-334"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-335"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nGeo</span>
<a name="ln-336"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-337"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nSides</span>
<a name="ln-338"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nNodes</span>
<a name="ln-339"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nBCs</span>
<a name="ln-340"></a>    <span class="c">! Local</span>
<a name="ln-341"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">l</span>
<a name="ln-342"></a>
<a name="ln-343"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nGeo</span> <span class="o">=</span> <span class="n">nGeo</span>
<a name="ln-344"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-345"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nNodes</span> <span class="o">=</span> <span class="n">nNodes</span>
<a name="ln-346"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nSides</span> <span class="o">=</span> <span class="n">nSides</span>
<a name="ln-347"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nCornerNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-348"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-349"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-350"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nBCs</span> <span class="o">=</span> <span class="n">nBCs</span>
<a name="ln-351"></a>
<a name="ln-352"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">elemInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-353"></a>                                   <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-354"></a>
<a name="ln-355"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">sideInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-356"></a>                                   <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">nSides</span><span class="o">/</span><span class="p">))</span>
<a name="ln-357"></a>
<a name="ln-358"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nodeCoords</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-359"></a>                                     <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">nNodes</span><span class="o">/</span><span class="p">))</span>
<a name="ln-360"></a>
<a name="ln-361"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">globalNodeIDs</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-362"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="n">nNodes</span><span class="p">)</span>
<a name="ln-363"></a>
<a name="ln-364"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSCornerMap</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-365"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-366"></a>
<a name="ln-367"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSSideMap</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-368"></a>                                      <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="p">))</span>
<a name="ln-369"></a>
<a name="ln-370"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">curveNodeMap</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-371"></a>                                       <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,(</span><span class="n">nGeo</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">))</span>
<a name="ln-372"></a>
<a name="ln-373"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">curveNodeMapInv</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-374"></a>                                          <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nGeo</span><span class="o">/</span><span class="p">))</span>
<a name="ln-375"></a>
<a name="ln-376"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-377"></a>                                 <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">nBCs</span><span class="o">/</span><span class="p">))</span>
<a name="ln-378"></a>
<a name="ln-379"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCNames</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nBCs</span><span class="p">))</span>
<a name="ln-380"></a>
<a name="ln-381"></a>    <span class="c">! Create lookup tables to assist with connectivity generation</span>
<a name="ln-382"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-383"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">nGeo</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-384"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">nGeo</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-385"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">nGeo</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-386"></a>
<a name="ln-387"></a>    <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nGeo</span>
<a name="ln-388"></a>      <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nGeo</span>
<a name="ln-389"></a>        <span class="n">l</span> <span class="o">=</span> <span class="n">l</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-390"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">curveNodeMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">/</span><span class="p">)</span>
<a name="ln-391"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">curveNodeMapInv</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">l</span>
<a name="ln-392"></a>      <span class="k">ENDDO</span>
<a name="ln-393"></a><span class="k">    ENDDO</span>
<a name="ln-394"></a>
<a name="ln-395"></a>    <span class="c">! Maps from local corner node id to CGNS side</span>
<a name="ln-396"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="p">)</span>
<a name="ln-397"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="p">)</span>
<a name="ln-398"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="p">)</span>
<a name="ln-399"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="p">)</span>
<a name="ln-400"></a>
<a name="ln-401"></a>  <span class="k">END SUBROUTINE </span><span class="n">Init_Mesh2D</span>
<a name="ln-402"></a>
<a name="ln-403"></a>  <span class="k">SUBROUTINE </span><span class="n">Free_Mesh2D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-404"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-405"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-406"></a>
<a name="ln-407"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-408"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-409"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nSides</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-410"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nCornerNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-411"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-412"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-413"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nBCs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-414"></a>
<a name="ln-415"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">elemInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-416"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">sideInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-417"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nodeCoords</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-418"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSCornerMap</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-419"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">globalNodeIDs</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-420"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-421"></a>
<a name="ln-422"></a>    <span class="k">DEALLOCATE</span> <span class="p">(</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCNames</span><span class="p">)</span>
<a name="ln-423"></a>
<a name="ln-424"></a>  <span class="k">END SUBROUTINE </span><span class="n">Free_Mesh2D</span>
<a name="ln-425"></a>
<a name="ln-426"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateHost_Mesh2D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-427"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-428"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-429"></a>
<a name="ln-430"></a><span class="cp">#ifdef GPU</span>
<a name="ln-431"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">elemInfo</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-432"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">sideInfo</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-433"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nodeCoords</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-434"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">globalNodeIDs</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-435"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-436"></a><span class="cp">#endif</span>
<a name="ln-437"></a>
<a name="ln-438"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateHost_Mesh2D</span>
<a name="ln-439"></a>
<a name="ln-440"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateDevice_Mesh2D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-441"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-442"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-443"></a>
<a name="ln-444"></a><span class="cp">#ifdef GPU</span>
<a name="ln-445"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">elemInfo</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-446"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">sideInfo</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-447"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nodeCoords</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-448"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">globalNodeIDs</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-449"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-450"></a><span class="cp">#endif</span>
<a name="ln-451"></a>
<a name="ln-452"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateDevice_Mesh2D</span>
<a name="ln-453"></a>
<a name="ln-454"></a><span class="c">!  SUBROUTINE GenerateConnectivity_Mesh2D(myMesh)</span>
<a name="ln-455"></a><span class="c">!  ! Create the sideInfo information given eleminfo</span>
<a name="ln-456"></a><span class="c">!  !  &gt; Assumes quadrilateral mesh in 2-D</span>
<a name="ln-457"></a><span class="c">!  !  &gt; Assumes hexahedral mesh in 3-D</span>
<a name="ln-458"></a><span class="c">!    IMPLICIT NONE</span>
<a name="ln-459"></a><span class="c">!    CLASS(Mesh2D),INTENT(inout) :: myMesh</span>
<a name="ln-460"></a><span class="c">!</span>
<a name="ln-461"></a><span class="c">!    ! Find matching nodes</span>
<a name="ln-462"></a><span class="c">!    DO </span>
<a name="ln-463"></a><span class="c">!    ! SideInfo</span>
<a name="ln-464"></a><span class="c">!    !</span>
<a name="ln-465"></a><span class="c">!    !  SideType : Side Type encoding. The number of corner nodes is the last digit.</span>
<a name="ln-466"></a><span class="c">!    !  GlobalSideID : Unique side ID global identifier</span>
<a name="ln-467"></a><span class="c">!    !</span>
<a name="ln-468"></a><span class="c">!    !  nbElemID : Neighbor Element ID</span>
<a name="ln-469"></a><span class="c">!    !</span>
<a name="ln-470"></a><span class="c">!    !  10*nbLocSide+Flip : first digit - local side of the connected neighbor element; last digit - Orientation between the sides</span>
<a name="ln-471"></a><span class="c">!    !  (flip in [0,2])</span>
<a name="ln-472"></a><span class="c">!    !</span>
<a name="ln-473"></a><span class="c">!    !  BCID : Refers to the row index of the Boundary Condition List in BCNames/BCType array (in [1,nBCs]); = 0 for inner sides</span>
<a name="ln-474"></a><span class="c">!</span>
<a name="ln-475"></a><span class="c">!    ! Nodes are assumed to be defined on gauss-lobatto points - This allows us to check if nodes are the same along boundary</span>
<a name="ln-476"></a><span class="c">!    ! edges/faces</span>
<a name="ln-477"></a><span class="c">!</span>
<a name="ln-478"></a><span class="c">!    ! Loop over elements,</span>
<a name="ln-479"></a><span class="c">!    !   &gt; Loop over local nodes    </span>
<a name="ln-480"></a><span class="c">!    !     &gt; Loop over elements up to current element minus 1</span>
<a name="ln-481"></a><span class="c">!    !       &gt; Loop over local nodes</span>
<a name="ln-482"></a><span class="c">!    !         &gt; Check for match with previous node</span>
<a name="ln-483"></a><span class="c">!    !         &gt; IF MATCH</span>
<a name="ln-484"></a><span class="c">!    !           &gt; Update Global Node ID to matched node Global Node ID</span>
<a name="ln-485"></a><span class="c">!    !         &gt; ELSE</span>
<a name="ln-486"></a><span class="c">!    !           &gt; Assign new global node id</span>
<a name="ln-487"></a><span class="c">!</span>
<a name="ln-488"></a><span class="c">!    ! Loop over elements,</span>
<a name="ln-489"></a><span class="c">!    !   &gt; Loop over local sides</span>
<a name="ln-490"></a><span class="c">!    !     &gt; Assign side type (Assume line in 2-D)</span>
<a name="ln-491"></a><span class="c">!    !     &gt; Set nbElemID = current element ID</span>
<a name="ln-492"></a><span class="c">!    !     &gt; Set &quot;current local side&quot; as nbLocalSideID, &quot;0&quot; orientiation </span>
<a name="ln-493"></a><span class="c">!    !     &gt; Set the BCID = 0</span>
<a name="ln-494"></a><span class="c">!    !     &gt; Save nodelist for this side</span>
<a name="ln-495"></a><span class="c">!    !</span>
<a name="ln-496"></a><span class="c">!    !   &gt; Loop over elements up to current element minus 1</span>
<a name="ln-497"></a><span class="c">!    !      &gt; Check for match with previous side</span>
<a name="ln-498"></a><span class="c">!    !      &gt; IF MATCH</span>
<a name="ln-499"></a><span class="c">!    !        &gt; Update Global ID of secondary element</span>
<a name="ln-500"></a><span class="c">!    !        &gt; Set nbElemID for both elements; nbElemID of primary element is secondary element ID and vice-versa.</span>
<a name="ln-501"></a><span class="c">!    !        &gt; Set nbLocalSideID for local side of neighboring element (</span>
<a name="ln-502"></a><span class="c">!    !        &gt; Update &quot;Flip&quot; of secondary element, relative to primary element</span>
<a name="ln-503"></a><span class="c">!</span>
<a name="ln-504"></a><span class="c">!</span>
<a name="ln-505"></a><span class="c">!  END SUBROUTINE GenerateConnectivity_Mesh2D</span>
<a name="ln-506"></a>
<a name="ln-507"></a>  <span class="k">SUBROUTINE </span><span class="n">UniformBlockMesh_Mesh2D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<a name="ln-508"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-509"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-510"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nGeo</span>
<a name="ln-511"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-512"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-513"></a>    <span class="c">! Local</span>
<a name="ln-514"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iel</span><span class="p">,</span><span class="n">jel</span><span class="p">,</span><span class="n">nEl</span><span class="p">,</span><span class="n">elid</span>
<a name="ln-515"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">sid</span><span class="p">,</span><span class="n">nid</span><span class="p">,</span><span class="n">nNodes</span>
<a name="ln-516"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nSides</span>
<a name="ln-517"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span>
<a name="ln-518"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-519"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">yU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-520"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xLinear</span>
<a name="ln-521"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xGeo</span>
<a name="ln-522"></a>
<a name="ln-523"></a>    <span class="n">nEl</span> <span class="o">=</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-524"></a>    <span class="n">nNodes</span> <span class="o">=</span> <span class="n">nel</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-525"></a>    <span class="n">nSides</span> <span class="o">=</span> <span class="p">(</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-526"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nEl</span><span class="p">,</span><span class="n">nSides</span><span class="p">,</span><span class="n">nNodes</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-527"></a>
<a name="ln-528"></a>    <span class="c">! Set the nodeCoords</span>
<a name="ln-529"></a>    <span class="n">xU</span> <span class="o">=</span> <span class="n">UniformPoints</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-530"></a>    <span class="n">yU</span> <span class="o">=</span> <span class="n">UniformPoints</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">x</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-531"></a>
<a name="ln-532"></a>    <span class="c">! Create a linear interpolant to interpolate to nGeo grid</span>
<a name="ln-533"></a>    <span class="k">CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-534"></a>                        <span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-535"></a>                        <span class="mi">1</span><span class="p">,</span><span class="n">nEl</span><span class="p">)</span>
<a name="ln-536"></a>
<a name="ln-537"></a>    <span class="k">CALL </span><span class="n">xGeo</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-538"></a>                     <span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-539"></a>                     <span class="mi">1</span><span class="p">,</span><span class="n">nEl</span><span class="p">)</span>
<a name="ln-540"></a>    <span class="n">elid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-541"></a>    <span class="k">DO </span><span class="n">jel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-542"></a>      <span class="k">DO </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-543"></a>        <span class="c">! x component</span>
<a name="ln-544"></a>        <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xU</span><span class="p">(</span><span class="n">iel</span><span class="p">:</span><span class="n">iel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-545"></a>        <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xU</span><span class="p">(</span><span class="n">iel</span><span class="p">:</span><span class="n">iel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-546"></a>        <span class="c">! y component</span>
<a name="ln-547"></a>        <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">yU</span><span class="p">(</span><span class="n">jel</span><span class="p">:</span><span class="n">jel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-548"></a>        <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">yU</span><span class="p">(</span><span class="n">jel</span><span class="p">:</span><span class="n">jel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-549"></a>        <span class="c">! Incremenent the element ID</span>
<a name="ln-550"></a>        <span class="n">elid</span> <span class="o">=</span> <span class="n">elid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-551"></a>      <span class="k">END DO</span>
<a name="ln-552"></a><span class="k">    END DO</span>
<a name="ln-553"></a>
<a name="ln-554"></a><span class="k">    CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">GridInterp</span><span class="p">(</span><span class="n">xGeo</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-555"></a>
<a name="ln-556"></a>    <span class="c">! Set the element information</span>
<a name="ln-557"></a>    <span class="n">nid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-558"></a>    <span class="n">sid</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-559"></a>    <span class="n">elid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-560"></a>    <span class="k">DO </span><span class="n">jel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-561"></a>      <span class="k">DO </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-562"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">eleminfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfQuadLinear</span> <span class="c">! Element Type</span>
<a name="ln-563"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">eleminfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! Element Zone</span>
<a name="ln-564"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">eleminfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">sid</span> <span class="c">! Side Index Start</span>
<a name="ln-565"></a>        <span class="n">sid</span> <span class="o">=</span> <span class="n">sid</span><span class="o">+</span><span class="mi">4</span>
<a name="ln-566"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">eleminfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">sid</span> <span class="c">! Side Index End</span>
<a name="ln-567"></a>        <span class="n">myMesh</span> <span class="p">%</span> <span class="n">eleminfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">nid</span><span class="o">-</span><span class="mi">1</span> <span class="c">! Node Index Start</span>
<a name="ln-568"></a>        <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-569"></a>          <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-570"></a>            <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">nid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xGeo</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span>
<a name="ln-571"></a>            <span class="n">nid</span> <span class="o">=</span> <span class="n">nid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-572"></a>          <span class="k">END DO</span>
<a name="ln-573"></a><span class="k">        END DO</span>
<a name="ln-574"></a><span class="k">        </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">eleminfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">nid</span> <span class="c">! Node Index End</span>
<a name="ln-575"></a>        <span class="n">elid</span> <span class="o">=</span> <span class="n">elid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-576"></a>      <span class="k">END DO</span>
<a name="ln-577"></a><span class="k">    END DO</span>
<a name="ln-578"></a>
<a name="ln-579"></a>
<a name="ln-580"></a><span class="k">    CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-581"></a>
<a name="ln-582"></a>    <span class="k">CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-583"></a>    <span class="k">CALL </span><span class="n">xGeo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-584"></a>
<a name="ln-585"></a>  <span class="k">END SUBROUTINE </span><span class="n">UniformBlockMesh_Mesh2D</span>
<a name="ln-586"></a>
<a name="ln-587"></a>  <span class="k">SUBROUTINE </span><span class="n">Init_Mesh3D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">nSides</span><span class="p">,</span><span class="n">nNodes</span><span class="p">,</span><span class="n">nBCs</span><span class="p">)</span>
<a name="ln-588"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-589"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-590"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nGeo</span>
<a name="ln-591"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-592"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nSides</span>
<a name="ln-593"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nNodes</span>
<a name="ln-594"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nBCs</span>
<a name="ln-595"></a>    <span class="c">! Local</span>
<a name="ln-596"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">l</span>
<a name="ln-597"></a>
<a name="ln-598"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-599"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nGeo</span> <span class="o">=</span> <span class="n">nGeo</span>
<a name="ln-600"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nSides</span> <span class="o">=</span> <span class="n">nSides</span>
<a name="ln-601"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nNodes</span> <span class="o">=</span> <span class="n">nNodes</span>
<a name="ln-602"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nCornerNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-603"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-604"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-605"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nBCs</span> <span class="o">=</span> <span class="n">nBCs</span>
<a name="ln-606"></a>
<a name="ln-607"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">elemInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-608"></a>                                   <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-609"></a>
<a name="ln-610"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">sideInfo</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-611"></a>                                   <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">nSides</span><span class="o">/</span><span class="p">))</span>
<a name="ln-612"></a>
<a name="ln-613"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nodeCoords</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-614"></a>                                     <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="n">nNodes</span><span class="o">/</span><span class="p">))</span>
<a name="ln-615"></a>
<a name="ln-616"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">globalNodeIDs</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-617"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="n">nNodes</span><span class="p">)</span>
<a name="ln-618"></a>
<a name="ln-619"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSCornerMap</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-620"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-621"></a>
<a name="ln-622"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSSideMap</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-623"></a>                                      <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="o">/</span><span class="p">))</span>
<a name="ln-624"></a>
<a name="ln-625"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">curveNodeMap</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-626"></a>                                       <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">3</span><span class="p">,(</span><span class="n">nGeo</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="p">))</span>
<a name="ln-627"></a>
<a name="ln-628"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">curveNodeMapInv</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-629"></a>                                          <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nGeo</span><span class="o">/</span><span class="p">))</span>
<a name="ln-630"></a>
<a name="ln-631"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-632"></a>                                 <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">nBCs</span><span class="o">/</span><span class="p">))</span>
<a name="ln-633"></a>
<a name="ln-634"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCNames</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nBCs</span><span class="p">))</span>
<a name="ln-635"></a>
<a name="ln-636"></a>    <span class="c">! Create lookup tables to assist with connectivity generation</span>
<a name="ln-637"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-638"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">nGeo</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-639"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">nGeo</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-640"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">nGeo</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-641"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">nGeo</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-642"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">nGeo</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">nGeo</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-643"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">nGeo</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
<a name="ln-644"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSCornerMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">nGeo</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-645"></a>
<a name="ln-646"></a>    <span class="k">DO </span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nGeo</span>
<a name="ln-647"></a>      <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nGeo</span>
<a name="ln-648"></a>        <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nGeo</span>
<a name="ln-649"></a>          <span class="n">l</span> <span class="o">=</span> <span class="n">l</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-650"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">curveNodeMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">/</span><span class="p">)</span>
<a name="ln-651"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">curveNodeMapInv</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">l</span>
<a name="ln-652"></a>        <span class="k">ENDDO</span>
<a name="ln-653"></a><span class="k">      ENDDO</span>
<a name="ln-654"></a><span class="k">    ENDDO</span>
<a name="ln-655"></a>
<a name="ln-656"></a>    <span class="c">! Maps from local corner node id to CGNS side</span>
<a name="ln-657"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="p">)</span>
<a name="ln-658"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="o">/</span><span class="p">)</span>
<a name="ln-659"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="o">/</span><span class="p">)</span>
<a name="ln-660"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="o">/</span><span class="p">)</span>
<a name="ln-661"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="p">)</span>
<a name="ln-662"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSSideMap</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="o">/</span><span class="p">)</span>
<a name="ln-663"></a>
<a name="ln-664"></a>  <span class="k">END SUBROUTINE </span><span class="n">Init_Mesh3D</span>
<a name="ln-665"></a>
<a name="ln-666"></a>  <span class="k">SUBROUTINE </span><span class="n">Free_Mesh3D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-667"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-668"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-669"></a>
<a name="ln-670"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-671"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nSides</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-672"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-673"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nCornerNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-674"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueSides</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-675"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nUniqueNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-676"></a>    <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nBCs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-677"></a>
<a name="ln-678"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">elemInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-679"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">sideInfo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-680"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nodeCoords</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-681"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">CGNSCornerMap</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-682"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">globalNodeIDs</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-683"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-684"></a>
<a name="ln-685"></a>    <span class="k">DEALLOCATE</span> <span class="p">(</span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCNames</span><span class="p">)</span>
<a name="ln-686"></a>
<a name="ln-687"></a>  <span class="k">END SUBROUTINE </span><span class="n">Free_Mesh3D</span>
<a name="ln-688"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateHost_Mesh3D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-689"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-690"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-691"></a>
<a name="ln-692"></a><span class="cp">#ifdef GPU</span>
<a name="ln-693"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">elemInfo</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-694"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">sideInfo</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-695"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nodeCoords</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-696"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">globalNodeIDs</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-697"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-698"></a><span class="cp">#endif</span>
<a name="ln-699"></a>
<a name="ln-700"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateHost_Mesh3D</span>
<a name="ln-701"></a>
<a name="ln-702"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateDevice_Mesh3D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">)</span>
<a name="ln-703"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-704"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-705"></a>
<a name="ln-706"></a><span class="cp">#ifdef GPU</span>
<a name="ln-707"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">elemInfo</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-708"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">sideInfo</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-709"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">nodeCoords</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-710"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">globalNodeIDs</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-711"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">BCType</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-712"></a><span class="cp">#endif</span>
<a name="ln-713"></a>
<a name="ln-714"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateDevice_Mesh3D</span>
<a name="ln-715"></a>
<a name="ln-716"></a>  <span class="k">SUBROUTINE </span><span class="n">UniformBlockMesh_Mesh3D</span><span class="p">(</span><span class="n">myMesh</span><span class="p">,</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nElem</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<a name="ln-717"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-718"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Mesh3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myMesh</span>
<a name="ln-719"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nGeo</span>
<a name="ln-720"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-721"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-722"></a>    <span class="c">! Local</span>
<a name="ln-723"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iel</span><span class="p">,</span><span class="n">jel</span><span class="p">,</span><span class="n">kel</span><span class="p">,</span><span class="n">nEl</span><span class="p">,</span><span class="n">elid</span>
<a name="ln-724"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">sid</span><span class="p">,</span><span class="n">nid</span><span class="p">,</span><span class="n">nNodes</span>
<a name="ln-725"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nSides</span>
<a name="ln-726"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a name="ln-727"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-728"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">yU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-729"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">zU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-730"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xLinear</span>
<a name="ln-731"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xGeo</span>
<a name="ln-732"></a>
<a name="ln-733"></a>    <span class="n">nEl</span> <span class="o">=</span> <span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-734"></a>    <span class="n">nNodes</span> <span class="o">=</span> <span class="n">nel</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nGeo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-735"></a>    <span class="n">nSides</span> <span class="o">=</span> <span class="p">(</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-736"></a>             <span class="p">(</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-737"></a>             <span class="p">(</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-738"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">nEl</span><span class="p">,</span><span class="n">nSides</span><span class="p">,</span><span class="n">nNodes</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-739"></a>
<a name="ln-740"></a>    <span class="c">! Set the nodeCoords</span>
<a name="ln-741"></a>    <span class="n">xU</span> <span class="o">=</span> <span class="n">UniformPoints</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-742"></a>    <span class="n">yU</span> <span class="o">=</span> <span class="n">UniformPoints</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">x</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-743"></a>    <span class="n">zU</span> <span class="o">=</span> <span class="n">UniformPoints</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">x</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-744"></a>
<a name="ln-745"></a>    <span class="c">! Create a linear interpolant to interpolate to nGeo grid</span>
<a name="ln-746"></a>    <span class="k">CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-747"></a>                        <span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-748"></a>                        <span class="mi">1</span><span class="p">,</span><span class="n">nEl</span><span class="p">)</span>
<a name="ln-749"></a>
<a name="ln-750"></a>    <span class="k">CALL </span><span class="n">xGeo</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-751"></a>                     <span class="n">nGeo</span><span class="p">,</span><span class="n">GAUSS_LOBATTO</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-752"></a>                     <span class="mi">1</span><span class="p">,</span><span class="n">nEl</span><span class="p">)</span>
<a name="ln-753"></a>    <span class="n">elid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-754"></a>    <span class="k">DO </span><span class="n">kel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-755"></a>      <span class="k">DO </span><span class="n">jel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-756"></a>        <span class="k">DO </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-757"></a>          <span class="c">! x component</span>
<a name="ln-758"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xU</span><span class="p">(</span><span class="n">iel</span><span class="p">:</span><span class="n">iel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-759"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xU</span><span class="p">(</span><span class="n">iel</span><span class="p">:</span><span class="n">iel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-760"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xU</span><span class="p">(</span><span class="n">iel</span><span class="p">:</span><span class="n">iel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-761"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xU</span><span class="p">(</span><span class="n">iel</span><span class="p">:</span><span class="n">iel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-762"></a>          <span class="c">! y component</span>
<a name="ln-763"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">yU</span><span class="p">(</span><span class="n">jel</span><span class="p">:</span><span class="n">jel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-764"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">yU</span><span class="p">(</span><span class="n">jel</span><span class="p">:</span><span class="n">jel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-765"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">yU</span><span class="p">(</span><span class="n">jel</span><span class="p">:</span><span class="n">jel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-766"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">yU</span><span class="p">(</span><span class="n">jel</span><span class="p">:</span><span class="n">jel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-767"></a>          <span class="c">! z component</span>
<a name="ln-768"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">zU</span><span class="p">(</span><span class="n">kel</span><span class="p">:</span><span class="n">kel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-769"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">zU</span><span class="p">(</span><span class="n">kel</span><span class="p">:</span><span class="n">kel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-770"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">zU</span><span class="p">(</span><span class="n">kel</span><span class="p">:</span><span class="n">kel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-771"></a>          <span class="n">xLinear</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span> <span class="o">=</span> <span class="n">zU</span><span class="p">(</span><span class="n">kel</span><span class="p">:</span><span class="n">kel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-772"></a>          <span class="c">! Incremenent the element ID</span>
<a name="ln-773"></a>          <span class="n">elid</span> <span class="o">=</span> <span class="n">elid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-774"></a>        <span class="k">END DO</span>
<a name="ln-775"></a><span class="k">      END DO</span>
<a name="ln-776"></a><span class="k">    END DO</span>
<a name="ln-777"></a>
<a name="ln-778"></a><span class="k">    CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">GridInterp</span><span class="p">(</span><span class="n">xGeo</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-779"></a>
<a name="ln-780"></a>    <span class="c">! Set the element information</span>
<a name="ln-781"></a>    <span class="n">nid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-782"></a>    <span class="n">sid</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-783"></a>    <span class="n">elid</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-784"></a>    <span class="k">DO </span><span class="n">kel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-785"></a>      <span class="k">DO </span><span class="n">jel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-786"></a>        <span class="k">DO </span><span class="n">iel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nElem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-787"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">eleminfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">selfQuadLinear</span> <span class="c">! Element Type</span>
<a name="ln-788"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">eleminfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! Element Zone</span>
<a name="ln-789"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">eleminfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">sid</span> <span class="c">! Side Index Start</span>
<a name="ln-790"></a>          <span class="n">sid</span> <span class="o">=</span> <span class="n">sid</span> <span class="o">+</span> <span class="mi">6</span>
<a name="ln-791"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">eleminfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">sid</span> <span class="c">! Side Index End</span>
<a name="ln-792"></a>          <span class="n">myMesh</span> <span class="p">%</span> <span class="n">eleminfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">nid</span><span class="o">-</span><span class="mi">1</span> <span class="c">! Node Index Start</span>
<a name="ln-793"></a>          <span class="k">DO </span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-794"></a>            <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-795"></a>              <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">nGeo</span>
<a name="ln-796"></a>                <span class="n">myMesh</span> <span class="p">%</span> <span class="n">nodeCoords</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">nid</span><span class="p">)</span> <span class="o">=</span> <span class="n">xGeo</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">elid</span><span class="p">)</span>
<a name="ln-797"></a>                <span class="n">nid</span> <span class="o">=</span> <span class="n">nid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-798"></a>              <span class="k">END DO</span>
<a name="ln-799"></a><span class="k">            END DO</span>
<a name="ln-800"></a><span class="k">          END DO</span>
<a name="ln-801"></a><span class="k">          </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">eleminfo</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">iel</span><span class="p">)</span> <span class="o">=</span> <span class="n">nid</span> <span class="c">! Node Index End</span>
<a name="ln-802"></a>          <span class="n">elid</span> <span class="o">=</span> <span class="n">elid</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-803"></a>        <span class="k">END DO</span>
<a name="ln-804"></a><span class="k">      END DO</span>
<a name="ln-805"></a><span class="k">    END DO</span>
<a name="ln-806"></a>
<a name="ln-807"></a>    <span class="c">! TO DO: Add Side information !</span>
<a name="ln-808"></a>
<a name="ln-809"></a>    <span class="k">CALL </span><span class="n">myMesh</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-810"></a>
<a name="ln-811"></a>    <span class="k">CALL </span><span class="n">xLinear</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-812"></a>    <span class="k">CALL </span><span class="n">xGeo</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-813"></a>
<a name="ln-814"></a>  <span class="k">END SUBROUTINE </span><span class="n">UniformBlockMesh_Mesh3D</span>
<a name="ln-815"></a>
<a name="ln-816"></a><span class="k">END MODULE </span><span class="n">SELF_Mesh</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2021-04-14 00:34  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SELF was developed by Joe Schoonover</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>