<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Spectral Element Libraries in Fortran. Fortran classes for implementing spectral element methods on CPU and GPU hardware.">
    
    <meta name="author" content="Joe Schoonover" >
    <link rel="icon" href="../favicon.png">

    <title>SELF_SupportRoutines.f90 &ndash; SELF</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SELF </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/self.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/self.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>SELF_SupportRoutines.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 4.6% of total for source files.">364 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/SELF_SupportRoutines.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">SELF_SupportRoutines.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/self_supportroutines.html">SELF_SupportRoutines</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/self_supportroutines.f90.html#src">SELF_SupportRoutines.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~self_supportroutines.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileself_supportroutinesf90EfferentGraph" width="311pt" height="32pt"
 viewBox="0.00 0.00 311.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~self_supportroutines.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~self_supportroutines.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 307,-28 307,4 -4,4"/>
<!-- sourcefile~self_supportroutines.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~self_supportroutines.f90</title>
<polygon fill="none" stroke="#000000" points="303,-24 152,-24 152,0 303,0 303,-24"/>
<text text-anchor="middle" x="227.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">SELF_SupportRoutines.f90</text>
</g>
<!-- sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~self_constants.f90</title>
<g id="a_sourcefile~~self_supportroutines.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/self_constants.f90.html" xlink:title="SELF_Constants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="116,-24 0,-24 0,0 116,0 116,-24"/>
<text text-anchor="middle" x="58" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SELF_Constants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_supportroutines.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~self_supportroutines.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M151.6737,-12C143.2139,-12 134.6341,-12 126.2766,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="126.2156,-8.5001 116.2155,-12 126.2155,-15.5001 126.2156,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~self_supportroutines.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileself_supportroutinesf90AfferentGraph" width="641pt" height="153pt"
 viewBox="0.00 0.00 641.00 153.01" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph" class="graph" transform="scale(.5718 .5718) rotate(0) translate(4 263.5924)">
<title>sourcefile~~self_supportroutines.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-263.5924 1117,-263.5924 1117,4 -4,4"/>
<!-- sourcefile~self_supportroutines.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~self_supportroutines.f90</title>
<polygon fill="none" stroke="#000000" points="151,-146.1745 0,-146.1745 0,-122.1745 151,-122.1745 151,-146.1745"/>
<text text-anchor="middle" x="75.5" y="-131.7745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">SELF_SupportRoutines.f90</text>
</g>
<!-- sourcefile~self_tests.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~self_tests.f90</title>
<g id="a_sourcefile~~self_supportroutines.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/self_tests.f90.html" xlink:title="SELF_Tests.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1009.5,-80.1745 919.5,-80.1745 919.5,-56.1745 1009.5,-56.1745 1009.5,-80.1745"/>
<text text-anchor="middle" x="964.5" y="-65.7745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SELF_Tests.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_tests.f90&#45;&gt;sourcefile~self_supportroutines.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~self_tests.f90&#45;&gt;sourcefile~self_supportroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M923.4516,-56.1289C863.2491,-39.7938 747.3218,-13.3838 647.5,-20.1745"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M647.5,-20.1745C585.7507,-22.0509 570.2072,-23.1273 508.5,-20.1745"/>
</g>
<!-- sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~self_mesh.f90</title>
<g id="a_sourcefile~~self_supportroutines.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/self_mesh.f90.html" xlink:title="SELF_Mesh.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="554,-224.1745 463,-224.1745 463,-200.1745 554,-200.1745 554,-224.1745"/>
<text text-anchor="middle" x="508.5" y="-209.7745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SELF_Mesh.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_tests.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~self_tests.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M944.5431,-80.2824C926.266,-91.1323 898.2916,-107.1444 873,-119.1745 800.4081,-153.7034 782.7756,-165.8576 705,-186.1745 658.4447,-198.336 604.1232,-204.969 564.4087,-208.4846"/>
<polygon fill="#0066ff" stroke="#0066ff" points="564.0532,-205.0021 554.3842,-209.3334 564.6438,-211.9771 564.0532,-205.0021"/>
</g>
<!-- sourcefile~self_lagrange.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~self_lagrange.f90</title>
<g id="a_sourcefile~~self_supportroutines.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/self_lagrange.f90.html" xlink:title="SELF_Lagrange.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="302,-146.1745 187,-146.1745 187,-122.1745 302,-122.1745 302,-146.1745"/>
<text text-anchor="middle" x="244.5" y="-131.7745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SELF_Lagrange.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_tests.f90&#45;&gt;sourcefile~self_lagrange.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~self_tests.f90&#45;&gt;sourcefile~self_lagrange.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M647.5,-20.1745C583.6029,-24.5214 568.824,-36.663 508.5,-58.1745"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M508.5,-58.1745C494.7857,-63.0651 396.8783,-91.88 382.5,-94.1745"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M382.5,-94.1745C349.8115,-99.3911 313.9307,-109.9478 286.951,-118.9066"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="285.7893,-115.6046 277.4362,-122.122 288.0304,-122.2362 285.7893,-115.6046"/>
</g>
<!-- sourcefile~self_mappeddata.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~self_mappeddata.f90</title>
<g id="a_sourcefile~~self_supportroutines.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/self_mappeddata.f90.html" xlink:title="SELF_MappedData.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="873,-110.1745 741,-110.1745 741,-86.1745 873,-86.1745 873,-110.1745"/>
<text text-anchor="middle" x="807" y="-95.7745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SELF_MappedData.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_tests.f90&#45;&gt;sourcefile~self_mappeddata.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~self_tests.f90&#45;&gt;sourcefile~self_mappeddata.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M919.3668,-76.7713C907.1251,-79.1031 893.5492,-81.689 880.1878,-84.234"/>
<polygon fill="#00ff00" stroke="#00ff00" points="879.2063,-80.858 870.0378,-86.1673 880.5161,-87.7343 879.2063,-80.858"/>
</g>
<!-- sourcefile~self_data.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~self_data.f90</title>
<g id="a_sourcefile~~self_supportroutines.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/self_data.f90.html" xlink:title="SELF_Data.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="427,-146.1745 338,-146.1745 338,-122.1745 427,-122.1745 427,-146.1745"/>
<text text-anchor="middle" x="382.5" y="-131.7745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SELF_Data.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_tests.f90&#45;&gt;sourcefile~self_data.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~self_tests.f90&#45;&gt;sourcefile~self_data.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M508.5,-58.1745C468.4732,-72.4481 463.4591,-86.3432 427,-108.1745 422.2021,-111.0475 417.0945,-114.0674 412.1144,-116.9912"/>
<polygon fill="#0000ff" stroke="#0000ff" points="410.2477,-114.0282 403.3824,-122.0978 413.7815,-120.0707 410.2477,-114.0282"/>
</g>
<!-- sourcefile~self.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~self.f90</title>
<g id="a_sourcefile~~self_supportroutines.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/self.f90.html" xlink:title="SELF.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1113,-31.1745 1056,-31.1745 1056,-7.1745 1113,-7.1745 1113,-31.1745"/>
<text text-anchor="middle" x="1084.5" y="-16.7745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SELF.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self.f90&#45;&gt;sourcefile~self_supportroutines.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~self.f90&#45;&gt;sourcefile~self_supportroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.7281,-16.1875C979.5731,-8.7639 766.4878,8.8737 590,-6.1745 553.3801,-9.2969 545.2108,-21.9312 508.5,-20.1745"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M508.5,-20.1745C354.8645,-8.8156 179.6076,-83.362 108.2767,-117.6162"/>
<polygon fill="#ff0000" stroke="#ff0000" points="106.3768,-114.6482 98.9144,-122.1691 109.4381,-120.9433 106.3768,-114.6482"/>
</g>
<!-- sourcefile~self.f90&#45;&gt;sourcefile~self_tests.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~self.f90&#45;&gt;sourcefile~self_tests.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.757,-30.9113C1040.2232,-37.2542 1020.8113,-45.1808 1003.8893,-52.0906"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1002.1965,-49.0012 994.2617,-56.0219 1004.8427,-55.4818 1002.1965,-49.0012"/>
</g>
<!-- sourcefile~self_geometry.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~self_geometry.f90</title>
<g id="a_sourcefile~~self_supportroutines.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/self_geometry.f90.html" xlink:title="SELF_Geometry.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="705,-110.1745 590,-110.1745 590,-86.1745 705,-86.1745 705,-110.1745"/>
<text text-anchor="middle" x="647.5" y="-95.7745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SELF_Geometry.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_geometry.f90&#45;&gt;sourcefile~self_supportroutines.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~self_geometry.f90&#45;&gt;sourcefile~self_supportroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.3776,-86.1311C612.684,-64.8765 561.2927,-22.7008 508.5,-20.1745"/>
</g>
<!-- sourcefile~self_geometry.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~self_geometry.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M632.6246,-110.3745C608.2746,-130.345 559.758,-170.1356 531.1244,-193.6193"/>
<polygon fill="#0066ff" stroke="#0066ff" points="528.7811,-191.0145 523.2685,-200.0623 533.2202,-196.427 528.7811,-191.0145"/>
</g>
<!-- sourcefile~self_geometry.f90&#45;&gt;sourcefile~self_lagrange.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~self_geometry.f90&#45;&gt;sourcefile~self_lagrange.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M616.3305,-110.1752C588.5295,-119.9245 546.4717,-132.3504 508.5,-134.1745"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M508.5,-134.1745C449.8135,-136.9939 440.7343,-86.3759 382.5,-94.1745"/>
</g>
<!-- sourcefile~self_geometry.f90&#45;&gt;sourcefile~self_data.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~self_geometry.f90&#45;&gt;sourcefile~self_data.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M508.5,-134.1745C485.2048,-135.2937 459.459,-135.4806 437.3442,-135.3178"/>
<polygon fill="#0000ff" stroke="#0000ff" points="437.1688,-131.8159 427.1345,-135.2164 437.0992,-138.8156 437.1688,-131.8159"/>
</g>
<!-- sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_supportroutines.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_supportroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M382.5,-174.1745C297.2758,-155.2582 273.4255,-167.4879 187,-155.1745 173.1124,-153.1959 158.3228,-150.693 144.2079,-148.1107"/>
<polygon fill="#ff0000" stroke="#ff0000" points="144.5436,-144.6131 134.0718,-146.2226 143.2617,-151.4947 144.5436,-144.6131"/>
</g>
<!-- sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_lagrange.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_lagrange.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M473.5685,-200.108C448.483,-191.8207 413.7275,-181.1058 382.5,-174.1745"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M382.5,-174.1745C351.7297,-167.3448 317.7146,-157.5121 291.1542,-149.3048"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="291.9507,-145.887 281.3621,-146.2486 289.8651,-152.5691 291.9507,-145.887"/>
</g>
<!-- sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_data.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_data.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M486.0008,-199.9443C478.5763,-195.7436 470.3423,-190.9048 463,-186.1745 446.4085,-175.4856 443.5399,-170.9432 427,-160.1745 422.522,-157.259 417.7116,-154.2889 412.9676,-151.4483"/>
<polygon fill="#0000ff" stroke="#0000ff" points="414.4257,-148.2455 404.0314,-146.1937 410.8776,-154.2796 414.4257,-148.2455"/>
</g>
<!-- sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_supportroutines.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_supportroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M186.8125,-134.1745C178.5651,-134.1745 169.9377,-134.1745 161.2921,-134.1745"/>
<polygon fill="#ff0000" stroke="#ff0000" points="161.1565,-130.6746 151.1565,-134.1745 161.1564,-137.6746 161.1565,-130.6746"/>
</g>
<!-- sourcefile~self_mpilayer.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~self_mpilayer.f90</title>
<g id="a_sourcefile~~self_supportroutines.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/self_mpilayer.f90.html" xlink:title="SELF_MPILayer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1020,-139.1745 909,-139.1745 909,-115.1745 1020,-115.1745 1020,-139.1745"/>
<text text-anchor="middle" x="964.5" y="-124.7745" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SELF_MPILayer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_mpilayer.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~self_mpilayer.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M957.2555,-139.3678C943.7395,-160.876 912.4423,-205.1677 873,-225.1745 782.9806,-270.8363 748.1805,-259.3806 647.5,-252.1745"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M647.5,-252.1745C611.741,-250.85 572.7228,-238.6061 545.1537,-228.0096"/>
<polygon fill="#0066ff" stroke="#0066ff" points="546.1282,-224.631 535.542,-224.2034 543.5509,-231.1393 546.1282,-224.631"/>
</g>
<!-- sourcefile~self_mpilayer.f90&#45;&gt;sourcefile~self_mappeddata.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~self_mpilayer.f90&#45;&gt;sourcefile~self_mappeddata.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M908.9714,-116.9502C900.3488,-115.3626 891.3182,-113.6998 882.3467,-112.0479"/>
<polygon fill="#00ff00" stroke="#00ff00" points="882.7361,-108.5608 872.2676,-110.1921 881.4684,-115.4451 882.7361,-108.5608"/>
</g>
<!-- sourcefile~self_mpilayer.f90&#45;&gt;sourcefile~self_data.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~self_mpilayer.f90&#45;&gt;sourcefile~self_data.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M647.5,-252.1745C565.1228,-249.1232 530.6783,-280.2379 463,-233.1745 433.3001,-212.5213 451.6607,-186.6413 427,-160.1745 424.2647,-157.2389 421.1222,-154.5339 417.7991,-152.0689"/>
<polygon fill="#0000ff" stroke="#0000ff" points="419.5665,-149.0415 409.2958,-146.4409 415.703,-154.8788 419.5665,-149.0415"/>
</g>
<!-- sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_geometry.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_geometry.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M740.7433,-98.1745C732.3461,-98.1745 723.7432,-98.1745 715.322,-98.1745"/>
<polygon fill="#00ff66" stroke="#00ff66" points="715.166,-94.6746 705.1659,-98.1745 715.1659,-101.6746 715.166,-94.6746"/>
</g>
<!-- sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M647.5,-172.1745C618.8971,-180.6679 586.9014,-189.8942 560.8242,-197.3432"/>
<polygon fill="#0066ff" stroke="#0066ff" points="559.7953,-193.997 551.139,-200.1059 561.7155,-200.7285 559.7953,-193.997"/>
</g>
<!-- sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_lagrange.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_lagrange.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M758.7995,-86.1584C741.9006,-82.5043 722.7169,-78.9794 705,-77.1745 562.2067,-62.6278 524.7623,-75.123 382.5,-94.1745"/>
</g>
<!-- sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_data.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_data.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M786.1086,-110.2899C756.3532,-126.9732 699.5885,-156.7073 647.5,-172.1745"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M647.5,-172.1745C569.018,-195.4792 473.0753,-168.722 420.8576,-149.7622"/>
<polygon fill="#0000ff" stroke="#0000ff" points="421.9155,-146.4213 411.3227,-146.209 419.4711,-152.9807 421.9155,-146.4213"/>
</g>
<!-- sourcefile~self_data.f90&#45;&gt;sourcefile~self_lagrange.f90 -->
<g id="sourcefile~~self_supportroutines.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~self_data.f90&#45;&gt;sourcefile~self_lagrange.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M337.6954,-134.1745C329.5498,-134.1745 320.8891,-134.1745 312.2544,-134.1745"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="312.1625,-130.6746 302.1624,-134.1745 312.1624,-137.6746 312.1625,-130.6746"/>
</g>
</g>
</svg>
</div><script>var pansourcefileself_supportroutinesf90AfferentGraph = svgPanZoom('#sourcefileself_supportroutinesf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/self_supportroutines.html">SELF_SupportRoutines</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/self_supportroutines.f90.html#src">SELF_SupportRoutines.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">! SELF_SupportRoutines.f90</span>
<a name="ln-2"></a><span class="c">!</span>
<a name="ln-3"></a><span class="c">! Copyright 2020 Fluid Numerics LLC</span>
<a name="ln-4"></a><span class="c">! Author : Joseph Schoonover (joe@fluidnumerics.com)</span>
<a name="ln-5"></a><span class="c">! Support : self-fluids@fluidnumerics.com</span>
<a name="ln-6"></a><span class="c">!</span>
<a name="ln-7"></a><span class="c">! //////////////////////////////////////////////////////////////////////////////////////////////// !</span>
<a name="ln-8"></a>
<a name="ln-9"></a><span class="c">!&gt; \file SELF_SupportRoutines.f90</span>
<a name="ln-10"></a><span class="c">!! Contains the \ref SELF_SupportRoutines module</span>
<a name="ln-11"></a>
<a name="ln-12"></a><span class="c">!&gt; \defgroup SELF_SupportRoutines SELF_SupportRoutines</span>
<a name="ln-13"></a><span class="c">!! This module defines a set of general purpose routines.</span>
<a name="ln-14"></a>
<a name="ln-15"></a><span class="k">MODULE </span><span class="n">SELF_SupportRoutines</span>
<a name="ln-16"></a>
<a name="ln-17"></a>  <span class="k">USE </span><span class="n">ISO_FORTRAN_ENV</span>
<a name="ln-18"></a>  <span class="k">USE </span><span class="n">SELF_Constants</span>
<a name="ln-19"></a>
<a name="ln-20"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-21"></a>
<a name="ln-22"></a><span class="k">CONTAINS</span>
<a name="ln-23"></a>
<a name="ln-24"></a><span class="k">  FUNCTION </span><span class="n">Int2Str</span><span class="p">(</span><span class="n">aNumber</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">aString</span><span class="p">)</span>
<a name="ln-25"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-26"></a><span class="k">    </span><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">aNumber</span>
<a name="ln-27"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">aString</span>
<a name="ln-28"></a>
<a name="ln-29"></a>    <span class="k">WRITE</span> <span class="p">(</span><span class="n">aString</span><span class="p">,</span><span class="s1">&#39;(I9)&#39;</span><span class="p">)</span> <span class="n">aNumber</span>
<a name="ln-30"></a>
<a name="ln-31"></a>  <span class="k">END FUNCTION </span><span class="n">Int2Str</span>
<a name="ln-32"></a>  <span class="k">FUNCTION </span><span class="n">Float2Str</span><span class="p">(</span><span class="n">aNumber</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">aString</span><span class="p">)</span>
<a name="ln-33"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-34"></a><span class="k">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">aNumber</span>
<a name="ln-35"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">aString</span>
<a name="ln-36"></a>
<a name="ln-37"></a>    <span class="k">WRITE</span> <span class="p">(</span><span class="n">aString</span><span class="p">,</span><span class="s1">&#39;(E12.4)&#39;</span><span class="p">)</span> <span class="n">aNumber</span>
<a name="ln-38"></a>
<a name="ln-39"></a>  <span class="k">END FUNCTION </span><span class="n">Float2Str</span>
<a name="ln-40"></a>
<a name="ln-41"></a><span class="c">!&gt; \addtogroup SELF_SupportRoutines</span>
<a name="ln-42"></a><span class="c">!! @{</span>
<a name="ln-43"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-44"></a><span class="c">! Function AlmostEqual</span>
<a name="ln-45"></a><span class="c">!</span>
<a name="ln-46"></a><span class="c">!&gt; \fn AlmostEqual</span>
<a name="ln-47"></a><span class="c">!! Compares two floating point numbers and determines if they are equal (to machine precision).</span>
<a name="ln-48"></a><span class="c">!!</span>
<a name="ln-49"></a><span class="c">!!   This function is from Alg. 139 on pg. 359 of D.A. Kopriva, 2009, &quot;Implementing Spectral Element</span>
<a name="ln-50"></a><span class="c">!!    Methods for Scientists and Engineers&quot;</span>
<a name="ln-51"></a><span class="c">!!</span>
<a name="ln-52"></a><span class="c">!! &lt;H2&gt; Usage : &lt;/H2&gt;</span>
<a name="ln-53"></a><span class="c">!! &lt;B&gt;Logical&lt;/B&gt; :: AisB &lt;BR&gt;</span>
<a name="ln-54"></a><span class="c">!! &lt;B&gt;REAL&lt;/B&gt;(prec) :: a, b &lt;BR&gt;</span>
<a name="ln-55"></a><span class="c">!!         .... &lt;BR&gt;</span>
<a name="ln-56"></a><span class="c">!!     AisB = AlmostEqual( a, b ) &lt;BR&gt;</span>
<a name="ln-57"></a><span class="c">!!</span>
<a name="ln-58"></a><span class="c">!!  &lt;H2&gt; Parameters : &lt;/H2&gt;</span>
<a name="ln-59"></a><span class="c">!!  &lt;table&gt;</span>
<a name="ln-60"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; a &lt;td&gt; REAL(prec) &lt;td&gt; scalar</span>
<a name="ln-61"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; b &lt;td&gt; REAL(prec) &lt;td&gt; scalar</span>
<a name="ln-62"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; AisB &lt;td&gt; Logical &lt;td&gt;</span>
<a name="ln-63"></a><span class="c">!!                     &lt;B&gt;.TRUE.&lt;/B&gt; IF a=b to machine precision &lt;BR&gt;</span>
<a name="ln-64"></a><span class="c">!!                     &lt;B&gt;.FALSE.&lt;/B&gt; otherwise</span>
<a name="ln-65"></a><span class="c">!!  &lt;/table&gt;</span>
<a name="ln-66"></a><span class="c">!!</span>
<a name="ln-67"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-68"></a><span class="c">!&gt;@}</span>
<a name="ln-69"></a>
<a name="ln-70"></a>  <span class="k">FUNCTION </span><span class="n">AlmostEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">AisB</span><span class="p">)</span>
<a name="ln-71"></a>
<a name="ln-72"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-73"></a><span class="k">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">real64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span>
<a name="ln-74"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">AisB</span>
<a name="ln-75"></a>
<a name="ln-76"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="mf">0.0_real64</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">b</span> <span class="o">==</span> <span class="mf">0.0_real64</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-77"></a><span class="k">      IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">EPSILON</span><span class="p">(</span><span class="mf">1.0_real64</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-78"></a><span class="k">        </span><span class="n">AisB</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-79"></a>      <span class="k">ELSE</span>
<a name="ln-80"></a><span class="k">        </span><span class="n">AisB</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-81"></a>      <span class="k">END IF</span>
<a name="ln-82"></a><span class="k">    ELSE</span>
<a name="ln-83"></a><span class="k">      IF</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">EPSILON</span><span class="p">(</span><span class="mf">1.0_real64</span><span class="p">)</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">EPSILON</span><span class="p">(</span><span class="mf">1.0_real64</span><span class="p">)</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">b</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-84"></a><span class="k">        </span><span class="n">AisB</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-85"></a>      <span class="k">ELSE</span>
<a name="ln-86"></a><span class="k">        </span><span class="n">AisB</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-87"></a>      <span class="k">END IF</span>
<a name="ln-88"></a><span class="k">    END IF</span>
<a name="ln-89"></a>
<a name="ln-90"></a><span class="k">  END FUNCTION </span><span class="n">AlmostEqual</span>
<a name="ln-91"></a><span class="c">!</span>
<a name="ln-92"></a><span class="c">!&gt; \addtogroup SELF_SupportRoutines</span>
<a name="ln-93"></a><span class="c">!! @{</span>
<a name="ln-94"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-95"></a><span class="c">! S/R InsertionSort</span>
<a name="ln-96"></a><span class="c">!</span>
<a name="ln-97"></a><span class="c">!&gt; \fn InsertionSort</span>
<a name="ln-98"></a><span class="c">!! Sorts an array of integers from smallest to largest using the insertion-sort algorithm.</span>
<a name="ln-99"></a><span class="c">!!</span>
<a name="ln-100"></a><span class="c">!! &lt;H2&gt; Usage : &lt;/H2&gt;</span>
<a name="ln-101"></a><span class="c">!! &lt;B&gt;INTEGER&lt;/B&gt; :: N &lt;BR&gt;</span>
<a name="ln-102"></a><span class="c">!! &lt;B&gt;INTEGER&lt;/B&gt; :: inArray(1:N) &lt;BR&gt;</span>
<a name="ln-103"></a><span class="c">!! &lt;B&gt;INTEGER&lt;/B&gt; :: outArray(1:N) &lt;BR&gt;</span>
<a name="ln-104"></a><span class="c">!!         .... &lt;BR&gt;</span>
<a name="ln-105"></a><span class="c">!!     &lt;B&gt;CALL&lt;/B&gt; InsertionSort( inArray, outArray, N ) &lt;BR&gt;</span>
<a name="ln-106"></a><span class="c">!!</span>
<a name="ln-107"></a><span class="c">!!  &lt;H2&gt; Parameters : &lt;/H2&gt;</span>
<a name="ln-108"></a><span class="c">!!  &lt;table&gt;</span>
<a name="ln-109"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; N &lt;td&gt; INTEGER &lt;td&gt;</span>
<a name="ln-110"></a><span class="c">!!                     The number of elements in the input and output arrays</span>
<a name="ln-111"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; inArray(1:N) &lt;td&gt; INTEGER &lt;td&gt;</span>
<a name="ln-112"></a><span class="c">!!                     Array of unsorted integers.</span>
<a name="ln-113"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; out &lt;th&gt; outArray &lt;td&gt; INTEGER &lt;td&gt;</span>
<a name="ln-114"></a><span class="c">!!                      Array of integers, sorted from most negative to most positive numbers.</span>
<a name="ln-115"></a><span class="c">!!  &lt;/table&gt;</span>
<a name="ln-116"></a><span class="c">!!</span>
<a name="ln-117"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-118"></a><span class="c">!&gt;@}</span>
<a name="ln-119"></a>  <span class="k">SUBROUTINE </span><span class="n">InsertionSort</span><span class="p">(</span><span class="n">inArray</span><span class="p">,</span><span class="n">outArray</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<a name="ln-120"></a>
<a name="ln-121"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-122"></a><span class="k">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">N</span>
<a name="ln-123"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">inArray</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">)</span>
<a name="ln-124"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">outArray</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">)</span>
<a name="ln-125"></a>    <span class="c">! LOCAL</span>
<a name="ln-126"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span>
<a name="ln-127"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">temp</span>
<a name="ln-128"></a>
<a name="ln-129"></a>    <span class="n">outArray</span> <span class="o">=</span> <span class="n">inArray</span>
<a name="ln-130"></a>
<a name="ln-131"></a>    <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="n">N</span>
<a name="ln-132"></a>      <span class="n">j</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-133"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-134"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">outArray</span><span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">outArray</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-135"></a>          <span class="c">!Swap outArray(j) outArray(j-1)</span>
<a name="ln-136"></a>          <span class="n">temp</span> <span class="o">=</span> <span class="n">outArray</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-137"></a>          <span class="n">outArray</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">outArray</span><span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-138"></a>          <span class="n">outArray</span><span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp</span>
<a name="ln-139"></a>          <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-140"></a>        <span class="k">ELSE</span>
<a name="ln-141"></a><span class="k">          EXIT</span>
<a name="ln-142"></a><span class="k">        END IF</span>
<a name="ln-143"></a><span class="k">      END DO</span>
<a name="ln-144"></a><span class="k">    END DO</span>
<a name="ln-145"></a>
<a name="ln-146"></a><span class="k">  END SUBROUTINE </span><span class="n">InsertionSort</span>
<a name="ln-147"></a><span class="c">!</span>
<a name="ln-148"></a><span class="c">!&gt; \addtogroup SELF_SupportRoutines</span>
<a name="ln-149"></a><span class="c">!! @{</span>
<a name="ln-150"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-151"></a><span class="c">! S/R SortArray</span>
<a name="ln-152"></a><span class="c">!</span>
<a name="ln-153"></a><span class="c">!&gt; \fn SortArray</span>
<a name="ln-154"></a><span class="c">!! Sorts a REAL(prec) array from smallest absolute value to largest absolute value.</span>
<a name="ln-155"></a><span class="c">!!</span>
<a name="ln-156"></a><span class="c">!! &lt;H2&gt; Usage : &lt;/H2&gt;</span>
<a name="ln-157"></a><span class="c">!! &lt;B&gt;REAL&lt;/B&gt;(prec) :: myArray(low:high) &lt;BR&gt;</span>
<a name="ln-158"></a><span class="c">!! &lt;B&gt;INTEGER&lt;/B&gt;    :: low, high &lt;BR&gt;</span>
<a name="ln-159"></a><span class="c">!!         .... &lt;BR&gt;</span>
<a name="ln-160"></a><span class="c">!!     &lt;B&gt;CALL&lt;/B&gt; SortArray( myArray, low, high ) &lt;BR&gt;</span>
<a name="ln-161"></a><span class="c">!!</span>
<a name="ln-162"></a><span class="c">!!  &lt;H2&gt; Parameters : &lt;/H2&gt;</span>
<a name="ln-163"></a><span class="c">!!  &lt;table&gt;</span>
<a name="ln-164"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in/out &lt;th&gt; myArray(low:high) &lt;td&gt; REAL(prec) &lt;td&gt;</span>
<a name="ln-165"></a><span class="c">!!                         On &lt;B&gt;input&lt;/B&gt; Unsorted array of floating point values &lt;BR&gt;</span>
<a name="ln-166"></a><span class="c">!!                         On &lt;B&gt;output&lt;/B&gt; Sorted array of floating point values, arranged in order</span>
<a name="ln-167"></a><span class="c">!!                         of increasing absolute value.</span>
<a name="ln-168"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; low &lt;td&gt; INTEGER &lt;td&gt;</span>
<a name="ln-169"></a><span class="c">!!                     Lower bound of the input and output arrays</span>
<a name="ln-170"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; high &lt;td&gt; INTEGER &lt;td&gt;</span>
<a name="ln-171"></a><span class="c">!!                     Upper bound of the input and output arrays</span>
<a name="ln-172"></a><span class="c">!!  &lt;/table&gt;</span>
<a name="ln-173"></a><span class="c">!!</span>
<a name="ln-174"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-175"></a><span class="c">!&gt;@}</span>
<a name="ln-176"></a>  <span class="k">SUBROUTINE </span><span class="n">SortArray</span><span class="p">(</span><span class="n">myArray</span><span class="p">,</span><span class="n">low</span><span class="p">,</span><span class="n">high</span><span class="p">)</span>
<a name="ln-177"></a>
<a name="ln-178"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-179"></a><span class="k">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">low</span><span class="p">,</span><span class="n">high</span>
<a name="ln-180"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myArray</span><span class="p">(</span><span class="n">low</span><span class="p">:</span><span class="n">high</span><span class="p">)</span>
<a name="ln-181"></a>    <span class="c">! LOCAL</span>
<a name="ln-182"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">locOfMin</span>
<a name="ln-183"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ind</span>
<a name="ln-184"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">temp</span>
<a name="ln-185"></a>
<a name="ln-186"></a>    <span class="k">DO </span><span class="n">ind</span> <span class="o">=</span> <span class="n">low</span><span class="p">,</span><span class="n">high</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-187"></a>      <span class="n">locOfMin</span> <span class="o">=</span> <span class="nb">MINLOC</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">myArray</span><span class="p">(</span><span class="n">ind</span><span class="p">:</span><span class="n">high</span><span class="p">)),</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">low</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ind</span>
<a name="ln-188"></a>      <span class="n">temp</span> <span class="o">=</span> <span class="n">myArray</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
<a name="ln-189"></a>      <span class="n">myArray</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="o">=</span> <span class="n">myArray</span><span class="p">(</span><span class="n">locOfMin</span><span class="p">)</span>
<a name="ln-190"></a>      <span class="n">myArray</span><span class="p">(</span><span class="n">locOfMin</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp</span>
<a name="ln-191"></a>    <span class="k">END DO</span>
<a name="ln-192"></a>
<a name="ln-193"></a><span class="k">  END SUBROUTINE </span><span class="n">SortArray</span>
<a name="ln-194"></a><span class="c">!</span>
<a name="ln-195"></a><span class="c">!&gt; \addtogroup SELF_SupportRoutines</span>
<a name="ln-196"></a><span class="c">!! @{</span>
<a name="ln-197"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-198"></a><span class="c">! S/R SortAndSum</span>
<a name="ln-199"></a><span class="c">!</span>
<a name="ln-200"></a><span class="c">!&gt; \fn SortAndSum</span>
<a name="ln-201"></a><span class="c">!! Computes the sum of an array by first sorting the array from smallest absolute value to largest</span>
<a name="ln-202"></a><span class="c">!! absolute value.</span>
<a name="ln-203"></a><span class="c">!!</span>
<a name="ln-204"></a><span class="c">!! When computing the sum of an array of floating point values, round-off errors can be reduced</span>
<a name="ln-205"></a><span class="c">!! by adding from the smallest to largest values. &lt;BR&gt;</span>
<a name="ln-206"></a><span class="c">!!</span>
<a name="ln-207"></a><span class="c">!! This subroutine depends on &lt;BR&gt;</span>
<a name="ln-208"></a><span class="c">!!    Subroutine \ref sortarray</span>
<a name="ln-209"></a><span class="c">!!</span>
<a name="ln-210"></a><span class="c">!! &lt;H2&gt; Usage : &lt;/H2&gt;</span>
<a name="ln-211"></a><span class="c">!! &lt;B&gt;REAL&lt;/B&gt;(prec) :: myArray(low:high) &lt;BR&gt;</span>
<a name="ln-212"></a><span class="c">!! &lt;B&gt;REAL&lt;/B&gt;(prec) :: arraySum &lt;BR&gt;</span>
<a name="ln-213"></a><span class="c">!! &lt;B&gt;INTEGER&lt;/B&gt;    :: low, high &lt;BR&gt;</span>
<a name="ln-214"></a><span class="c">!!         .... &lt;BR&gt;</span>
<a name="ln-215"></a><span class="c">!!     &lt;B&gt;CALL&lt;/B&gt; SortAndSum( myArray, low, high, arraySum ) &lt;BR&gt;</span>
<a name="ln-216"></a><span class="c">!!</span>
<a name="ln-217"></a><span class="c">!!  &lt;H2&gt; Parameters : &lt;/H2&gt;</span>
<a name="ln-218"></a><span class="c">!!  &lt;table&gt;</span>
<a name="ln-219"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in/out &lt;th&gt; myArray(low:high) &lt;td&gt; REAL(prec) &lt;td&gt;</span>
<a name="ln-220"></a><span class="c">!!                         On &lt;B&gt;input&lt;/B&gt; Unsorted array of floating point values &lt;BR&gt;</span>
<a name="ln-221"></a><span class="c">!!                         On &lt;B&gt;output&lt;/B&gt; Sorted array of floating point values, arranged in order</span>
<a name="ln-222"></a><span class="c">!!                         of increasing absolute value.</span>
<a name="ln-223"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; low &lt;td&gt; INTEGER &lt;td&gt;</span>
<a name="ln-224"></a><span class="c">!!                     Lower bound of the input and output arrays</span>
<a name="ln-225"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; high &lt;td&gt; INTEGER &lt;td&gt;</span>
<a name="ln-226"></a><span class="c">!!                     Upper bound of the input and output arrays</span>
<a name="ln-227"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; out &lt;th&gt; arraySum &lt;td&gt; REAL(prec) &lt;td&gt;</span>
<a name="ln-228"></a><span class="c">!!                     Sum of the array components.</span>
<a name="ln-229"></a><span class="c">!!  &lt;/table&gt;</span>
<a name="ln-230"></a><span class="c">!!</span>
<a name="ln-231"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-232"></a><span class="c">!&gt;@}</span>
<a name="ln-233"></a>  <span class="k">SUBROUTINE </span><span class="n">SortAndSum</span><span class="p">(</span><span class="n">myArray</span><span class="p">,</span><span class="n">low</span><span class="p">,</span><span class="n">high</span><span class="p">,</span><span class="n">arraysum</span><span class="p">)</span>
<a name="ln-234"></a>
<a name="ln-235"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-236"></a><span class="k">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">low</span><span class="p">,</span><span class="n">high</span>
<a name="ln-237"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myArray</span><span class="p">(</span><span class="n">low</span><span class="p">:</span><span class="n">high</span><span class="p">)</span>
<a name="ln-238"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">arraysum</span>
<a name="ln-239"></a>    <span class="c">! LOCAL</span>
<a name="ln-240"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ind</span>
<a name="ln-241"></a>
<a name="ln-242"></a>    <span class="k">CALL </span><span class="n">SortArray</span><span class="p">(</span><span class="n">myArray</span><span class="p">,</span><span class="n">low</span><span class="p">,</span><span class="n">high</span><span class="p">)</span>
<a name="ln-243"></a>    <span class="n">arraysum</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-244"></a>    <span class="k">DO </span><span class="n">ind</span> <span class="o">=</span> <span class="n">low</span><span class="p">,</span><span class="n">high</span>
<a name="ln-245"></a>      <span class="n">arraysum</span> <span class="o">=</span> <span class="n">arraysum</span> <span class="o">+</span> <span class="n">myArray</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
<a name="ln-246"></a>    <span class="k">END DO</span>
<a name="ln-247"></a>
<a name="ln-248"></a><span class="k">  END SUBROUTINE </span><span class="n">SortAndSum</span>
<a name="ln-249"></a><span class="c">!</span>
<a name="ln-250"></a><span class="c">!&gt; \addtogroup SELF_SupportRoutines</span>
<a name="ln-251"></a><span class="c">!! @{</span>
<a name="ln-252"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-253"></a><span class="c">! S/R ReverseArray</span>
<a name="ln-254"></a><span class="c">!</span>
<a name="ln-255"></a><span class="c">!&gt; \fn ReverseArray</span>
<a name="ln-256"></a><span class="c">!! Reverses the order of a REAL(prec) array.</span>
<a name="ln-257"></a><span class="c">!!</span>
<a name="ln-258"></a><span class="c">!! &lt;H2&gt; Usage : &lt;/H2&gt;</span>
<a name="ln-259"></a><span class="c">!! &lt;B&gt;REAL&lt;/B&gt;(prec) :: myArray(low:high) &lt;BR&gt;</span>
<a name="ln-260"></a><span class="c">!! &lt;B&gt;INTEGER&lt;/B&gt;    :: low, high &lt;BR&gt;</span>
<a name="ln-261"></a><span class="c">!!         .... &lt;BR&gt;</span>
<a name="ln-262"></a><span class="c">!!     &lt;B&gt;CALL&lt;/B&gt; ReverseArray( myArray, low, high ) &lt;BR&gt;</span>
<a name="ln-263"></a><span class="c">!!</span>
<a name="ln-264"></a><span class="c">!!  &lt;H2&gt; Parameters : &lt;/H2&gt;</span>
<a name="ln-265"></a><span class="c">!!  &lt;table&gt;</span>
<a name="ln-266"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in/out &lt;th&gt; myArray(low:high) &lt;td&gt; REAL(prec) &lt;td&gt;</span>
<a name="ln-267"></a><span class="c">!!                         On &lt;B&gt;output&lt;/B&gt;, the input array in reverse order .</span>
<a name="ln-268"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; low &lt;td&gt; INTEGER &lt;td&gt;</span>
<a name="ln-269"></a><span class="c">!!                     Lower bound of the input and output arrays</span>
<a name="ln-270"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; high &lt;td&gt; INTEGER &lt;td&gt;</span>
<a name="ln-271"></a><span class="c">!!                     Upper bound of the input and output arrays</span>
<a name="ln-272"></a><span class="c">!!  &lt;/table&gt;</span>
<a name="ln-273"></a><span class="c">!!</span>
<a name="ln-274"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-275"></a><span class="c">!&gt;@}</span>
<a name="ln-276"></a>
<a name="ln-277"></a>  <span class="k">SUBROUTINE </span><span class="n">ReverseArray</span><span class="p">(</span><span class="n">myArray</span><span class="p">,</span><span class="n">low</span><span class="p">,</span><span class="n">high</span><span class="p">)</span>
<a name="ln-278"></a>
<a name="ln-279"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-280"></a><span class="k">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">low</span><span class="p">,</span><span class="n">high</span>
<a name="ln-281"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myArray</span><span class="p">(</span><span class="n">low</span><span class="p">:</span><span class="n">high</span><span class="p">)</span>
<a name="ln-282"></a>    <span class="c">! LOCAL</span>
<a name="ln-283"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">temp</span><span class="p">(</span><span class="n">low</span><span class="p">:</span><span class="n">high</span><span class="p">)</span>
<a name="ln-284"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span>
<a name="ln-285"></a>
<a name="ln-286"></a>    <span class="n">temp</span> <span class="o">=</span> <span class="n">myArray</span>
<a name="ln-287"></a>    <span class="n">j</span> <span class="o">=</span> <span class="n">high</span>
<a name="ln-288"></a>    <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="n">low</span><span class="p">,</span><span class="n">high</span>
<a name="ln-289"></a>      <span class="n">myArray</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-290"></a>      <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-291"></a>    <span class="k">END DO</span>
<a name="ln-292"></a>
<a name="ln-293"></a><span class="k">  END SUBROUTINE </span><span class="n">ReverseArray</span>
<a name="ln-294"></a><span class="c">!</span>
<a name="ln-295"></a><span class="c">!&gt; \addtogroup SELF_SupportRoutines</span>
<a name="ln-296"></a><span class="c">!! @{</span>
<a name="ln-297"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-298"></a><span class="c">! S/R ForwardShift</span>
<a name="ln-299"></a><span class="c">!</span>
<a name="ln-300"></a><span class="c">!&gt; \fn ForwardShift</span>
<a name="ln-301"></a><span class="c">!! Shift an array integers by one index forward, moving the last index to the first.</span>
<a name="ln-302"></a><span class="c">!!</span>
<a name="ln-303"></a><span class="c">!! Shifts the array entries as follows : &lt;BR&gt;</span>
<a name="ln-304"></a><span class="c">!!  myArray(1) &lt;-- myArray(N) &lt;BR&gt;</span>
<a name="ln-305"></a><span class="c">!!  myArray(2) &lt;-- myArray(1) &lt;BR&gt;</span>
<a name="ln-306"></a><span class="c">!!  myArray(3) &lt;-- myArray(2) &lt;BR&gt;</span>
<a name="ln-307"></a><span class="c">!!</span>
<a name="ln-308"></a><span class="c">!! &lt;H2&gt; Usage : &lt;/H2&gt;</span>
<a name="ln-309"></a><span class="c">!! &lt;B&gt;INTEGER&lt;/B&gt; :: N</span>
<a name="ln-310"></a><span class="c">!! &lt;B&gt;INTEGER&lt;/B&gt; :: myArray(1:N) &lt;BR&gt;</span>
<a name="ln-311"></a><span class="c">!!         .... &lt;BR&gt;</span>
<a name="ln-312"></a><span class="c">!!     &lt;B&gt;CALL&lt;/B&gt; ForwardShift( myArray, N ) &lt;BR&gt;</span>
<a name="ln-313"></a><span class="c">!!</span>
<a name="ln-314"></a><span class="c">!!  &lt;H2&gt; Parameters : &lt;/H2&gt;</span>
<a name="ln-315"></a><span class="c">!!  &lt;table&gt;</span>
<a name="ln-316"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in/out &lt;th&gt; myArray(1:N) &lt;td&gt; INTEGER &lt;td&gt;</span>
<a name="ln-317"></a><span class="c">!!                         On &lt;B&gt;output&lt;/B&gt;, the input array with elements shifted forward by</span>
<a name="ln-318"></a><span class="c">!!                         one index.</span>
<a name="ln-319"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; N &lt;td&gt; INTEGER &lt;td&gt;</span>
<a name="ln-320"></a><span class="c">!!                     The number of elements in the array</span>
<a name="ln-321"></a><span class="c">!!  &lt;/table&gt;</span>
<a name="ln-322"></a><span class="c">!!</span>
<a name="ln-323"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-324"></a><span class="c">!&gt;@}</span>
<a name="ln-325"></a>  <span class="k">SUBROUTINE </span><span class="n">ForwardShift</span><span class="p">(</span><span class="n">myArray</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<a name="ln-326"></a>
<a name="ln-327"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-328"></a><span class="k">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">N</span>
<a name="ln-329"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myArray</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">)</span>
<a name="ln-330"></a>    <span class="c">! LOCAL</span>
<a name="ln-331"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">temp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">)</span>
<a name="ln-332"></a>
<a name="ln-333"></a>    <span class="n">temp</span> <span class="o">=</span> <span class="n">myArray</span>
<a name="ln-334"></a>    <span class="n">myArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-335"></a>    <span class="n">myArray</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-336"></a>
<a name="ln-337"></a>  <span class="k">END SUBROUTINE </span><span class="n">ForwardShift</span>
<a name="ln-338"></a><span class="c">!</span>
<a name="ln-339"></a><span class="c">!&gt; \addtogroup SELF_SupportRoutines</span>
<a name="ln-340"></a><span class="c">!! @{</span>
<a name="ln-341"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-342"></a><span class="c">! S/R CompareArray</span>
<a name="ln-343"></a><span class="c">!</span>
<a name="ln-344"></a><span class="c">!&gt; \fn CompareArray</span>
<a name="ln-345"></a><span class="c">!! Compares to INTEGER arrays and determines if they are identical.</span>
<a name="ln-346"></a><span class="c">!!</span>
<a name="ln-347"></a><span class="c">!! A logical is returned that specifies whether or not two arrays are identical. To determine</span>
<a name="ln-348"></a><span class="c">!! if the two arrays are identical, the sum of the difference between each element in the input</span>
<a name="ln-349"></a><span class="c">!! array is calculated. If the arrays are identical, each contribution to the sum is zero and hence</span>
<a name="ln-350"></a><span class="c">!! the sum is zero. If the sum is non-zero, the arrays are distinct.</span>
<a name="ln-351"></a><span class="c">!!</span>
<a name="ln-352"></a><span class="c">!! This routine is used in the \ref HexMeshClass module. A face of an element in an unstructured</span>
<a name="ln-353"></a><span class="c">!! mesh is identified by its four corner nodes. When identifying unique faces in an unstructured</span>
<a name="ln-354"></a><span class="c">!! mesh, we need to determine if two elements share a face. This can be accomplished by comparing</span>
<a name="ln-355"></a><span class="c">!! the four corner nodes (from each element) that define each face.</span>
<a name="ln-356"></a><span class="c">!!</span>
<a name="ln-357"></a><span class="c">!! &lt;H2&gt; Usage : &lt;/H2&gt;</span>
<a name="ln-358"></a><span class="c">!! &lt;B&gt;INTEGER&lt;/B&gt; :: N &lt;BR&gt;</span>
<a name="ln-359"></a><span class="c">!! &lt;B&gt;INTEGER&lt;/B&gt; :: arrayOne(1:N) &lt;BR&gt;</span>
<a name="ln-360"></a><span class="c">!! &lt;B&gt;INTEGER&lt;/B&gt; :: arrayTwo(1:N) &lt;BR&gt;</span>
<a name="ln-361"></a><span class="c">!! &lt;B&gt;LOGICAL&lt;/B&gt; :: arraysMatch &lt;BR&gt;</span>
<a name="ln-362"></a><span class="c">!!         .... &lt;BR&gt;</span>
<a name="ln-363"></a><span class="c">!!     arraysMatch = CompareArray( arrayOne, arrayTwo, N ) &lt;BR&gt;</span>
<a name="ln-364"></a><span class="c">!!  &lt;H2&gt; Parameters : &lt;/H2&gt;</span>
<a name="ln-365"></a><span class="c">!!  &lt;table&gt;</span>
<a name="ln-366"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; arrayOne(1:N) &lt;td&gt; INTEGER &lt;td&gt;</span>
<a name="ln-367"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; arrayTwo(1:N) &lt;td&gt; INTEGER &lt;td&gt;</span>
<a name="ln-368"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; N &lt;td&gt; INTEGER &lt;td&gt;</span>
<a name="ln-369"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; out &lt;th&gt; arraysMatch &lt;td&gt; INTEGER &lt;td&gt;</span>
<a name="ln-370"></a><span class="c">!!</span>
<a name="ln-371"></a><span class="c">!!  &lt;/table&gt;</span>
<a name="ln-372"></a><span class="c">!!</span>
<a name="ln-373"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-374"></a><span class="c">!&gt;@}</span>
<a name="ln-375"></a>
<a name="ln-376"></a>  <span class="k">FUNCTION </span><span class="n">CompareArray</span><span class="p">(</span><span class="n">arrayOne</span><span class="p">,</span><span class="n">arrayTwo</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">arraysMatch</span><span class="p">)</span>
<a name="ln-377"></a>
<a name="ln-378"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-379"></a><span class="k">    </span><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-380"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">arrayOne</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">),</span><span class="n">arrayTwo</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">)</span>
<a name="ln-381"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">arraysMatch</span>
<a name="ln-382"></a>    <span class="c">! LOCAL</span>
<a name="ln-383"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">theSumOfDiffs</span>
<a name="ln-384"></a>
<a name="ln-385"></a>    <span class="n">theSumOfDiffs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-386"></a>
<a name="ln-387"></a>    <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">N</span>
<a name="ln-388"></a>      <span class="n">theSumOfDiffs</span> <span class="o">=</span> <span class="n">theSumOfDiffs</span> <span class="o">+</span> <span class="n">arrayOne</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">arrayTwo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-389"></a>    <span class="k">END DO</span>
<a name="ln-390"></a>
<a name="ln-391"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">theSumOfDiffs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-392"></a><span class="k">      </span><span class="n">arraysMatch</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-393"></a>    <span class="k">ELSE</span>
<a name="ln-394"></a><span class="k">      </span><span class="n">arraysMatch</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-395"></a>    <span class="k">END IF</span>
<a name="ln-396"></a>
<a name="ln-397"></a><span class="k">  END FUNCTION </span><span class="n">CompareArray</span>
<a name="ln-398"></a><span class="c">!</span>
<a name="ln-399"></a><span class="c">!&gt; \addtogroup SELF_SupportRoutines</span>
<a name="ln-400"></a><span class="c">!! @{</span>
<a name="ln-401"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-402"></a><span class="c">! S/R NewUnit</span>
<a name="ln-403"></a><span class="c">!</span>
<a name="ln-404"></a><span class="c">!&gt; \fn NewUnit</span>
<a name="ln-405"></a><span class="c">!! Returns a file unit identifier that is currently not in use.</span>
<a name="ln-406"></a><span class="c">!!</span>
<a name="ln-407"></a><span class="c">!!</span>
<a name="ln-408"></a><span class="c">!! &lt;H2&gt; Usage : &lt;/H2&gt;</span>
<a name="ln-409"></a><span class="c">!! &lt;B&gt;INTEGER&lt;/B&gt; :: thisUnit &lt;BR&gt;</span>
<a name="ln-410"></a><span class="c">!!         .... &lt;BR&gt;</span>
<a name="ln-411"></a><span class="c">!!     &lt;B&gt;OPEN&lt;/B&gt;( UNIT=NewUnit(thisUnit), FILE=filename) &lt;BR&gt;</span>
<a name="ln-412"></a><span class="c">!!</span>
<a name="ln-413"></a><span class="c">!!  &lt;H2&gt; Parameters : &lt;/H2&gt;</span>
<a name="ln-414"></a><span class="c">!!  &lt;table&gt;</span>
<a name="ln-415"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; out &lt;th&gt; thisunit &lt;td&gt; INTEGER &lt;td&gt; File unit that is not in use</span>
<a name="ln-416"></a><span class="c">!!  &lt;/table&gt;</span>
<a name="ln-417"></a><span class="c">!!</span>
<a name="ln-418"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-419"></a><span class="c">!&gt;@}</span>
<a name="ln-420"></a>
<a name="ln-421"></a>  <span class="kt">INTEGER </span><span class="k">FUNCTION </span><span class="n">NewUnit</span><span class="p">(</span><span class="n">thisunit</span><span class="p">)</span>
<a name="ln-422"></a>
<a name="ln-423"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-424"></a><span class="k">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">thisunit</span>
<a name="ln-425"></a>    <span class="c">! Local</span>
<a name="ln-426"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">unitMin</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span><span class="n">unitMax</span> <span class="o">=</span> <span class="mi">1000</span>
<a name="ln-427"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">isopened</span>
<a name="ln-428"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iUnit</span>
<a name="ln-429"></a>
<a name="ln-430"></a>    <span class="n">newunit</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-431"></a>
<a name="ln-432"></a>    <span class="k">DO </span><span class="n">iUnit</span> <span class="o">=</span> <span class="n">unitMin</span><span class="p">,</span><span class="n">unitMax</span>
<a name="ln-433"></a>      <span class="c">! Check to see IF this UNIT is opened</span>
<a name="ln-434"></a>      <span class="k">INQUIRE</span> <span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">iUnit</span><span class="p">,</span><span class="n">opened</span><span class="o">=</span><span class="n">isopened</span><span class="p">)</span>
<a name="ln-435"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">isopened</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-436"></a><span class="k">        </span><span class="n">newunit</span> <span class="o">=</span> <span class="n">iUnit</span>
<a name="ln-437"></a>        <span class="k">EXIT</span>
<a name="ln-438"></a><span class="k">      END IF</span>
<a name="ln-439"></a><span class="k">    END DO</span>
<a name="ln-440"></a>
<a name="ln-441"></a><span class="k">    IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">thisunit</span><span class="p">))</span> <span class="n">thisunit</span> <span class="o">=</span> <span class="n">newunit</span>
<a name="ln-442"></a>
<a name="ln-443"></a>  <span class="k">END FUNCTION </span><span class="n">NewUnit</span>
<a name="ln-444"></a><span class="c">!</span>
<a name="ln-445"></a><span class="c">!&gt; \addtogroup SELF_SupportRoutines</span>
<a name="ln-446"></a><span class="c">!! @{</span>
<a name="ln-447"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-448"></a><span class="c">! S/R UniformPoints</span>
<a name="ln-449"></a><span class="c">!</span>
<a name="ln-450"></a><span class="c">!&gt; \fn UniformPoints</span>
<a name="ln-451"></a><span class="c">!! Generates a REAL(prec) array of N points evenly spaced between two points.</span>
<a name="ln-452"></a><span class="c">!!</span>
<a name="ln-453"></a><span class="c">!!</span>
<a name="ln-454"></a><span class="c">!! &lt;H2&gt; Usage : &lt;/H2&gt;</span>
<a name="ln-455"></a><span class="c">!! &lt;B&gt;REAL&lt;/B&gt;(prec) :: a &lt;BR&gt;</span>
<a name="ln-456"></a><span class="c">!! &lt;B&gt;REAL&lt;/B&gt;(prec) :: b &lt;BR&gt;</span>
<a name="ln-457"></a><span class="c">!! &lt;B&gt;REAL&lt;/B&gt;(prec) :: xU(0:N) &lt;BR&gt;</span>
<a name="ln-458"></a><span class="c">!! &lt;B&gt;INTEGER&lt;/B&gt; :: N &lt;BR&gt;</span>
<a name="ln-459"></a><span class="c">!!         .... &lt;BR&gt;</span>
<a name="ln-460"></a><span class="c">!!     xU = UniformPoints( a, b, N ) &lt;BR&gt;</span>
<a name="ln-461"></a><span class="c">!!</span>
<a name="ln-462"></a><span class="c">!!  &lt;H2&gt; Parameters : &lt;/H2&gt;</span>
<a name="ln-463"></a><span class="c">!!  &lt;table&gt;</span>
<a name="ln-464"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; a &lt;td&gt; REAL(prec) &lt;td&gt; Starting point of the interval</span>
<a name="ln-465"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; b &lt;td&gt; REAL(prec) &lt;td&gt; Ending point of the interval</span>
<a name="ln-466"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; N &lt;td&gt; INTEGER &lt;td&gt; The number of points in the interval \f$[a,b]\f$</span>
<a name="ln-467"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; xU(0:N) &lt;td&gt; REAL(prec) &lt;td&gt;</span>
<a name="ln-468"></a><span class="c">!!                     Array of evenly spaced points in the interval \f$[a,b]\f$</span>
<a name="ln-469"></a><span class="c">!!  &lt;/table&gt;</span>
<a name="ln-470"></a><span class="c">!!</span>
<a name="ln-471"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-472"></a><span class="c">!&gt;@}</span>
<a name="ln-473"></a>
<a name="ln-474"></a>  <span class="k">FUNCTION </span><span class="n">UniformPoints</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">firstInd</span><span class="p">,</span><span class="n">lastInd</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">xU</span><span class="p">)</span>
<a name="ln-475"></a>
<a name="ln-476"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-477"></a><span class="k">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span>
<a name="ln-478"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">firstInd</span><span class="p">,</span><span class="n">lastInd</span>
<a name="ln-479"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xU</span><span class="p">(</span><span class="n">firstInd</span><span class="p">:</span><span class="n">lastInd</span><span class="p">)</span>
<a name="ln-480"></a>    <span class="c">! LOCAL</span>
<a name="ln-481"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">dx</span>
<a name="ln-482"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-483"></a>
<a name="ln-484"></a>    <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">((</span><span class="n">lastInd</span> <span class="o">-</span> <span class="n">firstInd</span><span class="p">),</span><span class="n">prec</span><span class="p">)</span>
<a name="ln-485"></a>
<a name="ln-486"></a>    <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="n">firstInd</span><span class="p">,</span><span class="n">lastInd</span>
<a name="ln-487"></a>
<a name="ln-488"></a>      <span class="n">xU</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">firstInd</span><span class="p">,</span><span class="n">prec</span><span class="p">)</span>
<a name="ln-489"></a>
<a name="ln-490"></a>    <span class="k">END DO</span>
<a name="ln-491"></a>
<a name="ln-492"></a><span class="k">  END FUNCTION </span><span class="n">UniformPoints</span>
<a name="ln-493"></a><span class="c">!</span>
<a name="ln-494"></a><span class="c">!&gt; \addtogroup SELF_SupportRoutines</span>
<a name="ln-495"></a><span class="c">!! @{</span>
<a name="ln-496"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-497"></a><span class="c">! S/R Determinant</span>
<a name="ln-498"></a><span class="c">!</span>
<a name="ln-499"></a><span class="c">!&gt; \fn Determinant</span>
<a name="ln-500"></a><span class="c">!! A recursive function that calculates the determinant of an \f$ N\times N \f$ matrix.</span>
<a name="ln-501"></a><span class="c">!!</span>
<a name="ln-502"></a><span class="c">!! This function is used in the functions \ref invert_2x2 and \ref invert_3x3 &lt;BR&gt;</span>
<a name="ln-503"></a><span class="c">!!</span>
<a name="ln-504"></a><span class="c">!! This function depends on &lt;BR&gt;</span>
<a name="ln-505"></a><span class="c">!!    Function \ref getminor</span>
<a name="ln-506"></a><span class="c">!!</span>
<a name="ln-507"></a><span class="c">!! &lt;H2&gt; Usage : &lt;/H2&gt;</span>
<a name="ln-508"></a><span class="c">!! &lt;B&gt;INTEGER&lt;/B&gt; :: N</span>
<a name="ln-509"></a><span class="c">!! &lt;B&gt;REAL&lt;/B&gt;(prec) :: A(1:N,1:N), D &lt;BR&gt;</span>
<a name="ln-510"></a><span class="c">!!         .... &lt;BR&gt;</span>
<a name="ln-511"></a><span class="c">!!     D = Determinant( A, N ) &lt;BR&gt;</span>
<a name="ln-512"></a><span class="c">!!</span>
<a name="ln-513"></a><span class="c">!!  &lt;H2&gt; Parameters : &lt;/H2&gt;</span>
<a name="ln-514"></a><span class="c">!!  &lt;table&gt;</span>
<a name="ln-515"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; A(1:N,1:N) &lt;td&gt; REAL(prec) &lt;td&gt; Square matrix</span>
<a name="ln-516"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; N &lt;td&gt; INTEGER &lt;td&gt; Dimension of the matrix</span>
<a name="ln-517"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; out &lt;th&gt; detA &lt;td&gt; REAL(prec) &lt;td&gt; The determinant of the matrix</span>
<a name="ln-518"></a><span class="c">!!  &lt;/table&gt;</span>
<a name="ln-519"></a><span class="c">!!</span>
<a name="ln-520"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-521"></a><span class="c">!&gt;@}</span>
<a name="ln-522"></a>  <span class="k">RECURSIVE FUNCTION </span><span class="n">Determinant</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<a name="ln-523"></a>
<a name="ln-524"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-525"></a><span class="k">    </span><span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">N</span>
<a name="ln-526"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">)</span>
<a name="ln-527"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">D</span>
<a name="ln-528"></a>    <span class="c">! LOCAL</span>
<a name="ln-529"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-530"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">j</span>
<a name="ln-531"></a>
<a name="ln-532"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">N</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-533"></a><span class="k">      </span><span class="n">D</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-534"></a>      <span class="k">RETURN</span>
<a name="ln-535"></a><span class="k">    ELSE</span>
<a name="ln-536"></a><span class="k">      </span><span class="n">D</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-537"></a>      <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">N</span>
<a name="ln-538"></a>        <span class="n">M</span> <span class="o">=</span> <span class="n">GetMinor</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<a name="ln-539"></a>        <span class="n">D</span> <span class="o">=</span> <span class="n">D</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0_prec</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">Determinant</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-540"></a>      <span class="k">END DO</span>
<a name="ln-541"></a><span class="k">    END IF</span>
<a name="ln-542"></a>
<a name="ln-543"></a><span class="k">  END FUNCTION </span><span class="n">Determinant</span>
<a name="ln-544"></a><span class="c">!</span>
<a name="ln-545"></a><span class="c">!&gt; \addtogroup SELF_SupportRoutines</span>
<a name="ln-546"></a><span class="c">!! @{</span>
<a name="ln-547"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-548"></a><span class="c">! Function GetMinor</span>
<a name="ln-549"></a><span class="c">!</span>
<a name="ln-550"></a><span class="c">!&gt; \fn GetMinor</span>
<a name="ln-551"></a><span class="c">!! Returns the submatrix obtained by removing a given row and column of the input matrix.</span>
<a name="ln-552"></a><span class="c">!!</span>
<a name="ln-553"></a><span class="c">!! The minor of a matrix is used in calculating the determinant of a matrix.</span>
<a name="ln-554"></a><span class="c">!!</span>
<a name="ln-555"></a><span class="c">!! &lt;H2&gt; Usage : &lt;/H2&gt;</span>
<a name="ln-556"></a><span class="c">!! &lt;B&gt;INTEGER&lt;/B&gt; :: i, j, N &lt;BR&gt;</span>
<a name="ln-557"></a><span class="c">!! &lt;B&gt;REAL&lt;/B&gt;(prec) :: A(1:N,1:N), M(1:N-1,1:N-1) &lt;BR&gt;</span>
<a name="ln-558"></a><span class="c">!!         .... &lt;BR&gt;</span>
<a name="ln-559"></a><span class="c">!!     M = GetMinor( A, i, j, N ) &lt;BR&gt;</span>
<a name="ln-560"></a><span class="c">!!</span>
<a name="ln-561"></a><span class="c">!! &lt;H2&gt; Usage : &lt;/H2&gt;</span>
<a name="ln-562"></a><span class="c">!! &lt;B&gt;TYPE&lt;/B&gt;(DataType) :: this &lt;BR&gt;</span>
<a name="ln-563"></a><span class="c">!!         .... &lt;BR&gt;</span>
<a name="ln-564"></a><span class="c">!!     &lt;B&gt;CALL&lt;/B&gt; this % RoutineName( Inputs/Outputs ) &lt;BR&gt;</span>
<a name="ln-565"></a><span class="c">!!</span>
<a name="ln-566"></a><span class="c">!!  &lt;H2&gt; Parameters : &lt;/H2&gt;</span>
<a name="ln-567"></a><span class="c">!!  &lt;table&gt;</span>
<a name="ln-568"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; A(1:N,1:N) &lt;td&gt; REAL(prec) &lt;td&gt; Square matrix</span>
<a name="ln-569"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; i &lt;td&gt; INTEGER &lt;td&gt; The row that is removed from A to form the minor of A</span>
<a name="ln-570"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; j &lt;td&gt; INTEGER &lt;td&gt; The column that is removed from A to form the minor of A</span>
<a name="ln-571"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; N &lt;td&gt; INTEGER &lt;td&gt; The dimension of A</span>
<a name="ln-572"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; M(1:N-1,1:N-1) &lt;td&gt; REAL(prec) &lt;td&gt; The (i,j) minor of A</span>
<a name="ln-573"></a><span class="c">!!  &lt;/table&gt;</span>
<a name="ln-574"></a><span class="c">!!</span>
<a name="ln-575"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-576"></a><span class="c">!&gt;@}</span>
<a name="ln-577"></a>  <span class="k">FUNCTION </span><span class="n">GetMinor</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<a name="ln-578"></a>
<a name="ln-579"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-580"></a><span class="k">    </span><span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">N</span>
<a name="ln-581"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">)</span>
<a name="ln-582"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-583"></a>    <span class="c">! LOCAL</span>
<a name="ln-584"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">row</span><span class="p">,</span><span class="n">col</span>
<a name="ln-585"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">thisRow</span><span class="p">,</span><span class="n">thisCol</span>
<a name="ln-586"></a>
<a name="ln-587"></a>    <span class="n">thisRow</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-588"></a>    <span class="k">DO </span><span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">N</span> <span class="c">! loop over the rows of A</span>
<a name="ln-589"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">row</span> <span class="o">/=</span> <span class="n">i</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-590"></a><span class="k">        </span><span class="n">thisRow</span> <span class="o">=</span> <span class="n">thisRow</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-591"></a>        <span class="n">thisCol</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-592"></a>        <span class="k">DO </span><span class="n">col</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">N</span> <span class="c">! loop over the columns of A</span>
<a name="ln-593"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">col</span> <span class="o">/=</span> <span class="n">j</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-594"></a><span class="k">            </span><span class="n">thisCol</span> <span class="o">=</span> <span class="n">thisCol</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-595"></a>            <span class="n">M</span><span class="p">(</span><span class="n">thisRow</span><span class="p">,</span><span class="n">thisCol</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)</span>
<a name="ln-596"></a>          <span class="k">END IF</span>
<a name="ln-597"></a><span class="k">        END DO</span> <span class="c">! col, loop over the columns of A</span>
<a name="ln-598"></a>      <span class="k">END IF</span>
<a name="ln-599"></a><span class="k">    END DO</span> <span class="c">! row, loop over the rows of A</span>
<a name="ln-600"></a>
<a name="ln-601"></a>  <span class="k">END FUNCTION </span><span class="n">GetMinor</span>
<a name="ln-602"></a><span class="c">!</span>
<a name="ln-603"></a><span class="c">!&gt; \addtogroup SELF_SupportRoutines</span>
<a name="ln-604"></a><span class="c">!! @{</span>
<a name="ln-605"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-606"></a><span class="c">! Function Invert_2x2</span>
<a name="ln-607"></a><span class="c">!</span>
<a name="ln-608"></a><span class="c">!&gt; \fn Invert_2x2</span>
<a name="ln-609"></a><span class="c">!!  Computes the inverse of a 2x2 matrix using Kramer&#39;s rule.</span>
<a name="ln-610"></a><span class="c">!!</span>
<a name="ln-611"></a><span class="c">!! This Function depends on &lt;BR&gt;</span>
<a name="ln-612"></a><span class="c">!! \ref determinant</span>
<a name="ln-613"></a><span class="c">!!</span>
<a name="ln-614"></a><span class="c">!! &lt;H2&gt; Usage : &lt;/H2&gt;</span>
<a name="ln-615"></a><span class="c">!! &lt;B&gt;REAL&lt;/B&gt;(prec) :: A(1:2,1:2), Ainv(1:2,1:2) &lt;BR&gt;</span>
<a name="ln-616"></a><span class="c">!!         .... &lt;BR&gt;</span>
<a name="ln-617"></a><span class="c">!!     Ainv = Invert_2x2( A ) &lt;BR&gt;</span>
<a name="ln-618"></a><span class="c">!!</span>
<a name="ln-619"></a><span class="c">!!  &lt;H2&gt; Parameters : &lt;/H2&gt;</span>
<a name="ln-620"></a><span class="c">!!  &lt;table&gt;</span>
<a name="ln-621"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; A(1:2,1:2) &lt;td&gt; REAL(prec) &lt;td&gt; Real 2x2 matrix</span>
<a name="ln-622"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; Ainv(1:2,1:2) &lt;td&gt; REAL(prec) &lt;td&gt; Real 2x2 matrix, inverse of A</span>
<a name="ln-623"></a><span class="c">!!  &lt;/table&gt;</span>
<a name="ln-624"></a><span class="c">!!</span>
<a name="ln-625"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-626"></a><span class="c">!&gt;@}</span>
<a name="ln-627"></a>  <span class="k">FUNCTION </span><span class="n">Invert_2x2</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">Ainv</span><span class="p">)</span>
<a name="ln-628"></a>
<a name="ln-629"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-630"></a><span class="k">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-631"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ainv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-632"></a>    <span class="c">! LOCAL</span>
<a name="ln-633"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">detA</span>
<a name="ln-634"></a>
<a name="ln-635"></a>    <span class="n">detA</span> <span class="o">=</span> <span class="n">Determinant</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-636"></a>
<a name="ln-637"></a>    <span class="n">Ainv</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">detA</span>
<a name="ln-638"></a>    <span class="n">Ainv</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">detA</span>
<a name="ln-639"></a>    <span class="n">Ainv</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">detA</span>
<a name="ln-640"></a>    <span class="n">Ainv</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">detA</span>
<a name="ln-641"></a>
<a name="ln-642"></a>  <span class="k">END FUNCTION </span><span class="n">Invert_2x2</span>
<a name="ln-643"></a><span class="c">!</span>
<a name="ln-644"></a><span class="c">!&gt; \addtogroup SELF_SupportRoutines</span>
<a name="ln-645"></a><span class="c">!! @{</span>
<a name="ln-646"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-647"></a><span class="c">! Function Invert_3x3</span>
<a name="ln-648"></a><span class="c">!</span>
<a name="ln-649"></a><span class="c">!&gt; \fn Invert_3x3</span>
<a name="ln-650"></a><span class="c">!!  Computes the inverse of a 3x3 matrix using Kramer&#39;s rule.</span>
<a name="ln-651"></a><span class="c">!!</span>
<a name="ln-652"></a><span class="c">!! This Function depends on &lt;BR&gt;</span>
<a name="ln-653"></a><span class="c">!! \ref determinant</span>
<a name="ln-654"></a><span class="c">!!</span>
<a name="ln-655"></a><span class="c">!! &lt;H3&gt; Usage : &lt;/H3&gt;</span>
<a name="ln-656"></a><span class="c">!! &lt;B&gt;REAL&lt;/B&gt;(prec) :: A(1:3,1:3), Ainv(1:3,1:3) &lt;BR&gt;</span>
<a name="ln-657"></a><span class="c">!!         .... &lt;BR&gt;</span>
<a name="ln-658"></a><span class="c">!!     Ainv = Invert_3x3( A ) &lt;BR&gt;</span>
<a name="ln-659"></a><span class="c">!!</span>
<a name="ln-660"></a><span class="c">!!  &lt;H3&gt; Parameters : &lt;/H3&gt;</span>
<a name="ln-661"></a><span class="c">!!  &lt;table&gt;</span>
<a name="ln-662"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; A(1:3,1:3) &lt;td&gt; REAL(prec) &lt;td&gt; Real 3x3 matrix</span>
<a name="ln-663"></a><span class="c">!!   &lt;tr&gt; &lt;td&gt; in &lt;th&gt; Ainv(1:3,1:3) &lt;td&gt; REAL(prec) &lt;td&gt; Real 3x3 matrix, inverse of A</span>
<a name="ln-664"></a><span class="c">!!  &lt;/table&gt;</span>
<a name="ln-665"></a><span class="c">!!</span>
<a name="ln-666"></a><span class="c">! ================================================================================================ !</span>
<a name="ln-667"></a><span class="c">!&gt;@}</span>
<a name="ln-668"></a>  <span class="k">FUNCTION </span><span class="n">Invert_3x3</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">Ainv</span><span class="p">)</span>
<a name="ln-669"></a>    <span class="c">!</span>
<a name="ln-670"></a>    <span class="c">! =============================================================================================== !</span>
<a name="ln-671"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-672"></a><span class="k">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-673"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ainv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-674"></a>    <span class="c">! LOCAL</span>
<a name="ln-675"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">detA</span>
<a name="ln-676"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">submat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-677"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">detSubmat</span>
<a name="ln-678"></a>
<a name="ln-679"></a>    <span class="n">detA</span> <span class="o">=</span> <span class="n">Determinant</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-680"></a>
<a name="ln-681"></a>    <span class="c">! Row 1 column 1 of inverse (use submatrix neglecting row 1 and column 1 of A)</span>
<a name="ln-682"></a>    <span class="n">submat</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-683"></a>    <span class="n">detSubmat</span> <span class="o">=</span> <span class="n">Determinant</span><span class="p">(</span><span class="n">submat</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-684"></a>    <span class="n">Ainv</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">detSubmat</span><span class="o">/</span><span class="n">detA</span>
<a name="ln-685"></a>
<a name="ln-686"></a>    <span class="c">! Row 1 column 2 of inverse (use submatrix neglecting row 2 and column 1 of A)</span>
<a name="ln-687"></a>    <span class="n">submat</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-688"></a>    <span class="n">detSubmat</span> <span class="o">=</span> <span class="n">Determinant</span><span class="p">(</span><span class="n">submat</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-689"></a>    <span class="n">Ainv</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">detSubmat</span><span class="o">/</span><span class="n">detA</span>
<a name="ln-690"></a>
<a name="ln-691"></a>    <span class="c">! Row 1 column 3 of inverse (use submatrix neglecting row 3 and column 1 of A)</span>
<a name="ln-692"></a>    <span class="n">submat</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-693"></a>    <span class="n">detSubmat</span> <span class="o">=</span> <span class="n">Determinant</span><span class="p">(</span><span class="n">submat</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-694"></a>    <span class="n">Ainv</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">detSubmat</span><span class="o">/</span><span class="n">detA</span>
<a name="ln-695"></a>
<a name="ln-696"></a>    <span class="c">! Row 2 column 1 of inverse (use submatrix neglecting row 1 and column 2 of A)</span>
<a name="ln-697"></a>    <span class="n">submat</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-698"></a>    <span class="n">detSubmat</span> <span class="o">=</span> <span class="n">Determinant</span><span class="p">(</span><span class="n">submat</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-699"></a>    <span class="n">Ainv</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">detSubmat</span><span class="o">/</span><span class="n">detA</span>
<a name="ln-700"></a>
<a name="ln-701"></a>    <span class="c">! Row 2 column 2 of inverse (use submatrix neglecting row 2 and column 2 of A)</span>
<a name="ln-702"></a>    <span class="n">submat</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-703"></a>    <span class="n">detSubmat</span> <span class="o">=</span> <span class="n">Determinant</span><span class="p">(</span><span class="n">submat</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-704"></a>    <span class="n">Ainv</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">detSubmat</span><span class="o">/</span><span class="n">detA</span>
<a name="ln-705"></a>
<a name="ln-706"></a>    <span class="c">! Row 2 column 3 of inverse (use submatrix neglecting row 3 and column 2 of A)</span>
<a name="ln-707"></a>    <span class="n">submat</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-708"></a>    <span class="n">detSubmat</span> <span class="o">=</span> <span class="n">Determinant</span><span class="p">(</span><span class="n">submat</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-709"></a>    <span class="n">Ainv</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">detSubmat</span><span class="o">/</span><span class="n">detA</span>
<a name="ln-710"></a>
<a name="ln-711"></a>    <span class="c">! Row 3 column 1 of inverse (use submatrix neglecting row 1 and column 3 of A)</span>
<a name="ln-712"></a>    <span class="n">submat</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-713"></a>    <span class="n">detSubmat</span> <span class="o">=</span> <span class="n">Determinant</span><span class="p">(</span><span class="n">submat</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-714"></a>    <span class="n">Ainv</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">detSubmat</span><span class="o">/</span><span class="n">detA</span>
<a name="ln-715"></a>
<a name="ln-716"></a>    <span class="c">! Row 3 column 2 of inverse (use submatrix neglecting row 2 and column 3 of A)</span>
<a name="ln-717"></a>    <span class="n">submat</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-718"></a>    <span class="n">detSubmat</span> <span class="o">=</span> <span class="n">Determinant</span><span class="p">(</span><span class="n">submat</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-719"></a>    <span class="n">Ainv</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">detSubmat</span><span class="o">/</span><span class="n">detA</span>
<a name="ln-720"></a>
<a name="ln-721"></a>    <span class="c">! Row 3 column 3 of inverse (use submatrix neglecting row 3 and column 3 of A)</span>
<a name="ln-722"></a>    <span class="n">submat</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-723"></a>    <span class="n">detSubmat</span> <span class="o">=</span> <span class="n">Determinant</span><span class="p">(</span><span class="n">submat</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-724"></a>    <span class="n">Ainv</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">detSubmat</span><span class="o">/</span><span class="n">detA</span>
<a name="ln-725"></a>
<a name="ln-726"></a>  <span class="k">END FUNCTION </span><span class="n">Invert_3x3</span>
<a name="ln-727"></a><span class="c">!</span>
<a name="ln-728"></a>  <span class="k">FUNCTION </span><span class="n">InvertSpectralOpMatrix</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">Ainv</span><span class="p">)</span>
<a name="ln-729"></a>    <span class="c">! Inverts an (N+1)x(N+1) matrix using a polynomial representation of the</span>
<a name="ln-730"></a>    <span class="c">! inverse</span>
<a name="ln-731"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-732"></a><span class="k">    </span><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-733"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="p">)</span>
<a name="ln-734"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ainv</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="p">)</span>
<a name="ln-735"></a>    <span class="c">! Local</span>
<a name="ln-736"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">iter</span>
<a name="ln-737"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">I</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="p">)</span>
<a name="ln-738"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ainv_ij</span><span class="p">,</span><span class="n">maxChange</span>
<a name="ln-739"></a>
<a name="ln-740"></a>    <span class="n">Ainv</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-741"></a>    <span class="n">I</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-742"></a>    <span class="k">DO </span><span class="n">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">N</span>
<a name="ln-743"></a>      <span class="n">Ainv</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">row</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0_prec</span>
<a name="ln-744"></a>      <span class="n">I</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">row</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0_prec</span>
<a name="ln-745"></a>    <span class="k">END DO</span>
<a name="ln-746"></a>
<a name="ln-747"></a><span class="k">    DO </span><span class="n">iter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">maxInverseIters</span>
<a name="ln-748"></a>
<a name="ln-749"></a>      <span class="n">maxChange</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-750"></a>      <span class="k">DO </span><span class="n">col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">N</span>
<a name="ln-751"></a>        <span class="k">DO </span><span class="n">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">N</span>
<a name="ln-752"></a>
<a name="ln-753"></a>          <span class="n">Ainv_ij</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-754"></a>          <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">N</span>
<a name="ln-755"></a>            <span class="n">Ainv_ij</span> <span class="o">=</span> <span class="n">Ainv_ij</span> <span class="o">+</span> <span class="n">Ainv</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">col</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
<a name="ln-756"></a>          <span class="k">END DO</span>
<a name="ln-757"></a><span class="k">          </span><span class="n">maxChange</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Ainv</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)</span> <span class="o">-</span> <span class="n">Ainv_ij</span><span class="p">),</span><span class="n">maxChange</span><span class="p">)</span>
<a name="ln-758"></a>          <span class="n">Ainv</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)</span> <span class="o">=</span> <span class="n">Ainv_ij</span>
<a name="ln-759"></a>
<a name="ln-760"></a>        <span class="k">END DO</span>
<a name="ln-761"></a><span class="k">      END DO</span>
<a name="ln-762"></a>
<a name="ln-763"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">maxChange</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-764"></a><span class="k">        PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s1">&#39; InvertSpectralOpMatrix : Converged in &#39;</span><span class="p">,</span><span class="n">iter</span><span class="p">,</span><span class="s1">&#39; iterations.&#39;</span>
<a name="ln-765"></a>        <span class="k">EXIT</span>
<a name="ln-766"></a><span class="k">      END IF</span>
<a name="ln-767"></a>
<a name="ln-768"></a><span class="k">    END DO</span>
<a name="ln-769"></a>
<a name="ln-770"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">maxChange</span> <span class="o">&gt;</span> <span class="n">tolerance</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-771"></a><span class="k">      PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s1">&#39;InvertSpectralOpMatrix : Did not converge.&#39;</span><span class="p">,</span><span class="n">maxChange</span>
<a name="ln-772"></a>    <span class="k">END IF</span>
<a name="ln-773"></a>
<a name="ln-774"></a><span class="k">  END FUNCTION </span><span class="n">InvertSpectralOpMatrix</span>
<a name="ln-775"></a><span class="c">!</span>
<a name="ln-776"></a>  <span class="k">FUNCTION </span><span class="n">UpperCase</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>
<a name="ln-777"></a>
<a name="ln-778"></a>    <span class="k">Implicit None</span>
<a name="ln-779"></a><span class="k">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-780"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="p">(</span><span class="n">str</span><span class="p">))</span>      <span class="kd">::</span> <span class="n">Upper</span>
<a name="ln-781"></a>
<a name="ln-782"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ic</span><span class="p">,</span><span class="n">i</span>
<a name="ln-783"></a>
<a name="ln-784"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">27</span><span class="p">),</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cap</span> <span class="o">=</span> <span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ &#39;</span>
<a name="ln-785"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">27</span><span class="p">),</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">low</span> <span class="o">=</span> <span class="s1">&#39;abcdefghijklmnopqrstuvwxyz &#39;</span>
<a name="ln-786"></a>
<a name="ln-787"></a>    <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="nb">LEN</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-788"></a>      <span class="n">ic</span> <span class="o">=</span> <span class="nb">INDEX</span><span class="p">(</span><span class="n">low</span><span class="p">,</span><span class="n">str</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">))</span>
<a name="ln-789"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ic</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-790"></a><span class="k">        </span><span class="n">Upper</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">cap</span><span class="p">(</span><span class="n">ic</span><span class="p">:</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-791"></a>      <span class="k">ELSE</span>
<a name="ln-792"></a><span class="k">        </span><span class="n">Upper</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span>
<a name="ln-793"></a>      <span class="k">END IF</span>
<a name="ln-794"></a><span class="k">    END DO</span>
<a name="ln-795"></a>
<a name="ln-796"></a><span class="k">  END FUNCTION </span><span class="n">UpperCase</span>
<a name="ln-797"></a><span class="c">!</span>
<a name="ln-798"></a>  <span class="k">FUNCTION </span><span class="n">TimeStamp</span><span class="p">(</span><span class="nb">time</span><span class="p">,</span><span class="n">units</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">timeStampString</span><span class="p">)</span>
<a name="ln-799"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-800"></a><span class="k">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>    <span class="kd">::</span> <span class="nb">time</span>
<a name="ln-801"></a><span class="nb">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">units</span>
<a name="ln-802"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="kd">::</span> <span class="n">timeStampString</span>
<a name="ln-803"></a>    <span class="c">! Local</span>
<a name="ln-804"></a>    <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">day</span><span class="p">,</span><span class="n">minute</span><span class="p">,</span><span class="n">hour</span><span class="p">,</span><span class="nb">second</span><span class="p">,</span><span class="n">millisecond</span>
<a name="ln-805"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dayStamp</span>
<a name="ln-806"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hourStamp</span><span class="p">,</span><span class="n">minuteStamp</span><span class="p">,</span><span class="n">secondStamp</span>
<a name="ln-807"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">milliSecondStamp</span>
<a name="ln-808"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">real64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">time_real64</span>
<a name="ln-809"></a>
<a name="ln-810"></a>    <span class="n">time_real64</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="nb">time</span><span class="p">,</span><span class="n">real64</span><span class="p">)</span>
<a name="ln-811"></a>    <span class="c">! Units in &quot;seconds&quot;</span>
<a name="ln-812"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">units</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-813"></a>
<a name="ln-814"></a>      <span class="c">! Obtain the day</span>
<a name="ln-815"></a>      <span class="n">day</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">time_real64</span><span class="o">/</span><span class="mi">8640</span><span class="mf">0.0_real64</span><span class="p">)</span>
<a name="ln-816"></a>      <span class="n">hour</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">((</span><span class="n">time_real64</span> <span class="p">&amp;</span>
<a name="ln-817"></a>                  <span class="o">-</span> <span class="mi">8640</span><span class="mf">0.0_real64</span><span class="o">*</span><span class="n">day</span><span class="p">)</span><span class="o">/</span><span class="mi">360</span><span class="mf">0.0_real64</span><span class="p">)</span>
<a name="ln-818"></a>      <span class="n">minute</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">((</span><span class="n">time_real64</span> <span class="p">&amp;</span>
<a name="ln-819"></a>                    <span class="o">-</span> <span class="mi">360</span><span class="mf">0.0_real64</span><span class="o">*</span><span class="n">hour</span> <span class="p">&amp;</span>
<a name="ln-820"></a>                    <span class="o">-</span> <span class="mi">8640</span><span class="mf">0.0_real64</span><span class="o">*</span><span class="n">day</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="mf">0.0_real64</span><span class="p">)</span>
<a name="ln-821"></a>      <span class="nb">second</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">((</span><span class="n">time_real64</span> <span class="p">&amp;</span>
<a name="ln-822"></a>                    <span class="o">-</span> <span class="mi">6</span><span class="mf">0.0_real64</span><span class="o">*</span><span class="n">minute</span> <span class="p">&amp;</span>
<a name="ln-823"></a>                    <span class="o">-</span> <span class="mi">360</span><span class="mf">0.0_real64</span><span class="o">*</span><span class="n">hour</span> <span class="p">&amp;</span>
<a name="ln-824"></a>                    <span class="o">-</span> <span class="mi">8640</span><span class="mf">0.0_real64</span><span class="o">*</span><span class="n">day</span><span class="p">))</span>
<a name="ln-825"></a>      <span class="n">milliSecond</span> <span class="o">=</span> <span class="nb">NINT</span><span class="p">(((</span><span class="n">time_real64</span> <span class="p">&amp;</span>
<a name="ln-826"></a>                           <span class="o">-</span> <span class="mi">6</span><span class="mf">0.0_real64</span><span class="o">*</span><span class="n">minute</span> <span class="p">&amp;</span>
<a name="ln-827"></a>                           <span class="o">-</span> <span class="mi">360</span><span class="mf">0.0_real64</span><span class="o">*</span><span class="n">hour</span> <span class="p">&amp;</span>
<a name="ln-828"></a>                           <span class="o">-</span> <span class="mi">8640</span><span class="mf">0.0_real64</span><span class="o">*</span><span class="n">day</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-829"></a>                          <span class="o">-</span> <span class="kt">REAL</span><span class="p">(</span><span class="nb">second</span><span class="p">,</span><span class="n">real64</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.0_real64</span><span class="p">)</span>
<a name="ln-830"></a>
<a name="ln-831"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">dayStamp</span><span class="p">,</span><span class="s1">&#39;(I4.4)&#39;</span><span class="p">)</span> <span class="n">day</span>
<a name="ln-832"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">hourStamp</span><span class="p">,</span><span class="s1">&#39;(I2.2)&#39;</span><span class="p">)</span> <span class="n">hour</span>
<a name="ln-833"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">minuteStamp</span><span class="p">,</span><span class="s1">&#39;(I2.2)&#39;</span><span class="p">)</span> <span class="n">minute</span>
<a name="ln-834"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">secondStamp</span><span class="p">,</span><span class="s1">&#39;(I2.2)&#39;</span><span class="p">)</span> <span class="nb">second</span>
<a name="ln-835"></a><span class="nb">      </span><span class="k">WRITE</span> <span class="p">(</span><span class="n">milliSecondStamp</span><span class="p">,</span><span class="s1">&#39;(I3.3)&#39;</span><span class="p">)</span> <span class="n">millisecond</span>
<a name="ln-836"></a>      <span class="n">timeStampString</span> <span class="o">=</span> <span class="n">dayStamp</span><span class="o">//</span><span class="n">hourStamp</span><span class="o">//</span><span class="n">minuteStamp</span><span class="o">//</span><span class="n">secondStamp</span><span class="o">//</span><span class="n">milliSecondStamp</span>
<a name="ln-837"></a>
<a name="ln-838"></a>      <span class="c">! minutes</span>
<a name="ln-839"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">units</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-840"></a>
<a name="ln-841"></a>      <span class="c">! hours</span>
<a name="ln-842"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">units</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;h&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-843"></a>
<a name="ln-844"></a><span class="k">    END IF</span>
<a name="ln-845"></a>
<a name="ln-846"></a><span class="k">  END FUNCTION </span><span class="n">TimeStamp</span>
<a name="ln-847"></a>  <span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">IsNaN</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a name="ln-848"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-849"></a><span class="k">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">a</span>
<a name="ln-850"></a>
<a name="ln-851"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">a</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">a</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-852"></a><span class="k">      </span><span class="n">IsNaN</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-853"></a>    <span class="k">ELSE</span>
<a name="ln-854"></a><span class="k">      </span><span class="n">IsNaN</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-855"></a>    <span class="k">END IF</span>
<a name="ln-856"></a><span class="k">    RETURN</span>
<a name="ln-857"></a>
<a name="ln-858"></a><span class="k">  END FUNCTION </span><span class="n">IsNaN</span>
<a name="ln-859"></a>  <span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">IsInf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a name="ln-860"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-861"></a><span class="k">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span>
<a name="ln-862"></a>
<a name="ln-863"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="nb">HUGE</span><span class="p">(</span><span class="n">prec</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-864"></a><span class="k">      </span><span class="n">IsInf</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-865"></a>    <span class="k">ELSE</span>
<a name="ln-866"></a><span class="k">      </span><span class="n">IsInf</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-867"></a>    <span class="k">END IF</span>
<a name="ln-868"></a><span class="k">    RETURN</span>
<a name="ln-869"></a>
<a name="ln-870"></a><span class="k">  END FUNCTION </span><span class="n">IsInf</span>
<a name="ln-871"></a>
<a name="ln-872"></a>  <span class="k">FUNCTION </span><span class="n">FloorSQRT</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">sqrtX</span><span class="p">)</span>
<a name="ln-873"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">x</span><span class="p">,</span><span class="n">sqrtX</span>
<a name="ln-874"></a>    <span class="c">! Local</span>
<a name="ln-875"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">res</span>
<a name="ln-876"></a>
<a name="ln-877"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-878"></a>
<a name="ln-879"></a><span class="k">      </span><span class="n">sqrtX</span> <span class="o">=</span> <span class="n">x</span>
<a name="ln-880"></a>
<a name="ln-881"></a>    <span class="k">ELSE</span>
<a name="ln-882"></a>
<a name="ln-883"></a><span class="k">      </span><span class="n">res</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-884"></a>      <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-885"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">res</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">)</span>
<a name="ln-886"></a>        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-887"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">i</span>
<a name="ln-888"></a>      <span class="k">END DO</span>
<a name="ln-889"></a>
<a name="ln-890"></a><span class="k">      </span><span class="n">sqrtX</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-891"></a>
<a name="ln-892"></a>    <span class="k">END IF</span>
<a name="ln-893"></a>
<a name="ln-894"></a><span class="k">  END FUNCTION </span><span class="n">FloorSQRT</span>
<a name="ln-895"></a>
<a name="ln-896"></a>  <span class="k">FUNCTION </span><span class="n">FloorCURT</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">curtX</span><span class="p">)</span>
<a name="ln-897"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">x</span><span class="p">,</span><span class="n">curtX</span>
<a name="ln-898"></a>    <span class="c">! Local</span>
<a name="ln-899"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">res</span>
<a name="ln-900"></a>
<a name="ln-901"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-902"></a>
<a name="ln-903"></a><span class="k">      </span><span class="n">curtX</span> <span class="o">=</span> <span class="n">x</span>
<a name="ln-904"></a>
<a name="ln-905"></a>    <span class="k">ELSE</span>
<a name="ln-906"></a>
<a name="ln-907"></a><span class="k">      </span><span class="n">res</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-908"></a>      <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-909"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">res</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">)</span>
<a name="ln-910"></a>        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-911"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="n">i</span>
<a name="ln-912"></a>      <span class="k">END DO</span>
<a name="ln-913"></a>
<a name="ln-914"></a><span class="k">      </span><span class="n">curtX</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-915"></a>
<a name="ln-916"></a>    <span class="k">END IF</span>
<a name="ln-917"></a>
<a name="ln-918"></a><span class="k">  END FUNCTION </span><span class="n">FloorCURT</span>
<a name="ln-919"></a>
<a name="ln-920"></a><span class="k">END MODULE </span><span class="n">SELF_SupportRoutines</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2021-02-25 19:01  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SELF was developed by Joe Schoonover</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>