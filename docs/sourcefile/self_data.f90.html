<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="SELF -- Spectral Element Libraries in Fortran. Fortran classes for implementing spectral element methods on CPU and GPU hardware.">
    
    <meta name="author" content="Joe Schoonover" >
    <link rel="icon" href="../favicon.png">

    <title>SELF_Data.f90 &ndash; SELF</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SELF </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/self.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/self.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>SELF_Data.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="15.0% of total for source files.">1275 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/SELF_Data.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">SELF_Data.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/self_data.html">SELF_Data</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/self_data.f90.html#src">SELF_Data.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.30.1 (20201013.1554)
 -->
<!-- Title: sourcefile~~self_data.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileself_dataf90EfferentGraph" width="590pt" height="181pt"
 viewBox="0.00 0.00 590.00 180.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~self_data.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 176.503)">
<title>sourcefile~~self_data.f90~~EfferentGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-176.503 587,-176.503 587,5 -4,5"/>
<!-- sourcefile~self_data.f90 -->
<g id="sourcefile~~self_data.f90~~EfferentGraph_node1" class="node"><title>sourcefile~self_data.f90</title>
<polygon fill="none" stroke="black" points="581.5,-146 492.5,-146 492.5,-122 581.5,-122 581.5,-146"/>
<text text-anchor="middle" x="537" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50">SELF_Data.f90</text>
</g>
<!-- sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_data.f90~~EfferentGraph_node2" class="node"><title>sourcefile~self_constants.f90</title>
<g id="a_sourcefile~~self_data.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/self_constants.f90.html" xlink:title="SELF_Constants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="116,-106 0,-106 0,-82 116,-82 116,-106"/>
<text text-anchor="middle" x="58" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Constants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_data.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_data.f90~~EfferentGraph_edge1" class="edge"><title>sourcefile~self_data.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M492.259,-145.824C419.784,-163.351 270.991,-190.542 152,-155 124.494,-146.784 97.5698,-127.537 79.8289,-112.843"/>
<polygon fill="#ff0000" stroke="#ff0000" points="81.7713,-109.899 71.8951,-106.064 77.2238,-115.221 81.7713,-109.899"/>
</g>
<!-- sourcefile~self_lagrange.f90 -->
<g id="sourcefile~~self_data.f90~~EfferentGraph_node3" class="node"><title>sourcefile~self_lagrange.f90</title>
<g id="a_sourcefile~~self_data.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/self_lagrange.f90.html" xlink:title="SELF_Lagrange.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="455.5,-106 340.5,-106 340.5,-82 455.5,-82 455.5,-106"/>
<text text-anchor="middle" x="398" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Lagrange.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_data.f90&#45;&gt;sourcefile~self_lagrange.f90 -->
<g id="sourcefile~~self_data.f90~~EfferentGraph_edge2" class="edge"><title>sourcefile~self_data.f90&#45;&gt;sourcefile~self_lagrange.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M494.895,-121.999C480.935,-117.923 465.157,-113.316 450.49,-109.034"/>
<polygon fill="#ff0000" stroke="#ff0000" points="451.129,-105.574 440.549,-106.131 449.167,-112.294 451.129,-105.574"/>
</g>
<!-- sourcefile~self_memory.f90 -->
<g id="sourcefile~~self_data.f90~~EfferentGraph_node4" class="node"><title>sourcefile~self_memory.f90</title>
<g id="a_sourcefile~~self_data.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/self_memory.f90.html" xlink:title="SELF_Memory.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281,-146 175,-146 175,-122 281,-122 281,-146"/>
<text text-anchor="middle" x="228" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Memory.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_memory.f90 -->
<g id="sourcefile~~self_data.f90~~EfferentGraph_edge3" class="edge"><title>sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_memory.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M346.594,-106.001C328.652,-110.273 308.262,-115.128 289.558,-119.582"/>
<polygon fill="#00ffff" stroke="#00ffff" points="288.577,-116.217 279.66,-121.938 290.199,-123.027 288.577,-116.217"/>
</g>
<!-- sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_data.f90~~EfferentGraph_edge4" class="edge"><title>sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M340.426,-94C281.413,-94 188.926,-94 126.225,-94"/>
<polygon fill="#00ffff" stroke="#00ffff" points="126.041,-90.5001 116.041,-94 126.041,-97.5001 126.041,-90.5001"/>
</g>
<!-- sourcefile~self_quadrature.f90 -->
<g id="sourcefile~~self_data.f90~~EfferentGraph_node5" class="node"><title>sourcefile~self_quadrature.f90</title>
<g id="a_sourcefile~~self_data.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/self_quadrature.f90.html" xlink:title="SELF_Quadrature.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="290.5,-66 165.5,-66 165.5,-42 290.5,-42 290.5,-66"/>
<text text-anchor="middle" x="228" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Quadrature.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_quadrature.f90 -->
<g id="sourcefile~~self_data.f90~~EfferentGraph_edge5" class="edge"><title>sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_quadrature.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M346.594,-81.9987C328.652,-77.7268 308.262,-72.8719 289.558,-68.4185"/>
<polygon fill="#00ffff" stroke="#00ffff" points="290.199,-64.9734 279.66,-66.0619 288.577,-71.783 290.199,-64.9734"/>
</g>
<!-- sourcefile~self_supportroutines.f90 -->
<g id="sourcefile~~self_data.f90~~EfferentGraph_node6" class="node"><title>sourcefile~self_supportroutines.f90</title>
<g id="a_sourcefile~~self_data.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/self_supportroutines.f90.html" xlink:title="SELF_SupportRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="303.5,-24 152.5,-24 152.5,-0 303.5,-0 303.5,-24"/>
<text text-anchor="middle" x="228" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_SupportRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_supportroutines.f90 -->
<g id="sourcefile~~self_data.f90~~EfferentGraph_edge6" class="edge"><title>sourcefile~self_lagrange.f90&#45;&gt;sourcefile~self_supportroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M381.738,-81.8479C363.987,-68.2395 333.354,-46.3476 304,-33 299.425,-30.9195 294.597,-29.0004 289.686,-27.2398"/>
<polygon fill="#00ffff" stroke="#00ffff" points="290.779,-23.9148 280.185,-24.0484 288.55,-30.5504 290.779,-23.9148"/>
</g>
<!-- sourcefile~self_memory.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_data.f90~~EfferentGraph_edge7" class="edge"><title>sourcefile~self_memory.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M176.594,-121.999C158.652,-117.727 138.262,-112.872 119.558,-108.418"/>
<polygon fill="#ff0000" stroke="#ff0000" points="120.199,-104.973 109.66,-106.062 118.577,-111.783 120.199,-104.973"/>
</g>
<!-- sourcefile~self_quadrature.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_data.f90~~EfferentGraph_edge8" class="edge"><title>sourcefile~self_quadrature.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M176.594,-66.0013C158.652,-70.2732 138.262,-75.1281 119.558,-79.5815"/>
<polygon fill="#00ff00" stroke="#00ff00" points="118.577,-76.217 109.66,-81.9381 120.199,-83.0266 118.577,-76.217"/>
</g>
<!-- sourcefile~self_supportroutines.f90&#45;&gt;sourcefile~self_constants.f90 -->
<g id="sourcefile~~self_data.f90~~EfferentGraph_edge9" class="edge"><title>sourcefile~self_supportroutines.f90&#45;&gt;sourcefile~self_constants.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M175.815,-24.0484C167.697,-26.6064 159.508,-29.5858 152,-33 126.774,-44.4706 100.604,-62.2513 82.4757,-75.6622"/>
<polygon fill="#0000ff" stroke="#0000ff" points="80.1446,-73.0362 74.2621,-81.8479 84.3557,-78.6279 80.1446,-73.0362"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.30.1 (20201013.1554)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="201pt" height="32pt"
 viewBox="0.00 0.00 201.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-28 198,-28 198,5 -4,5"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="70.25,-24 -0.25,-24 -0.25,-0 70.25,-0 70.25,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="193,-24 89,-24 89,-0 193,-0 193,-24"/>
<text text-anchor="middle" x="141" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.30.1 (20201013.1554)
 -->
<!-- Title: sourcefile~~self_data.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileself_dataf90AfferentGraph" width="641pt" height="110pt"
 viewBox="0.00 0.00 641.00 109.66" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~self_data.f90~~AfferentGraph" class="graph" transform="scale(0.813452 0.813452) rotate(0) translate(4 130.806)">
<title>sourcefile~~self_data.f90~~AfferentGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-130.806 785,-130.806 785,5 -4,5"/>
<!-- sourcefile~self_data.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_node1" class="node"><title>sourcefile~self_data.f90</title>
<polygon fill="none" stroke="black" points="89.5,-51.9762 0.5,-51.9762 0.5,-27.9762 89.5,-27.9762 89.5,-51.9762"/>
<text text-anchor="middle" x="45" y="-37.5762" font-family="Helvetica,sans-Serif" font-size="10.50">SELF_Data.f90</text>
</g>
<!-- sourcefile~self_tests.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_node2" class="node"><title>sourcefile~self_tests.f90</title>
<g id="a_sourcefile~~self_data.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/self_tests.f90.html" xlink:title="SELF_Tests.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="675,-91.9762 585,-91.9762 585,-67.9762 675,-67.9762 675,-91.9762"/>
<text text-anchor="middle" x="630" y="-77.5762" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Tests.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_tests.f90&#45;&gt;sourcefile~self_data.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_edge1" class="edge"><title>sourcefile~self_tests.f90&#45;&gt;sourcefile~self_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M584.813,-91.5063C570.019,-95.0094 553.377,-98.5652 538,-100.976 438.855,-116.521 413.162,-113.74 313,-119.976"/>
</g>
<!-- sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_node5" class="node"><title>sourcefile~self_mesh.f90</title>
<g id="a_sourcefile~~self_data.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/self_mesh.f90.html" xlink:title="SELF_Mesh.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="217.5,-51.9762 126.5,-51.9762 126.5,-27.9762 217.5,-27.9762 217.5,-51.9762"/>
<text text-anchor="middle" x="172" y="-37.5762" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Mesh.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_tests.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_edge8" class="edge"><title>sourcefile~self_tests.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M584.813,-68.4461C570.019,-64.9431 553.377,-61.3872 538,-58.9762 438.855,-43.4315 413.162,-46.2121 313,-39.9762"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M311,-39.9762C283.606,-37.807 253.058,-37.5815 227.68,-37.9935"/>
<polygon fill="#0066ff" stroke="#0066ff" points="227.435,-34.4976 217.507,-38.1967 227.575,-41.4963 227.435,-34.4976"/>
</g>
<!-- sourcefile~self_mappeddata.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_node6" class="node"><title>sourcefile~self_mappeddata.f90</title>
<g id="a_sourcefile~~self_data.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/self_mappeddata.f90.html" xlink:title="SELF_MappedData.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="538,-91.9762 406,-91.9762 406,-67.9762 538,-67.9762 538,-91.9762"/>
<text text-anchor="middle" x="472" y="-77.5762" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_MappedData.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_tests.f90&#45;&gt;sourcefile~self_mappeddata.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_edge12" class="edge"><title>sourcefile~self_tests.f90&#45;&gt;sourcefile~self_mappeddata.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M584.714,-79.9762C573.27,-79.9762 560.628,-79.9762 548.086,-79.9762"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="548.074,-76.4763 538.074,-79.9762 548.074,-83.4763 548.074,-76.4763"/>
</g>
<!-- sourcefile~self_geometry.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_node3" class="node"><title>sourcefile~self_geometry.f90</title>
<g id="a_sourcefile~~self_data.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/self_geometry.f90.html" xlink:title="SELF_Geometry.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="369.5,-91.9762 254.5,-91.9762 254.5,-67.9762 369.5,-67.9762 369.5,-91.9762"/>
<text text-anchor="middle" x="312" y="-77.5762" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_Geometry.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_geometry.f90&#45;&gt;sourcefile~self_data.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_edge2" class="edge"><title>sourcefile~self_geometry.f90&#45;&gt;sourcefile~self_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M281.763,-91.983C247.787,-105.308 193.736,-124.399 173,-119.976"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M171,-119.976C128.848,-110.987 88.4119,-79.5879 65.4465,-58.9036"/>
<polygon fill="#ff0000" stroke="#ff0000" points="67.7957,-56.3089 58.0778,-52.0885 63.0428,-61.4479 67.7957,-56.3089"/>
</g>
<!-- sourcefile~self_geometry.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_edge9" class="edge"><title>sourcefile~self_geometry.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M269.595,-67.9749C255.533,-63.8989 239.64,-59.2922 224.866,-55.0097"/>
<polygon fill="#0066ff" stroke="#0066ff" points="225.431,-51.5297 214.852,-52.1073 223.483,-58.253 225.431,-51.5297"/>
</g>
<!-- sourcefile~self_mpilayer.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_node4" class="node"><title>sourcefile~self_mpilayer.f90</title>
<g id="a_sourcefile~~self_data.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/self_mpilayer.f90.html" xlink:title="SELF_MPILayer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="685.5,-31.9762 574.5,-31.9762 574.5,-7.97623 685.5,-7.97623 685.5,-31.9762"/>
<text text-anchor="middle" x="630" y="-17.5762" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF_MPILayer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self_mpilayer.f90&#45;&gt;sourcefile~self_data.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_edge3" class="edge"><title>sourcefile~self_mpilayer.f90&#45;&gt;sourcefile~self_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M574.465,-12.869C511.47,-5.5878 404.716,3.89564 313,-1.97623"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M311,-1.97623C228.554,-6.47903 207.319,-4.66773 126,-18.9762 116.449,-20.6569 106.369,-22.9124 96.7039,-25.3225"/>
<polygon fill="#ff0000" stroke="#ff0000" points="95.6304,-21.9847 86.8221,-27.8724 97.3794,-28.7627 95.6304,-21.9847"/>
</g>
<!-- sourcefile~self_mpilayer.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_edge10" class="edge"><title>sourcefile~self_mpilayer.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M311,-1.97623C276.876,-4.16094 239.566,-14.9757 212.353,-24.512"/>
<polygon fill="#0066ff" stroke="#0066ff" points="211.032,-21.2678 202.809,-27.9492 213.404,-27.8537 211.032,-21.2678"/>
</g>
<!-- sourcefile~self_mpilayer.f90&#45;&gt;sourcefile~self_mappeddata.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_edge13" class="edge"><title>sourcefile~self_mpilayer.f90&#45;&gt;sourcefile~self_mappeddata.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M597.431,-32.1181C573.353,-41.379 539.993,-54.2095 513.876,-64.2547"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="512.332,-61.0984 504.255,-67.9549 514.845,-67.6318 512.332,-61.0984"/>
</g>
<!-- sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_data.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_edge4" class="edge"><title>sourcefile~self_mesh.f90&#45;&gt;sourcefile~self_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M126.225,-39.9762C117.666,-39.9762 108.622,-39.9762 99.8138,-39.9762"/>
<polygon fill="#ff0000" stroke="#ff0000" points="99.6244,-36.4763 89.6243,-39.9762 99.6243,-43.4763 99.6244,-36.4763"/>
</g>
<!-- sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_data.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_edge5" class="edge"><title>sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M438.281,-92.0572C406.719,-102.797 357.339,-117.216 313,-119.976"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M311,-119.976C249.785,-123.787 232.984,-132.769 173,-119.976"/>
</g>
<!-- sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_geometry.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_edge7" class="edge"><title>sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_geometry.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M405.823,-79.9762C397.362,-79.9762 388.683,-79.9762 380.191,-79.9762"/>
<polygon fill="#cbff00" stroke="#cbff00" points="379.951,-76.4763 369.951,-79.9762 379.951,-83.4763 379.951,-76.4763"/>
</g>
<!-- sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_mesh.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_edge11" class="edge"><title>sourcefile~self_mappeddata.f90&#45;&gt;sourcefile~self_mesh.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M438.281,-67.8953C406.719,-57.1558 357.339,-42.7367 313,-39.9762"/>
</g>
<!-- sourcefile~self.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_node7" class="node"><title>sourcefile~self.f90</title>
<g id="a_sourcefile~~self_data.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/self.f90.html" xlink:title="SELF.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="779.5,-91.9762 722.5,-91.9762 722.5,-67.9762 779.5,-67.9762 779.5,-91.9762"/>
<text text-anchor="middle" x="751" y="-77.5762" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SELF.f90</text>
</a>
</g>
</g>
<!-- sourcefile~self.f90&#45;&gt;sourcefile~self_tests.f90 -->
<g id="sourcefile~~self_data.f90~~AfferentGraph_edge6" class="edge"><title>sourcefile~self.f90&#45;&gt;sourcefile~self_tests.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M722.4,-79.9762C711.348,-79.9762 698.211,-79.9762 685.393,-79.9762"/>
<polygon fill="#ff0000" stroke="#ff0000" points="685.227,-76.4763 675.227,-79.9762 685.227,-83.4763 685.227,-76.4763"/>
</g>
</g>
</svg>
</div><script>var pansourcefileself_dataf90AfferentGraph = svgPanZoom('#sourcefileself_dataf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.30.1 (20201013.1554)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="201pt" height="32pt"
 viewBox="0.00 0.00 201.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-28 198,-28 198,5 -4,5"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="70.25,-24 -0.25,-24 -0.25,-0 70.25,-0 70.25,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="193,-24 89,-24 89,-0 193,-0 193,-24"/>
<text text-anchor="middle" x="141" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/self_data.html">SELF_Data</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/self_data.f90.html#src">SELF_Data.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">! SELF_Data.F90</span>
<a name="ln-2"></a><span class="c">!</span>
<a name="ln-3"></a><span class="c">! Copyright 2020 Fluid Numerics LLC</span>
<a name="ln-4"></a><span class="c">! Author : Joseph Schoonover (joe@fluidnumerics.com)</span>
<a name="ln-5"></a><span class="c">! Support : self-fluids@fluidnumerics.com</span>
<a name="ln-6"></a><span class="c">!</span>
<a name="ln-7"></a><span class="c">! //////////////////////////////////////////////////////////////////////////////////////////////// !</span>
<a name="ln-8"></a>
<a name="ln-9"></a><span class="k">MODULE </span><span class="n">SELF_Data</span>
<a name="ln-10"></a>
<a name="ln-11"></a>  <span class="k">USE </span><span class="n">SELF_Constants</span>
<a name="ln-12"></a>  <span class="k">USE </span><span class="n">SELF_Lagrange</span>
<a name="ln-13"></a>
<a name="ln-14"></a>  <span class="k">USE </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-15"></a>
<a name="ln-16"></a><span class="nb">  </span><span class="k">IMPLICIT NONE</span>
<a name="ln-17"></a>
<a name="ln-18"></a><span class="cp">#include &quot;SELF_Macros.h&quot;</span>
<a name="ln-19"></a>
<a name="ln-20"></a><span class="c">! ---------------------- Scalars ---------------------- !</span>
<a name="ln-21"></a>  <span class="k">TYPE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Scalar1D</span>
<a name="ln-22"></a>
<a name="ln-23"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-24"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-25"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nVar</span>
<a name="ln-26"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-27"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">controlType</span>
<a name="ln-28"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">targetType</span>
<a name="ln-29"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Lagrange</span><span class="p">)</span> <span class="kd">::</span> <span class="n">interp</span>
<a name="ln-30"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">interior</span>
<a name="ln-31"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">boundary</span>
<a name="ln-32"></a>
<a name="ln-33"></a>  <span class="k">CONTAINS</span>
<a name="ln-34"></a>
<a name="ln-35"></a><span class="k">    PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Init</span> <span class="o">=&gt;</span> <span class="n">Init_Scalar1D</span>
<a name="ln-36"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Free</span> <span class="o">=&gt;</span> <span class="n">Free_Scalar1D</span>
<a name="ln-37"></a>
<a name="ln-38"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateHost</span> <span class="o">=&gt;</span> <span class="n">UpdateHost_Scalar1D</span>
<a name="ln-39"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateDevice</span> <span class="o">=&gt;</span> <span class="n">UpdateDevice_Scalar1D</span>
<a name="ln-40"></a>
<a name="ln-41"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">BoundaryInterp</span> <span class="o">=&gt;</span> <span class="n">BoundaryInterp_Scalar1D</span>
<a name="ln-42"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">GridInterp</span> <span class="o">=&gt;</span> <span class="n">GridInterp_Scalar1D</span>
<a name="ln-43"></a>
<a name="ln-44"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Derivative</span> <span class="o">=&gt;</span> <span class="n">Derivative_Scalar1D</span>
<a name="ln-45"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">Derivative_Scalar1D</span>
<a name="ln-46"></a>
<a name="ln-47"></a>
<a name="ln-48"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">AbsMaxInterior</span> <span class="o">=&gt;</span> <span class="n">AbsMaxInterior_Scalar1D</span>
<a name="ln-49"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">AbsMaxBoundary</span> <span class="o">=&gt;</span> <span class="n">AbsMaxBoundary_Scalar1D</span>
<a name="ln-50"></a>
<a name="ln-51"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">ASSIGNMENT</span><span class="p">(</span><span class="o">=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Equals_Scalar1D</span>
<a name="ln-52"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">OPERATOR</span><span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Add_Scalar1D</span>
<a name="ln-53"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">OPERATOR</span><span class="p">(</span><span class="o">-</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Subtract_Scalar1D</span>
<a name="ln-54"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Equals_Scalar1D</span>
<a name="ln-55"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFa</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Add_Scalar1D</span>
<a name="ln-56"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFa</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Subtract_Scalar1D</span>
<a name="ln-57"></a>
<a name="ln-58"></a>  <span class="k">END TYPE </span><span class="n">Scalar1D</span>
<a name="ln-59"></a>
<a name="ln-60"></a>  <span class="k">TYPE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Scalar2D</span>
<a name="ln-61"></a>
<a name="ln-62"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-63"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-64"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nVar</span>
<a name="ln-65"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-66"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">controlType</span>
<a name="ln-67"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">targetType</span>
<a name="ln-68"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Lagrange</span><span class="p">)</span> <span class="kd">::</span> <span class="n">interp</span>
<a name="ln-69"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">interior</span>
<a name="ln-70"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">boundary</span>
<a name="ln-71"></a>
<a name="ln-72"></a>  <span class="k">CONTAINS</span>
<a name="ln-73"></a>
<a name="ln-74"></a><span class="k">    PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Init</span> <span class="o">=&gt;</span> <span class="n">Init_Scalar2D</span>
<a name="ln-75"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Free</span> <span class="o">=&gt;</span> <span class="n">Free_Scalar2D</span>
<a name="ln-76"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateHost</span> <span class="o">=&gt;</span> <span class="n">UpdateHost_Scalar2D</span>
<a name="ln-77"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateDevice</span> <span class="o">=&gt;</span> <span class="n">UpdateDevice_Scalar2D</span>
<a name="ln-78"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">BoundaryInterp</span> <span class="o">=&gt;</span> <span class="n">BoundaryInterp_Scalar2D</span>
<a name="ln-79"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">GridInterp</span> <span class="o">=&gt;</span> <span class="n">GridInterp_Scalar2D</span>
<a name="ln-80"></a>
<a name="ln-81"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Gradient</span> <span class="o">=&gt;</span> <span class="n">Gradient_Scalar2D</span>
<a name="ln-82"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">Gradient_Scalar2D</span>
<a name="ln-83"></a>
<a name="ln-84"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">AbsMaxInterior</span> <span class="o">=&gt;</span> <span class="n">AbsMaxInterior_Scalar2D</span>
<a name="ln-85"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">AbsMaxBoundary</span> <span class="o">=&gt;</span> <span class="n">AbsMaxBoundary_Scalar2D</span>
<a name="ln-86"></a>
<a name="ln-87"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">ASSIGNMENT</span><span class="p">(</span><span class="o">=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Equals_Scalar2D</span>
<a name="ln-88"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">OPERATOR</span><span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Add_Scalar2D</span>
<a name="ln-89"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">OPERATOR</span><span class="p">(</span><span class="o">-</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Subtract_Scalar2D</span>
<a name="ln-90"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Equals_Scalar2D</span>
<a name="ln-91"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFa</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Add_Scalar2D</span>
<a name="ln-92"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFa</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Subtract_Scalar2D</span>
<a name="ln-93"></a>
<a name="ln-94"></a>  <span class="k">END TYPE </span><span class="n">Scalar2D</span>
<a name="ln-95"></a>
<a name="ln-96"></a>  <span class="k">TYPE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Scalar3D</span>
<a name="ln-97"></a>
<a name="ln-98"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-99"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-100"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nVar</span>
<a name="ln-101"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-102"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">controlType</span>
<a name="ln-103"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">targetType</span>
<a name="ln-104"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Lagrange</span><span class="p">)</span> <span class="kd">::</span> <span class="n">interp</span>
<a name="ln-105"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">interior</span>
<a name="ln-106"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">boundary</span>
<a name="ln-107"></a>
<a name="ln-108"></a>  <span class="k">CONTAINS</span>
<a name="ln-109"></a>
<a name="ln-110"></a><span class="k">    PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Init</span> <span class="o">=&gt;</span> <span class="n">Init_Scalar3D</span>
<a name="ln-111"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Free</span> <span class="o">=&gt;</span> <span class="n">Free_Scalar3D</span>
<a name="ln-112"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateHost</span> <span class="o">=&gt;</span> <span class="n">UpdateHost_Scalar3D</span>
<a name="ln-113"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateDevice</span> <span class="o">=&gt;</span> <span class="n">UpdateDevice_Scalar3D</span>
<a name="ln-114"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">BoundaryInterp</span> <span class="o">=&gt;</span> <span class="n">BoundaryInterp_Scalar3D</span>
<a name="ln-115"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">GridInterp</span> <span class="o">=&gt;</span> <span class="n">GridInterp_Scalar3D</span>
<a name="ln-116"></a>
<a name="ln-117"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Gradient</span> <span class="o">=&gt;</span> <span class="n">Gradient_Scalar3D</span>
<a name="ln-118"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">Gradient_Scalar3D</span>
<a name="ln-119"></a>
<a name="ln-120"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">AbsMaxInterior</span> <span class="o">=&gt;</span> <span class="n">AbsMaxInterior_Scalar3D</span>
<a name="ln-121"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">AbsMaxBoundary</span> <span class="o">=&gt;</span> <span class="n">AbsMaxBoundary_Scalar3D</span>
<a name="ln-122"></a>
<a name="ln-123"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">ASSIGNMENT</span><span class="p">(</span><span class="o">=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Equals_Scalar3D</span>
<a name="ln-124"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">OPERATOR</span><span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Add_Scalar3D</span>
<a name="ln-125"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">OPERATOR</span><span class="p">(</span><span class="o">-</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Subtract_Scalar3D</span>
<a name="ln-126"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Equals_Scalar3D</span>
<a name="ln-127"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFa</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Add_Scalar3D</span>
<a name="ln-128"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFa</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Subtract_Scalar3D</span>
<a name="ln-129"></a>
<a name="ln-130"></a>  <span class="k">END TYPE </span><span class="n">Scalar3D</span>
<a name="ln-131"></a>
<a name="ln-132"></a><span class="c">! ---------------------- Vectors ---------------------- !</span>
<a name="ln-133"></a>
<a name="ln-134"></a>  <span class="k">TYPE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Vector2D</span>
<a name="ln-135"></a>
<a name="ln-136"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-137"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-138"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nVar</span>
<a name="ln-139"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-140"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">controlType</span>
<a name="ln-141"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">targetType</span>
<a name="ln-142"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Lagrange</span><span class="p">)</span> <span class="kd">::</span> <span class="n">interp</span>
<a name="ln-143"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">interior</span>
<a name="ln-144"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">boundary</span>
<a name="ln-145"></a>
<a name="ln-146"></a>  <span class="k">CONTAINS</span>
<a name="ln-147"></a>
<a name="ln-148"></a><span class="k">    PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Init</span> <span class="o">=&gt;</span> <span class="n">Init_Vector2D</span>
<a name="ln-149"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Free</span> <span class="o">=&gt;</span> <span class="n">Free_Vector2D</span>
<a name="ln-150"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateHost</span> <span class="o">=&gt;</span> <span class="n">UpdateHost_Vector2D</span>
<a name="ln-151"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateDevice</span> <span class="o">=&gt;</span> <span class="n">UpdateDevice_Vector2D</span>
<a name="ln-152"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">BoundaryInterp</span> <span class="o">=&gt;</span> <span class="n">BoundaryInterp_Vector2D</span>
<a name="ln-153"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">GridInterp</span> <span class="o">=&gt;</span> <span class="n">GridInterp_Vector2D</span>
<a name="ln-154"></a>
<a name="ln-155"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Gradient</span> <span class="o">=&gt;</span> <span class="n">Gradient_Vector2D</span>
<a name="ln-156"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">Gradient_Vector2D</span>
<a name="ln-157"></a>
<a name="ln-158"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Divergence</span> <span class="o">=&gt;</span> <span class="n">Divergence_Vector2D</span>
<a name="ln-159"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">Divergence_Vector2D</span>
<a name="ln-160"></a>
<a name="ln-161"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Curl</span> <span class="o">=&gt;</span> <span class="n">Curl_Vector2D</span>
<a name="ln-162"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">Curl_Vector2D</span>
<a name="ln-163"></a>
<a name="ln-164"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">AbsMaxInterior</span> <span class="o">=&gt;</span> <span class="n">AbsMaxInterior_Vector2D</span>
<a name="ln-165"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">AbsMaxBoundary</span> <span class="o">=&gt;</span> <span class="n">AbsMaxBoundary_Vector2D</span>
<a name="ln-166"></a>
<a name="ln-167"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">ASSIGNMENT</span><span class="p">(</span><span class="o">=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Equals_Vector2D</span>
<a name="ln-168"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">OPERATOR</span><span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Add_Vector2D</span>
<a name="ln-169"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">OPERATOR</span><span class="p">(</span><span class="o">-</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Subtract_Vector2D</span>
<a name="ln-170"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Equals_Vector2D</span>
<a name="ln-171"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFa</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Add_Vector2D</span>
<a name="ln-172"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFa</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Subtract_Vector2D</span>
<a name="ln-173"></a>
<a name="ln-174"></a>  <span class="k">END TYPE </span><span class="n">Vector2D</span>
<a name="ln-175"></a>
<a name="ln-176"></a>  <span class="k">TYPE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Vector3D</span>
<a name="ln-177"></a>
<a name="ln-178"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-179"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-180"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nVar</span>
<a name="ln-181"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-182"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">controlType</span>
<a name="ln-183"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">targetType</span>
<a name="ln-184"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Lagrange</span><span class="p">)</span> <span class="kd">::</span> <span class="n">interp</span>
<a name="ln-185"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">interior</span>
<a name="ln-186"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">boundary</span>
<a name="ln-187"></a>
<a name="ln-188"></a>  <span class="k">CONTAINS</span>
<a name="ln-189"></a>
<a name="ln-190"></a><span class="k">    PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Init</span> <span class="o">=&gt;</span> <span class="n">Init_Vector3D</span>
<a name="ln-191"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Free</span> <span class="o">=&gt;</span> <span class="n">Free_Vector3D</span>
<a name="ln-192"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateHost</span> <span class="o">=&gt;</span> <span class="n">UpdateHost_Vector3D</span>
<a name="ln-193"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateDevice</span> <span class="o">=&gt;</span> <span class="n">UpdateDevice_Vector3D</span>
<a name="ln-194"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">BoundaryInterp</span> <span class="o">=&gt;</span> <span class="n">BoundaryInterp_Vector3D</span>
<a name="ln-195"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">GridInterp</span> <span class="o">=&gt;</span> <span class="n">GridInterp_Vector3D</span>
<a name="ln-196"></a>
<a name="ln-197"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Gradient</span> <span class="o">=&gt;</span> <span class="n">Gradient_Vector3D</span>
<a name="ln-198"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">Gradient_Vector3D</span>
<a name="ln-199"></a>
<a name="ln-200"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Divergence</span> <span class="o">=&gt;</span> <span class="n">Divergence_Vector3D</span>
<a name="ln-201"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">Divergence_Vector3D</span>
<a name="ln-202"></a>
<a name="ln-203"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Curl</span> <span class="o">=&gt;</span> <span class="n">Curl_Vector3D</span>
<a name="ln-204"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">Curl_Vector3D</span>
<a name="ln-205"></a>
<a name="ln-206"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">AbsMaxInterior</span> <span class="o">=&gt;</span> <span class="n">AbsMaxInterior_Vector3D</span>
<a name="ln-207"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">AbsMaxBoundary</span> <span class="o">=&gt;</span> <span class="n">AbsMaxBoundary_Vector3D</span>
<a name="ln-208"></a>
<a name="ln-209"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">ASSIGNMENT</span><span class="p">(</span><span class="o">=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Equals_Vector3D</span>
<a name="ln-210"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">OPERATOR</span><span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Add_Vector3D</span>
<a name="ln-211"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">OPERATOR</span><span class="p">(</span><span class="o">-</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Subtract_Vector3D</span>
<a name="ln-212"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Equals_Vector3D</span>
<a name="ln-213"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFa</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Add_Vector3D</span>
<a name="ln-214"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFa</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Subtract_Vector3D</span>
<a name="ln-215"></a>
<a name="ln-216"></a>  <span class="k">END TYPE </span><span class="n">Vector3D</span>
<a name="ln-217"></a>
<a name="ln-218"></a><span class="c">! ---------------------- Tensors ---------------------- !</span>
<a name="ln-219"></a>
<a name="ln-220"></a>  <span class="k">TYPE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Tensor2D</span>
<a name="ln-221"></a>
<a name="ln-222"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-223"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-224"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nVar</span>
<a name="ln-225"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-226"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">controlType</span>
<a name="ln-227"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">targetType</span>
<a name="ln-228"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Lagrange</span><span class="p">)</span> <span class="kd">::</span> <span class="n">interp</span>
<a name="ln-229"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">interior</span>
<a name="ln-230"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">boundary</span>
<a name="ln-231"></a>
<a name="ln-232"></a>  <span class="k">CONTAINS</span>
<a name="ln-233"></a>
<a name="ln-234"></a><span class="k">    PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Init</span> <span class="o">=&gt;</span> <span class="n">Init_Tensor2D</span>
<a name="ln-235"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Free</span> <span class="o">=&gt;</span> <span class="n">Free_Tensor2D</span>
<a name="ln-236"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateHost</span> <span class="o">=&gt;</span> <span class="n">UpdateHost_Tensor2D</span>
<a name="ln-237"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateDevice</span> <span class="o">=&gt;</span> <span class="n">UpdateDevice_Tensor2D</span>
<a name="ln-238"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">BoundaryInterp</span> <span class="o">=&gt;</span> <span class="n">BoundaryInterp_Tensor2D</span>
<a name="ln-239"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">GridInterp</span> <span class="o">=&gt;</span> <span class="n">GridInterp_Tensor2D</span>
<a name="ln-240"></a>
<a name="ln-241"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Determinant</span> <span class="o">=&gt;</span> <span class="n">Determinant_Tensor2D</span>
<a name="ln-242"></a>
<a name="ln-243"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Divergence</span> <span class="o">=&gt;</span> <span class="n">Divergence_Tensor2D</span>
<a name="ln-244"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">Divergence_Tensor2D</span>
<a name="ln-245"></a>
<a name="ln-246"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">AbsMaxInterior</span> <span class="o">=&gt;</span> <span class="n">AbsMaxInterior_Tensor2D</span>
<a name="ln-247"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">AbsMaxBoundary</span> <span class="o">=&gt;</span> <span class="n">AbsMaxBoundary_Tensor2D</span>
<a name="ln-248"></a>
<a name="ln-249"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">ASSIGNMENT</span><span class="p">(</span><span class="o">=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Equals_Tensor2D</span>
<a name="ln-250"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">OPERATOR</span><span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Add_Tensor2D</span>
<a name="ln-251"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">OPERATOR</span><span class="p">(</span><span class="o">-</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Subtract_Tensor2D</span>
<a name="ln-252"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Equals_Tensor2D</span>
<a name="ln-253"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFa</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Add_Tensor2D</span>
<a name="ln-254"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFa</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Subtract_Tensor2D</span>
<a name="ln-255"></a>
<a name="ln-256"></a>  <span class="k">END TYPE </span><span class="n">Tensor2D</span>
<a name="ln-257"></a>
<a name="ln-258"></a>  <span class="k">TYPE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Tensor3D</span>
<a name="ln-259"></a>
<a name="ln-260"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-261"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-262"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nVar</span>
<a name="ln-263"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-264"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">controlType</span>
<a name="ln-265"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">targetType</span>
<a name="ln-266"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Lagrange</span><span class="p">)</span> <span class="kd">::</span> <span class="n">interp</span>
<a name="ln-267"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r7</span><span class="p">)</span> <span class="kd">::</span> <span class="n">interior</span>
<a name="ln-268"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">hfReal_r7</span><span class="p">)</span> <span class="kd">::</span> <span class="n">boundary</span>
<a name="ln-269"></a>
<a name="ln-270"></a>  <span class="k">CONTAINS</span>
<a name="ln-271"></a>
<a name="ln-272"></a><span class="k">    PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Init</span> <span class="o">=&gt;</span> <span class="n">Init_Tensor3D</span>
<a name="ln-273"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Free</span> <span class="o">=&gt;</span> <span class="n">Free_Tensor3D</span>
<a name="ln-274"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateHost</span> <span class="o">=&gt;</span> <span class="n">UpdateHost_Tensor3D</span>
<a name="ln-275"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">UpdateDevice</span> <span class="o">=&gt;</span> <span class="n">UpdateDevice_Tensor3D</span>
<a name="ln-276"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">BoundaryInterp</span> <span class="o">=&gt;</span> <span class="n">BoundaryInterp_Tensor3D</span>
<a name="ln-277"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">GridInterp</span> <span class="o">=&gt;</span> <span class="n">GridInterp_Tensor3D</span>
<a name="ln-278"></a>
<a name="ln-279"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Determinant</span> <span class="o">=&gt;</span> <span class="n">Determinant_Tensor3D</span>
<a name="ln-280"></a>
<a name="ln-281"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">Divergence</span> <span class="o">=&gt;</span> <span class="n">Divergence_Tensor3D</span>
<a name="ln-282"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">Divergence_Tensor3D</span>
<a name="ln-283"></a>
<a name="ln-284"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">AbsMaxInterior</span> <span class="o">=&gt;</span> <span class="n">AbsMaxInterior_Tensor3D</span>
<a name="ln-285"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">AbsMaxBoundary</span> <span class="o">=&gt;</span> <span class="n">AbsMaxBoundary_Tensor3D</span>
<a name="ln-286"></a>
<a name="ln-287"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">ASSIGNMENT</span><span class="p">(</span><span class="o">=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Equals_Tensor3D</span>
<a name="ln-288"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">OPERATOR</span><span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Add_Tensor3D</span>
<a name="ln-289"></a>    <span class="k">GENERIC</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">OPERATOR</span><span class="p">(</span><span class="o">-</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">Subtract_Tensor3D</span>
<a name="ln-290"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Equals_Tensor3D</span>
<a name="ln-291"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFa</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Add_Tensor3D</span>
<a name="ln-292"></a>    <span class="k">PROCEDURE</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="k">PASS</span><span class="p">(</span><span class="n">SELFa</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Subtract_Tensor3D</span>
<a name="ln-293"></a>
<a name="ln-294"></a>  <span class="k">END TYPE </span><span class="n">Tensor3D</span>
<a name="ln-295"></a>
<a name="ln-296"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfStrongForm</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-297"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfWeakDGForm</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-298"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">selfWeakCGForm</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-299"></a>
<a name="ln-300"></a><span class="cp">#ifdef GPU</span>
<a name="ln-301"></a>  <span class="k">INTERFACE</span>
<a name="ln-302"></a><span class="k">    SUBROUTINE </span><span class="n">Determinant_Tensor2D_gpu_wrapper</span><span class="p">(</span><span class="n">tensor_dev</span><span class="p">,</span><span class="n">detTensor_dev</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nEl</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-303"></a>      <span class="k">bind</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Determinant_Tensor2D_gpu_wrapper&quot;</span><span class="p">)</span>
<a name="ln-304"></a>      <span class="k">USE </span><span class="nb">iso_c_binding</span>
<a name="ln-305"></a><span class="nb">      </span><span class="k">IMPLICIT NONE</span>
<a name="ln-306"></a><span class="k">      TYPE</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tensor_dev</span><span class="p">,</span><span class="n">detTensor_dev</span>
<a name="ln-307"></a>      <span class="kt">INTEGER</span><span class="p">,</span><span class="k">VALUE</span> <span class="kd">::</span> <span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nEl</span>
<a name="ln-308"></a>    <span class="k">END SUBROUTINE </span><span class="n">Determinant_Tensor2D_gpu_wrapper</span>
<a name="ln-309"></a>  <span class="k">END INTERFACE</span>
<a name="ln-310"></a>
<a name="ln-311"></a><span class="k">  INTERFACE</span>
<a name="ln-312"></a><span class="k">    SUBROUTINE </span><span class="n">Determinant_Tensor3D_gpu_wrapper</span><span class="p">(</span><span class="n">tensor_dev</span><span class="p">,</span><span class="n">detTensor_dev</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nEl</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-313"></a>      <span class="k">bind</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Determinant_Tensor3D_gpu_wrapper&quot;</span><span class="p">)</span>
<a name="ln-314"></a>      <span class="k">USE </span><span class="nb">iso_c_binding</span>
<a name="ln-315"></a><span class="nb">      </span><span class="k">IMPLICIT NONE</span>
<a name="ln-316"></a><span class="k">      TYPE</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tensor_dev</span><span class="p">,</span><span class="n">detTensor_dev</span>
<a name="ln-317"></a>      <span class="kt">INTEGER</span><span class="p">,</span><span class="k">VALUE</span> <span class="kd">::</span> <span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nEl</span>
<a name="ln-318"></a>    <span class="k">END SUBROUTINE </span><span class="n">Determinant_Tensor3D_gpu_wrapper</span>
<a name="ln-319"></a>  <span class="k">END INTERFACE</span>
<a name="ln-320"></a><span class="cp">#endif</span>
<a name="ln-321"></a>
<a name="ln-322"></a><span class="k">CONTAINS</span>
<a name="ln-323"></a>
<a name="ln-324"></a><span class="c">! -- Scalar1D -- !</span>
<a name="ln-325"></a>
<a name="ln-326"></a>  <span class="k">SUBROUTINE </span><span class="n">Init_Scalar1D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">quadratureType</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">targetNodeType</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nElem</span><span class="p">)</span>
<a name="ln-327"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-328"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-329"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-330"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">quadratureType</span>
<a name="ln-331"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-332"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">targetNodeType</span>
<a name="ln-333"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nVar</span>
<a name="ln-334"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-335"></a>
<a name="ln-336"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-337"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">M</span> <span class="o">=</span> <span class="n">M</span>
<a name="ln-338"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span> <span class="o">=</span> <span class="n">nVar</span>
<a name="ln-339"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-340"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">controlType</span> <span class="o">=</span> <span class="n">quadratureType</span>
<a name="ln-341"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">targetType</span> <span class="o">=</span> <span class="n">targetNodeType</span>
<a name="ln-342"></a>
<a name="ln-343"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-344"></a>                                     <span class="n">controlNodeType</span><span class="o">=</span><span class="n">quadratureType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-345"></a>                                     <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-346"></a>                                     <span class="n">targetNodeType</span><span class="o">=</span><span class="n">targetNodeType</span><span class="p">)</span>
<a name="ln-347"></a>
<a name="ln-348"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-349"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-350"></a>
<a name="ln-351"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-352"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="n">nVar</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-353"></a>
<a name="ln-354"></a>  <span class="k">END SUBROUTINE </span><span class="n">Init_Scalar1D</span>
<a name="ln-355"></a>
<a name="ln-356"></a>  <span class="k">SUBROUTINE </span><span class="n">Free_Scalar1D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-357"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-358"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-359"></a>
<a name="ln-360"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-361"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-362"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-363"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-364"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-365"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-366"></a>
<a name="ln-367"></a>  <span class="k">END SUBROUTINE </span><span class="n">Free_Scalar1D</span>
<a name="ln-368"></a>
<a name="ln-369"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateHost_Scalar1D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-370"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-371"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-372"></a>
<a name="ln-373"></a><span class="cp">#ifdef GPU</span>
<a name="ln-374"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-375"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-376"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-377"></a><span class="cp">#endif</span>
<a name="ln-378"></a>
<a name="ln-379"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateHost_Scalar1D</span>
<a name="ln-380"></a>
<a name="ln-381"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateDevice_Scalar1D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-382"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-383"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-384"></a>
<a name="ln-385"></a><span class="cp">#ifdef GPU</span>
<a name="ln-386"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-387"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-388"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-389"></a><span class="cp">#endif</span>
<a name="ln-390"></a>
<a name="ln-391"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateDevice_Scalar1D</span>
<a name="ln-392"></a>
<a name="ln-393"></a>  <span class="k">SUBROUTINE </span><span class="n">BoundaryInterp_Scalar1D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-394"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-395"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-396"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-397"></a>
<a name="ln-398"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-399"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">ScalarBoundaryInterp_1D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-400"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-401"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-402"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-403"></a>    <span class="k">ELSE</span>
<a name="ln-404"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">ScalarBoundaryInterp_1D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-405"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-406"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-407"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-408"></a>    <span class="k">END IF</span>
<a name="ln-409"></a>
<a name="ln-410"></a><span class="k">  END SUBROUTINE </span><span class="n">BoundaryInterp_Scalar1D</span>
<a name="ln-411"></a>
<a name="ln-412"></a>  <span class="k">SUBROUTINE </span><span class="n">GridInterp_Scalar1D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFout</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-413"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-414"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-415"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-416"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-417"></a>
<a name="ln-418"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-419"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">ScalarGridInterp_1D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-420"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-421"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-422"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-423"></a>    <span class="k">ELSE</span>
<a name="ln-424"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">ScalarGridInterp_1D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-425"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-426"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-427"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-428"></a>    <span class="k">END IF</span>
<a name="ln-429"></a>
<a name="ln-430"></a><span class="k">  END SUBROUTINE </span><span class="n">GridInterp_Scalar1D</span>
<a name="ln-431"></a>
<a name="ln-432"></a>  <span class="k">SUBROUTINE </span><span class="n">Derivative_Scalar1D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-433"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-434"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-435"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-436"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-437"></a>
<a name="ln-438"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-439"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">Derivative_1D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-440"></a>                                                <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-441"></a>                                                <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-442"></a>                                                <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-443"></a>    <span class="k">ELSE</span>
<a name="ln-444"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">Derivative_1D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-445"></a>                                                <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-446"></a>                                                <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-447"></a>                                                <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-448"></a>    <span class="k">ENDIF</span>
<a name="ln-449"></a>
<a name="ln-450"></a><span class="k">  END SUBROUTINE </span><span class="n">Derivative_Scalar1D</span>
<a name="ln-451"></a>
<a name="ln-452"></a>  <span class="k">FUNCTION </span><span class="n">AbsMaxInterior_Scalar1D</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">absMax</span><span class="p">)</span>
<a name="ln-453"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-454"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scalar</span>
<a name="ln-455"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">absMax</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">)</span>
<a name="ln-456"></a>    <span class="c">! Local</span>
<a name="ln-457"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">i</span>
<a name="ln-458"></a>
<a name="ln-459"></a>    <span class="n">absMax</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-460"></a>    <span class="k">DO </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-461"></a>      <span class="k">DO </span><span class="n">iVar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nVar</span>
<a name="ln-462"></a>        <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-463"></a>          <span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)),</span><span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">))</span>
<a name="ln-464"></a>        <span class="k">END DO</span>
<a name="ln-465"></a><span class="k">      END DO</span>
<a name="ln-466"></a><span class="k">    END DO</span>
<a name="ln-467"></a>
<a name="ln-468"></a><span class="k">  END FUNCTION </span><span class="n">AbsMaxInterior_Scalar1D</span>
<a name="ln-469"></a>
<a name="ln-470"></a>  <span class="k">FUNCTION </span><span class="n">AbsMaxBoundary_Scalar1D</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">absMax</span><span class="p">)</span>
<a name="ln-471"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-472"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scalar</span>
<a name="ln-473"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">absMax</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-474"></a>    <span class="c">! Local</span>
<a name="ln-475"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span>
<a name="ln-476"></a>
<a name="ln-477"></a>    <span class="n">absMax</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-478"></a>    <span class="k">DO </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-479"></a>      <span class="k">DO </span><span class="n">iSide</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-480"></a>        <span class="k">DO </span><span class="n">iVar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nVar</span>
<a name="ln-481"></a>          <span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">,</span><span class="n">iEl</span><span class="p">)),</span><span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">))</span>
<a name="ln-482"></a>        <span class="k">END DO</span>
<a name="ln-483"></a><span class="k">      END DO</span>
<a name="ln-484"></a><span class="k">    END DO</span>
<a name="ln-485"></a>
<a name="ln-486"></a><span class="k">  END FUNCTION </span><span class="n">AbsMaxBoundary_Scalar1D</span>
<a name="ln-487"></a>
<a name="ln-488"></a>  <span class="k">SUBROUTINE </span><span class="n">Equals_Scalar1D</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">SELFin</span><span class="p">)</span>
<a name="ln-489"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-490"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-491"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFin</span>
<a name="ln-492"></a>
<a name="ln-493"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFin</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-494"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFin</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-495"></a>
<a name="ln-496"></a>  <span class="k">END SUBROUTINE </span><span class="n">Equals_Scalar1D</span>
<a name="ln-497"></a>
<a name="ln-498"></a>  <span class="k">FUNCTION </span><span class="n">Add_Scalar1D</span><span class="p">(</span><span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span>
<a name="ln-499"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-500"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span>
<a name="ln-501"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">)</span><span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-502"></a>
<a name="ln-503"></a>    <span class="k">CALL </span><span class="n">SELFOut</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">SELFa</span> <span class="p">%</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-504"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">controlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-505"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-506"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">targetType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-507"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-508"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-509"></a>
<a name="ln-510"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-511"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-512"></a>
<a name="ln-513"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-514"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-515"></a>
<a name="ln-516"></a>  <span class="k">END FUNCTION </span><span class="n">Add_Scalar1D</span>
<a name="ln-517"></a>
<a name="ln-518"></a>  <span class="k">FUNCTION </span><span class="n">Subtract_Scalar1D</span><span class="p">(</span><span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span>
<a name="ln-519"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-520"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span>
<a name="ln-521"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar1D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-522"></a>
<a name="ln-523"></a>    <span class="k">CALL </span><span class="n">SELFOut</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">SELFa</span> <span class="p">%</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-524"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">controlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-525"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-526"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">targetType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-527"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-528"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-529"></a>
<a name="ln-530"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-531"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-532"></a>
<a name="ln-533"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-534"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-535"></a>
<a name="ln-536"></a>  <span class="k">END FUNCTION </span><span class="n">Subtract_Scalar1D</span>
<a name="ln-537"></a>
<a name="ln-538"></a><span class="c">! -- Scalar2D -- !</span>
<a name="ln-539"></a>
<a name="ln-540"></a>  <span class="k">SUBROUTINE </span><span class="n">Init_Scalar2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">quadratureType</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">targetNodeType</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nElem</span><span class="p">)</span>
<a name="ln-541"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-542"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-543"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-544"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">quadratureType</span>
<a name="ln-545"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-546"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">targetNodeType</span>
<a name="ln-547"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nVar</span>
<a name="ln-548"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-549"></a>
<a name="ln-550"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-551"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">M</span> <span class="o">=</span> <span class="n">M</span>
<a name="ln-552"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span> <span class="o">=</span> <span class="n">nVar</span>
<a name="ln-553"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-554"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">controlType</span> <span class="o">=</span> <span class="n">quadratureType</span>
<a name="ln-555"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">targetType</span> <span class="o">=</span> <span class="n">targetNodeType</span>
<a name="ln-556"></a>
<a name="ln-557"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-558"></a>                                     <span class="n">controlNodeType</span><span class="o">=</span><span class="n">quadratureType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-559"></a>                                     <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-560"></a>                                     <span class="n">targetNodeType</span><span class="o">=</span><span class="n">targetNodeType</span><span class="p">)</span>
<a name="ln-561"></a>
<a name="ln-562"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-563"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-564"></a>
<a name="ln-565"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-566"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-567"></a>
<a name="ln-568"></a>  <span class="k">END SUBROUTINE </span><span class="n">Init_Scalar2D</span>
<a name="ln-569"></a>
<a name="ln-570"></a>  <span class="k">SUBROUTINE </span><span class="n">Free_Scalar2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-571"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-572"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-573"></a>
<a name="ln-574"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-575"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-576"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-577"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-578"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-579"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-580"></a>
<a name="ln-581"></a>  <span class="k">END SUBROUTINE </span><span class="n">Free_Scalar2D</span>
<a name="ln-582"></a>
<a name="ln-583"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateHost_Scalar2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-584"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-585"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-586"></a>
<a name="ln-587"></a><span class="cp">#ifdef GPU</span>
<a name="ln-588"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-589"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-590"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-591"></a><span class="cp">#endif</span>
<a name="ln-592"></a>
<a name="ln-593"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateHost_Scalar2D</span>
<a name="ln-594"></a>
<a name="ln-595"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateDevice_Scalar2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-596"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-597"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-598"></a>
<a name="ln-599"></a><span class="cp">#ifdef GPU</span>
<a name="ln-600"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-601"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-602"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-603"></a><span class="cp">#endif</span>
<a name="ln-604"></a>
<a name="ln-605"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateDevice_Scalar2D</span>
<a name="ln-606"></a>
<a name="ln-607"></a>  <span class="k">SUBROUTINE </span><span class="n">BoundaryInterp_Scalar2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-608"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-609"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-610"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-611"></a>
<a name="ln-612"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-613"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">ScalarBoundaryInterp_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-614"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-615"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-616"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-617"></a>    <span class="k">ELSE</span>
<a name="ln-618"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">ScalarBoundaryInterp_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-619"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-620"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-621"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-622"></a>    <span class="k">END IF</span>
<a name="ln-623"></a>
<a name="ln-624"></a><span class="k">  END SUBROUTINE </span><span class="n">BoundaryInterp_Scalar2D</span>
<a name="ln-625"></a>
<a name="ln-626"></a>  <span class="k">SUBROUTINE </span><span class="n">GridInterp_Scalar2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-627"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-628"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-629"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-630"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-631"></a>
<a name="ln-632"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-633"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">ScalarGridInterp_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-634"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-635"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-636"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-637"></a>    <span class="k">ELSE</span>
<a name="ln-638"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">ScalarGridInterp_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-639"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-640"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-641"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-642"></a>    <span class="k">END IF</span>
<a name="ln-643"></a>
<a name="ln-644"></a><span class="k">  END SUBROUTINE </span><span class="n">GridInterp_Scalar2D</span>
<a name="ln-645"></a>
<a name="ln-646"></a>  <span class="k">SUBROUTINE </span><span class="n">Gradient_Scalar2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-647"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-648"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-649"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-650"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-651"></a>
<a name="ln-652"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-653"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">ScalarGradient_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-654"></a>                                                    <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-655"></a>                                                    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-656"></a>                                                    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-657"></a>    <span class="k">ELSE</span>
<a name="ln-658"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">ScalarGradient_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-659"></a>                                                    <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-660"></a>                                                    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-661"></a>                                                    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-662"></a>    <span class="k">END IF</span>
<a name="ln-663"></a>
<a name="ln-664"></a><span class="k">  END SUBROUTINE </span><span class="n">Gradient_Scalar2D</span>
<a name="ln-665"></a>
<a name="ln-666"></a>  <span class="k">FUNCTION </span><span class="n">AbsMaxInterior_Scalar2D</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">absMax</span><span class="p">)</span>
<a name="ln-667"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-668"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scalar</span>
<a name="ln-669"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">absMax</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">)</span>
<a name="ln-670"></a>    <span class="c">! Local</span>
<a name="ln-671"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span>
<a name="ln-672"></a>
<a name="ln-673"></a>    <span class="n">absMax</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-674"></a>    <span class="k">DO </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-675"></a>      <span class="k">DO </span><span class="n">iVar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nVar</span>
<a name="ln-676"></a>        <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-677"></a>          <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-678"></a>            <span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)),</span><span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">))</span>
<a name="ln-679"></a>          <span class="k">END DO</span>
<a name="ln-680"></a><span class="k">        END DO</span>
<a name="ln-681"></a><span class="k">      END DO</span>
<a name="ln-682"></a><span class="k">    END DO</span>
<a name="ln-683"></a>
<a name="ln-684"></a><span class="k">  END FUNCTION </span><span class="n">AbsMaxInterior_Scalar2D</span>
<a name="ln-685"></a>
<a name="ln-686"></a>  <span class="k">FUNCTION </span><span class="n">AbsMaxBoundary_Scalar2D</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">absMax</span><span class="p">)</span>
<a name="ln-687"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-688"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scalar</span>
<a name="ln-689"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">absMax</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-690"></a>    <span class="c">! Local</span>
<a name="ln-691"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">iSide</span>
<a name="ln-692"></a>
<a name="ln-693"></a>    <span class="n">absMax</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-694"></a>    <span class="k">DO </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-695"></a>      <span class="k">DO </span><span class="n">iSide</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-696"></a>        <span class="k">DO </span><span class="n">iVar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nVar</span>
<a name="ln-697"></a>          <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-698"></a>            <span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">,</span><span class="n">iEl</span><span class="p">)),</span><span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">))</span>
<a name="ln-699"></a>          <span class="k">END DO</span>
<a name="ln-700"></a><span class="k">        END DO</span>
<a name="ln-701"></a><span class="k">      END DO</span>
<a name="ln-702"></a><span class="k">    END DO</span>
<a name="ln-703"></a>
<a name="ln-704"></a><span class="k">  END FUNCTION </span><span class="n">AbsMaxBoundary_Scalar2D</span>
<a name="ln-705"></a>
<a name="ln-706"></a>  <span class="k">SUBROUTINE </span><span class="n">Equals_Scalar2D</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">SELFin</span><span class="p">)</span>
<a name="ln-707"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-708"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-709"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFin</span>
<a name="ln-710"></a>
<a name="ln-711"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFin</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-712"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFin</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-713"></a>
<a name="ln-714"></a>  <span class="k">END SUBROUTINE </span><span class="n">Equals_Scalar2D</span>
<a name="ln-715"></a>
<a name="ln-716"></a>  <span class="k">FUNCTION </span><span class="n">Add_Scalar2D</span><span class="p">(</span><span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span>
<a name="ln-717"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-718"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span>
<a name="ln-719"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-720"></a>
<a name="ln-721"></a>    <span class="k">CALL </span><span class="n">SELFOut</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">SELFa</span> <span class="p">%</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-722"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">controlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-723"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-724"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">targetType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-725"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-726"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-727"></a>
<a name="ln-728"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-729"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-730"></a>
<a name="ln-731"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-732"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-733"></a>
<a name="ln-734"></a>  <span class="k">END FUNCTION </span><span class="n">Add_Scalar2D</span>
<a name="ln-735"></a>
<a name="ln-736"></a>  <span class="k">FUNCTION </span><span class="n">Subtract_Scalar2D</span><span class="p">(</span><span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span>
<a name="ln-737"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-738"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span>
<a name="ln-739"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-740"></a>
<a name="ln-741"></a>    <span class="k">CALL </span><span class="n">SELFOut</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">SELFa</span> <span class="p">%</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-742"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">controlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-743"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-744"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">targetType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-745"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-746"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-747"></a>
<a name="ln-748"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-749"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-750"></a>
<a name="ln-751"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-752"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-753"></a>
<a name="ln-754"></a>  <span class="k">END FUNCTION </span><span class="n">Subtract_Scalar2D</span>
<a name="ln-755"></a>
<a name="ln-756"></a><span class="c">! -- Scalar3D -- !</span>
<a name="ln-757"></a>
<a name="ln-758"></a>  <span class="k">SUBROUTINE </span><span class="n">Init_Scalar3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">quadratureType</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">targetNodeType</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nElem</span><span class="p">)</span>
<a name="ln-759"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-760"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-761"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-762"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">quadratureType</span>
<a name="ln-763"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-764"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">targetNodeType</span>
<a name="ln-765"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nVar</span>
<a name="ln-766"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-767"></a>
<a name="ln-768"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-769"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">M</span> <span class="o">=</span> <span class="n">M</span>
<a name="ln-770"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span> <span class="o">=</span> <span class="n">nVar</span>
<a name="ln-771"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-772"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">controlType</span> <span class="o">=</span> <span class="n">quadratureType</span>
<a name="ln-773"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">targetType</span> <span class="o">=</span> <span class="n">targetNodeType</span>
<a name="ln-774"></a>
<a name="ln-775"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-776"></a>                                     <span class="n">controlNodeType</span><span class="o">=</span><span class="n">quadratureType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-777"></a>                                     <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-778"></a>                                     <span class="n">targetNodeType</span><span class="o">=</span><span class="n">targetNodeType</span><span class="p">)</span>
<a name="ln-779"></a>
<a name="ln-780"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-781"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-782"></a>
<a name="ln-783"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-784"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-785"></a>
<a name="ln-786"></a>  <span class="k">END SUBROUTINE </span><span class="n">Init_Scalar3D</span>
<a name="ln-787"></a>
<a name="ln-788"></a>  <span class="k">SUBROUTINE </span><span class="n">Free_Scalar3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-789"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-790"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-791"></a>
<a name="ln-792"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-793"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-794"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-795"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-796"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-797"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-798"></a>
<a name="ln-799"></a>  <span class="k">END SUBROUTINE </span><span class="n">Free_Scalar3D</span>
<a name="ln-800"></a>
<a name="ln-801"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateHost_Scalar3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-802"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-803"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-804"></a>
<a name="ln-805"></a><span class="cp">#ifdef GPU</span>
<a name="ln-806"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-807"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-808"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-809"></a><span class="cp">#endif</span>
<a name="ln-810"></a>
<a name="ln-811"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateHost_Scalar3D</span>
<a name="ln-812"></a>
<a name="ln-813"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateDevice_Scalar3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-814"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-815"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-816"></a>
<a name="ln-817"></a><span class="cp">#ifdef GPU</span>
<a name="ln-818"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-819"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-820"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-821"></a><span class="cp">#endif</span>
<a name="ln-822"></a>
<a name="ln-823"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateDevice_Scalar3D</span>
<a name="ln-824"></a>
<a name="ln-825"></a>  <span class="k">SUBROUTINE </span><span class="n">BoundaryInterp_Scalar3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-826"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-827"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-828"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-829"></a>
<a name="ln-830"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-831"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">ScalarBoundaryInterp_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-832"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-833"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-834"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-835"></a>    <span class="k">ELSE</span>
<a name="ln-836"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">ScalarBoundaryInterp_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-837"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-838"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-839"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-840"></a>    <span class="k">END IF</span>
<a name="ln-841"></a>
<a name="ln-842"></a><span class="k">  END SUBROUTINE </span><span class="n">BoundaryInterp_Scalar3D</span>
<a name="ln-843"></a>
<a name="ln-844"></a>  <span class="k">SUBROUTINE </span><span class="n">GridInterp_Scalar3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-845"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-846"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-847"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-848"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-849"></a>
<a name="ln-850"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-851"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">ScalarGridInterp_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-852"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-853"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-854"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-855"></a>    <span class="k">ELSE</span>
<a name="ln-856"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">ScalarGridInterp_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-857"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-858"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-859"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-860"></a>    <span class="k">END IF</span>
<a name="ln-861"></a>
<a name="ln-862"></a><span class="k">  END SUBROUTINE </span><span class="n">GridInterp_Scalar3D</span>
<a name="ln-863"></a>
<a name="ln-864"></a>  <span class="k">SUBROUTINE </span><span class="n">Gradient_Scalar3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-865"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-866"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-867"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-868"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-869"></a>
<a name="ln-870"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-871"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">ScalarGradient_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-872"></a>                                                    <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-873"></a>                                                    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-874"></a>                                                    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-875"></a>    <span class="k">ELSE</span>
<a name="ln-876"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">ScalarGradient_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-877"></a>                                                    <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-878"></a>                                                    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-879"></a>                                                    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-880"></a>    <span class="k">END IF</span>
<a name="ln-881"></a>
<a name="ln-882"></a><span class="k">  END SUBROUTINE </span><span class="n">Gradient_Scalar3D</span>
<a name="ln-883"></a>
<a name="ln-884"></a>  <span class="k">SUBROUTINE </span><span class="n">Equals_Scalar3D</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">SELFin</span><span class="p">)</span>
<a name="ln-885"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-886"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-887"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFin</span>
<a name="ln-888"></a>
<a name="ln-889"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFin</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-890"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFin</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-891"></a>
<a name="ln-892"></a>  <span class="k">END SUBROUTINE </span><span class="n">Equals_Scalar3D</span>
<a name="ln-893"></a>
<a name="ln-894"></a>  <span class="k">FUNCTION </span><span class="n">AbsMaxInterior_Scalar3D</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">absMax</span><span class="p">)</span>
<a name="ln-895"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-896"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scalar</span>
<a name="ln-897"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">absMax</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">)</span>
<a name="ln-898"></a>    <span class="c">! Local</span>
<a name="ln-899"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a name="ln-900"></a>
<a name="ln-901"></a>    <span class="n">absMax</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-902"></a>    <span class="k">DO </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-903"></a>      <span class="k">DO </span><span class="n">iVar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nVar</span>
<a name="ln-904"></a>        <span class="k">DO </span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-905"></a>          <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-906"></a>            <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-907"></a>              <span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)),</span><span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">))</span>
<a name="ln-908"></a>            <span class="k">END DO</span>
<a name="ln-909"></a><span class="k">          END DO</span>
<a name="ln-910"></a><span class="k">        END DO</span>
<a name="ln-911"></a><span class="k">      END DO</span>
<a name="ln-912"></a><span class="k">    END DO</span>
<a name="ln-913"></a>
<a name="ln-914"></a><span class="k">  END FUNCTION </span><span class="n">AbsMaxInterior_Scalar3D</span>
<a name="ln-915"></a>
<a name="ln-916"></a>  <span class="k">FUNCTION </span><span class="n">AbsMaxBoundary_Scalar3D</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">absMax</span><span class="p">)</span>
<a name="ln-917"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-918"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scalar</span>
<a name="ln-919"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">absMax</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-920"></a>    <span class="c">! Local</span>
<a name="ln-921"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">iSide</span>
<a name="ln-922"></a>
<a name="ln-923"></a>    <span class="n">absMax</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-924"></a>    <span class="k">DO </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-925"></a>      <span class="k">DO </span><span class="n">iSide</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">6</span>
<a name="ln-926"></a>        <span class="k">DO </span><span class="n">iVar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">nVar</span>
<a name="ln-927"></a>          <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-928"></a>            <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-929"></a>              <span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">scalar</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">,</span><span class="n">iEl</span><span class="p">)),</span><span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">))</span>
<a name="ln-930"></a>            <span class="k">END DO</span>
<a name="ln-931"></a><span class="k">          END DO</span>
<a name="ln-932"></a><span class="k">        END DO</span>
<a name="ln-933"></a><span class="k">      END DO</span>
<a name="ln-934"></a><span class="k">    END DO</span>
<a name="ln-935"></a>
<a name="ln-936"></a><span class="k">  END FUNCTION </span><span class="n">AbsMaxBoundary_Scalar3D</span>
<a name="ln-937"></a>
<a name="ln-938"></a>  <span class="k">FUNCTION </span><span class="n">Add_Scalar3D</span><span class="p">(</span><span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span>
<a name="ln-939"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-940"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span>
<a name="ln-941"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-942"></a>
<a name="ln-943"></a>    <span class="k">CALL </span><span class="n">SELFOut</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">SELFa</span> <span class="p">%</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-944"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">controlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-945"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-946"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">targetType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-947"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-948"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-949"></a>
<a name="ln-950"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-951"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-952"></a>
<a name="ln-953"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-954"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-955"></a>
<a name="ln-956"></a>  <span class="k">END FUNCTION </span><span class="n">Add_Scalar3D</span>
<a name="ln-957"></a>
<a name="ln-958"></a>  <span class="k">FUNCTION </span><span class="n">Subtract_Scalar3D</span><span class="p">(</span><span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span>
<a name="ln-959"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-960"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span>
<a name="ln-961"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-962"></a>
<a name="ln-963"></a>    <span class="k">CALL </span><span class="n">SELFOut</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">SELFa</span> <span class="p">%</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-964"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">controlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-965"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-966"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">targetType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-967"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-968"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-969"></a>
<a name="ln-970"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-971"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-972"></a>
<a name="ln-973"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-974"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-975"></a>
<a name="ln-976"></a>  <span class="k">END FUNCTION </span><span class="n">Subtract_Scalar3D</span>
<a name="ln-977"></a>
<a name="ln-978"></a><span class="c">! -- Vector2D -- !</span>
<a name="ln-979"></a>
<a name="ln-980"></a>  <span class="k">SUBROUTINE </span><span class="n">Init_Vector2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">quadratureType</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">targetNodeType</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nElem</span><span class="p">)</span>
<a name="ln-981"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-982"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-983"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-984"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">quadratureType</span>
<a name="ln-985"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-986"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">targetNodeType</span>
<a name="ln-987"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nVar</span>
<a name="ln-988"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-989"></a>
<a name="ln-990"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-991"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">M</span> <span class="o">=</span> <span class="n">M</span>
<a name="ln-992"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span> <span class="o">=</span> <span class="n">nVar</span>
<a name="ln-993"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-994"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">controlType</span> <span class="o">=</span> <span class="n">quadratureType</span>
<a name="ln-995"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">targetType</span> <span class="o">=</span> <span class="n">targetNodeType</span>
<a name="ln-996"></a>
<a name="ln-997"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-998"></a>                                     <span class="n">controlNodeType</span><span class="o">=</span><span class="n">quadratureType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-999"></a>                                     <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1000"></a>                                     <span class="n">targetNodeType</span><span class="o">=</span><span class="n">targetNodeType</span><span class="p">)</span>
<a name="ln-1001"></a>
<a name="ln-1002"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1003"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1004"></a>
<a name="ln-1005"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1006"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1007"></a>
<a name="ln-1008"></a>  <span class="k">END SUBROUTINE </span><span class="n">Init_Vector2D</span>
<a name="ln-1009"></a>
<a name="ln-1010"></a>  <span class="k">SUBROUTINE </span><span class="n">Free_Vector2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-1011"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1012"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1013"></a>
<a name="ln-1014"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1015"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1016"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1017"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1018"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1019"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1020"></a>
<a name="ln-1021"></a>  <span class="k">END SUBROUTINE </span><span class="n">Free_Vector2D</span>
<a name="ln-1022"></a>
<a name="ln-1023"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateHost_Vector2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-1024"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1025"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1026"></a>
<a name="ln-1027"></a><span class="cp">#ifdef GPU</span>
<a name="ln-1028"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1029"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1030"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1031"></a><span class="cp">#endif</span>
<a name="ln-1032"></a>
<a name="ln-1033"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateHost_Vector2D</span>
<a name="ln-1034"></a>
<a name="ln-1035"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateDevice_Vector2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-1036"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1037"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1038"></a>
<a name="ln-1039"></a><span class="cp">#ifdef GPU</span>
<a name="ln-1040"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1041"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1042"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1043"></a><span class="cp">#endif</span>
<a name="ln-1044"></a>
<a name="ln-1045"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateDevice_Vector2D</span>
<a name="ln-1046"></a>
<a name="ln-1047"></a>  <span class="k">SUBROUTINE </span><span class="n">BoundaryInterp_Vector2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1048"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1049"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1050"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1051"></a>
<a name="ln-1052"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1053"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorBoundaryInterp_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1054"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1055"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1056"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1057"></a>    <span class="k">ELSE</span>
<a name="ln-1058"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorBoundaryInterp_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1059"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1060"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1061"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1062"></a>    <span class="k">END IF</span>
<a name="ln-1063"></a>
<a name="ln-1064"></a><span class="k">  END SUBROUTINE </span><span class="n">BoundaryInterp_Vector2D</span>
<a name="ln-1065"></a>
<a name="ln-1066"></a>  <span class="k">SUBROUTINE </span><span class="n">GridInterp_Vector2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1067"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1068"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1069"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1070"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1071"></a>
<a name="ln-1072"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1073"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorGridInterp_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1074"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1075"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1076"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1077"></a>    <span class="k">ELSE</span>
<a name="ln-1078"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorGridInterp_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1079"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1080"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1081"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1082"></a>    <span class="k">END IF</span>
<a name="ln-1083"></a>
<a name="ln-1084"></a><span class="k">  END SUBROUTINE </span><span class="n">GridInterp_Vector2D</span>
<a name="ln-1085"></a>
<a name="ln-1086"></a>  <span class="k">SUBROUTINE </span><span class="n">Gradient_Vector2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1087"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1088"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1089"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1090"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1091"></a>
<a name="ln-1092"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1093"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorGradient_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1094"></a>                                                    <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1095"></a>                                                    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1096"></a>                                                    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1097"></a>    <span class="k">ELSE</span>
<a name="ln-1098"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorGradient_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1099"></a>                                                    <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1100"></a>                                                    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1101"></a>                                                    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1102"></a>    <span class="k">END IF</span>
<a name="ln-1103"></a>
<a name="ln-1104"></a><span class="k">  END SUBROUTINE </span><span class="n">Gradient_Vector2D</span>
<a name="ln-1105"></a>
<a name="ln-1106"></a>  <span class="k">SUBROUTINE </span><span class="n">Divergence_Vector2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">dForm</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1107"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1108"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1109"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1110"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dForm</span>
<a name="ln-1111"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1112"></a>
<a name="ln-1113"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">dForm</span> <span class="o">==</span> <span class="n">selfWeakDGForm</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1114"></a>
<a name="ln-1115"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1116"></a><span class="k">        CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorDGDivergence_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1117"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1118"></a>                                                          <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1119"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1120"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1121"></a>      <span class="k">ELSE</span>
<a name="ln-1122"></a><span class="k">        CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorDGDivergence_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1123"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1124"></a>                                                          <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1125"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1126"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1127"></a>      <span class="k">END IF</span>
<a name="ln-1128"></a>
<a name="ln-1129"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">dForm</span> <span class="o">==</span> <span class="n">selfStrongForm</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1130"></a>
<a name="ln-1131"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1132"></a><span class="k">        CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorDivergence_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1133"></a>                                                        <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1134"></a>                                                        <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1135"></a>                                                        <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1136"></a>      <span class="k">ELSE</span>
<a name="ln-1137"></a><span class="k">        CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorDivergence_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1138"></a>                                                        <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1139"></a>                                                        <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1140"></a>                                                        <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1141"></a>      <span class="k">END IF</span>
<a name="ln-1142"></a>
<a name="ln-1143"></a><span class="k">    END IF</span>
<a name="ln-1144"></a>
<a name="ln-1145"></a><span class="k">  END SUBROUTINE </span><span class="n">Divergence_Vector2D</span>
<a name="ln-1146"></a>
<a name="ln-1147"></a>  <span class="k">SUBROUTINE </span><span class="n">Curl_Vector2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1148"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1149"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1150"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1151"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1152"></a>
<a name="ln-1153"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1154"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorCurl_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1155"></a>                                                <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1156"></a>                                                <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1157"></a>                                                <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1158"></a>    <span class="k">ELSE</span>
<a name="ln-1159"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorCurl_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1160"></a>                                                <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1161"></a>                                                <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1162"></a>                                                <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1163"></a>    <span class="k">END IF</span>
<a name="ln-1164"></a>
<a name="ln-1165"></a><span class="k">  END SUBROUTINE </span><span class="n">Curl_Vector2D</span>
<a name="ln-1166"></a>
<a name="ln-1167"></a>  <span class="k">SUBROUTINE </span><span class="n">Equals_Vector2D</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">SELFin</span><span class="p">)</span>
<a name="ln-1168"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1169"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1170"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFin</span>
<a name="ln-1171"></a>
<a name="ln-1172"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFin</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1173"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFin</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1174"></a>
<a name="ln-1175"></a>  <span class="k">END SUBROUTINE </span><span class="n">Equals_Vector2D</span>
<a name="ln-1176"></a>
<a name="ln-1177"></a>  <span class="k">FUNCTION </span><span class="n">AbsMaxInterior_Vector2D</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">absMax</span><span class="p">)</span>
<a name="ln-1178"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1179"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vector</span>
<a name="ln-1180"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">absMax</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">vector</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">)</span>
<a name="ln-1181"></a>    <span class="c">! Local</span>
<a name="ln-1182"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">iDir</span>
<a name="ln-1183"></a>
<a name="ln-1184"></a>    <span class="n">absMax</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-1185"></a>    <span class="k">DO </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">vector</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-1186"></a>      <span class="k">DO </span><span class="n">iVar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">vector</span> <span class="p">%</span> <span class="n">nVar</span>
<a name="ln-1187"></a>        <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">vector</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1188"></a>          <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">vector</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1189"></a>            <span class="k">DO </span><span class="n">iDir</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-1190"></a>              <span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">vector</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">iDir</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)),</span><span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">))</span>
<a name="ln-1191"></a>            <span class="k">END DO</span>
<a name="ln-1192"></a><span class="k">          END DO</span>
<a name="ln-1193"></a><span class="k">        END DO</span>
<a name="ln-1194"></a><span class="k">      END DO</span>
<a name="ln-1195"></a><span class="k">    END DO</span>
<a name="ln-1196"></a>
<a name="ln-1197"></a><span class="k">  END FUNCTION </span><span class="n">AbsMaxInterior_Vector2D</span>
<a name="ln-1198"></a>
<a name="ln-1199"></a>  <span class="k">FUNCTION </span><span class="n">AbsMaxBoundary_Vector2D</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">absMax</span><span class="p">)</span>
<a name="ln-1200"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1201"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vector</span>
<a name="ln-1202"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">absMax</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">vector</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1203"></a>    <span class="c">! Local</span>
<a name="ln-1204"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">iDir</span><span class="p">,</span><span class="n">iSide</span>
<a name="ln-1205"></a>
<a name="ln-1206"></a>    <span class="n">absMax</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-1207"></a>    <span class="k">DO </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">vector</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-1208"></a>      <span class="k">DO </span><span class="n">iSide</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-1209"></a>        <span class="k">DO </span><span class="n">iVar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">vector</span> <span class="p">%</span> <span class="n">nVar</span>
<a name="ln-1210"></a>          <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">vector</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1211"></a>            <span class="k">DO </span><span class="n">iDir</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-1212"></a>              <span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">vector</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">iDir</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">,</span><span class="n">iEl</span><span class="p">)),</span><span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">))</span>
<a name="ln-1213"></a>            <span class="k">END DO</span>
<a name="ln-1214"></a><span class="k">          END DO</span>
<a name="ln-1215"></a><span class="k">        END DO</span>
<a name="ln-1216"></a><span class="k">      END DO</span>
<a name="ln-1217"></a><span class="k">    END DO</span>
<a name="ln-1218"></a>
<a name="ln-1219"></a><span class="k">  END FUNCTION </span><span class="n">AbsMaxBoundary_Vector2D</span>
<a name="ln-1220"></a>
<a name="ln-1221"></a>  <span class="k">FUNCTION </span><span class="n">Add_Vector2D</span><span class="p">(</span><span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span>
<a name="ln-1222"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1223"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span>
<a name="ln-1224"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1225"></a>
<a name="ln-1226"></a>    <span class="k">CALL </span><span class="n">SELFOut</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">SELFa</span> <span class="p">%</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1227"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">controlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1228"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1229"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">targetType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1230"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1231"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1232"></a>
<a name="ln-1233"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1234"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1235"></a>
<a name="ln-1236"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1237"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1238"></a>
<a name="ln-1239"></a>  <span class="k">END FUNCTION </span><span class="n">Add_Vector2D</span>
<a name="ln-1240"></a>
<a name="ln-1241"></a>  <span class="k">FUNCTION </span><span class="n">Subtract_Vector2D</span><span class="p">(</span><span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span>
<a name="ln-1242"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1243"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span>
<a name="ln-1244"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1245"></a>
<a name="ln-1246"></a>    <span class="k">CALL </span><span class="n">SELFOut</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">SELFa</span> <span class="p">%</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1247"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">controlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1248"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1249"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">targetType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1250"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1251"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1252"></a>
<a name="ln-1253"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1254"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1255"></a>
<a name="ln-1256"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1257"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1258"></a>
<a name="ln-1259"></a>  <span class="k">END FUNCTION </span><span class="n">Subtract_Vector2D</span>
<a name="ln-1260"></a>
<a name="ln-1261"></a><span class="c">! -- Vector3D -- !</span>
<a name="ln-1262"></a>
<a name="ln-1263"></a>  <span class="k">SUBROUTINE </span><span class="n">Init_Vector3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">quadratureType</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">targetNodeType</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nElem</span><span class="p">)</span>
<a name="ln-1264"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1265"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1266"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-1267"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">quadratureType</span>
<a name="ln-1268"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-1269"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">targetNodeType</span>
<a name="ln-1270"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nVar</span>
<a name="ln-1271"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-1272"></a>
<a name="ln-1273"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-1274"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">M</span> <span class="o">=</span> <span class="n">M</span>
<a name="ln-1275"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span> <span class="o">=</span> <span class="n">nVar</span>
<a name="ln-1276"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-1277"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">controlType</span> <span class="o">=</span> <span class="n">quadratureType</span>
<a name="ln-1278"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">targetType</span> <span class="o">=</span> <span class="n">targetNodeType</span>
<a name="ln-1279"></a>
<a name="ln-1280"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1281"></a>                                     <span class="n">controlNodeType</span><span class="o">=</span><span class="n">quadratureType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1282"></a>                                     <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1283"></a>                                     <span class="n">targetNodeType</span><span class="o">=</span><span class="n">targetNodeType</span><span class="p">)</span>
<a name="ln-1284"></a>
<a name="ln-1285"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1286"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1287"></a>
<a name="ln-1288"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1289"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1290"></a>
<a name="ln-1291"></a>  <span class="k">END SUBROUTINE </span><span class="n">Init_Vector3D</span>
<a name="ln-1292"></a>
<a name="ln-1293"></a>  <span class="k">SUBROUTINE </span><span class="n">Free_Vector3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-1294"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1295"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1296"></a>
<a name="ln-1297"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1298"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1299"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1300"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1301"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1302"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1303"></a>
<a name="ln-1304"></a>  <span class="k">END SUBROUTINE </span><span class="n">Free_Vector3D</span>
<a name="ln-1305"></a>
<a name="ln-1306"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateHost_Vector3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-1307"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1308"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1309"></a>
<a name="ln-1310"></a><span class="cp">#ifdef GPU</span>
<a name="ln-1311"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1312"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1313"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1314"></a><span class="cp">#endif</span>
<a name="ln-1315"></a>
<a name="ln-1316"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateHost_Vector3D</span>
<a name="ln-1317"></a>
<a name="ln-1318"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateDevice_Vector3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-1319"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1320"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1321"></a>
<a name="ln-1322"></a><span class="cp">#ifdef GPU</span>
<a name="ln-1323"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1324"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1325"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1326"></a><span class="cp">#endif</span>
<a name="ln-1327"></a>
<a name="ln-1328"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateDevice_Vector3D</span>
<a name="ln-1329"></a>
<a name="ln-1330"></a>  <span class="k">SUBROUTINE </span><span class="n">BoundaryInterp_Vector3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1331"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1332"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1333"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1334"></a>
<a name="ln-1335"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1336"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorBoundaryInterp_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1337"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1338"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1339"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1340"></a>    <span class="k">ELSE</span>
<a name="ln-1341"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorBoundaryInterp_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1342"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1343"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1344"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1345"></a>    <span class="k">END IF</span>
<a name="ln-1346"></a>
<a name="ln-1347"></a><span class="k">  END SUBROUTINE </span><span class="n">BoundaryInterp_Vector3D</span>
<a name="ln-1348"></a>
<a name="ln-1349"></a>  <span class="k">SUBROUTINE </span><span class="n">GridInterp_Vector3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1350"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1351"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1352"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1353"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1354"></a>
<a name="ln-1355"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1356"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorGridInterp_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1357"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1358"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1359"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1360"></a>    <span class="k">ELSE</span>
<a name="ln-1361"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorGridInterp_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1362"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1363"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1364"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1365"></a>    <span class="k">END IF</span>
<a name="ln-1366"></a>
<a name="ln-1367"></a><span class="k">  END SUBROUTINE </span><span class="n">GridInterp_Vector3D</span>
<a name="ln-1368"></a>
<a name="ln-1369"></a>  <span class="k">SUBROUTINE </span><span class="n">Gradient_Vector3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1370"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1371"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1372"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1373"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1374"></a>
<a name="ln-1375"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1376"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorGradient_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1377"></a>                                                    <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1378"></a>                                                    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1379"></a>                                                    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1380"></a>    <span class="k">ELSE</span>
<a name="ln-1381"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorGradient_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1382"></a>                                                    <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1383"></a>                                                    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1384"></a>                                                    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1385"></a>    <span class="k">END IF</span>
<a name="ln-1386"></a>
<a name="ln-1387"></a><span class="k">  END SUBROUTINE </span><span class="n">Gradient_Vector3D</span>
<a name="ln-1388"></a>
<a name="ln-1389"></a>  <span class="k">SUBROUTINE </span><span class="n">Divergence_Vector3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1390"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1391"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1392"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1393"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1394"></a>
<a name="ln-1395"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1396"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorDivergence_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1397"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1398"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1399"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1400"></a>    <span class="k">ELSE</span>
<a name="ln-1401"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorDivergence_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1402"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1403"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1404"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1405"></a>    <span class="k">END IF</span>
<a name="ln-1406"></a>
<a name="ln-1407"></a><span class="k">  END SUBROUTINE </span><span class="n">Divergence_Vector3D</span>
<a name="ln-1408"></a>
<a name="ln-1409"></a>  <span class="k">SUBROUTINE </span><span class="n">Curl_Vector3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1410"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1411"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1412"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1413"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1414"></a>
<a name="ln-1415"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1416"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorCurl_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1417"></a>                                                <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1418"></a>                                                <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1419"></a>                                                <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1420"></a>    <span class="k">ELSE</span>
<a name="ln-1421"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">VectorCurl_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1422"></a>                                                <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1423"></a>                                                <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1424"></a>                                                <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1425"></a>    <span class="k">END IF</span>
<a name="ln-1426"></a>
<a name="ln-1427"></a><span class="k">  END SUBROUTINE </span><span class="n">Curl_Vector3D</span>
<a name="ln-1428"></a>
<a name="ln-1429"></a>  <span class="k">FUNCTION </span><span class="n">AbsMaxInterior_Vector3D</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">absMax</span><span class="p">)</span>
<a name="ln-1430"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1431"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vector</span>
<a name="ln-1432"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">absMax</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">vector</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">)</span>
<a name="ln-1433"></a>    <span class="c">! Local</span>
<a name="ln-1434"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iDir</span>
<a name="ln-1435"></a>
<a name="ln-1436"></a>    <span class="n">absMax</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-1437"></a>    <span class="k">DO </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">vector</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-1438"></a>      <span class="k">DO </span><span class="n">iVar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">vector</span> <span class="p">%</span> <span class="n">nVar</span>
<a name="ln-1439"></a>        <span class="k">DO </span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">vector</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1440"></a>          <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">vector</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1441"></a>            <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">vector</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1442"></a>              <span class="k">DO </span><span class="n">iDir</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-1443"></a>                <span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">vector</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">iDir</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)),</span><span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">))</span>
<a name="ln-1444"></a>              <span class="k">END DO</span>
<a name="ln-1445"></a><span class="k">            END DO</span>
<a name="ln-1446"></a><span class="k">          END DO</span>
<a name="ln-1447"></a><span class="k">        END DO</span>
<a name="ln-1448"></a><span class="k">      END DO</span>
<a name="ln-1449"></a><span class="k">    END DO</span>
<a name="ln-1450"></a>
<a name="ln-1451"></a><span class="k">  END FUNCTION </span><span class="n">AbsMaxInterior_Vector3D</span>
<a name="ln-1452"></a>
<a name="ln-1453"></a>  <span class="k">FUNCTION </span><span class="n">AbsMaxBoundary_Vector3D</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">absMax</span><span class="p">)</span>
<a name="ln-1454"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1455"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vector</span>
<a name="ln-1456"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">absMax</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">vector</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1457"></a>    <span class="c">! Local</span>
<a name="ln-1458"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">iSide</span><span class="p">,</span><span class="n">iDir</span>
<a name="ln-1459"></a>
<a name="ln-1460"></a>    <span class="n">absMax</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-1461"></a>    <span class="k">DO </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">vector</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-1462"></a>      <span class="k">DO </span><span class="n">iSide</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">6</span>
<a name="ln-1463"></a>        <span class="k">DO </span><span class="n">iVar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">vector</span> <span class="p">%</span> <span class="n">nVar</span>
<a name="ln-1464"></a>          <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">vector</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1465"></a>            <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">vector</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1466"></a>              <span class="k">DO </span><span class="n">iDir</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-1467"></a>                <span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">vector</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">iDir</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">,</span><span class="n">iEl</span><span class="p">)),</span><span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">))</span>
<a name="ln-1468"></a>              <span class="k">END DO</span>
<a name="ln-1469"></a><span class="k">            END DO</span>
<a name="ln-1470"></a><span class="k">          END DO</span>
<a name="ln-1471"></a><span class="k">        END DO</span>
<a name="ln-1472"></a><span class="k">      END DO</span>
<a name="ln-1473"></a><span class="k">    END DO</span>
<a name="ln-1474"></a>
<a name="ln-1475"></a><span class="k">  END FUNCTION </span><span class="n">AbsMaxBoundary_Vector3D</span>
<a name="ln-1476"></a>
<a name="ln-1477"></a>  <span class="k">SUBROUTINE </span><span class="n">Equals_Vector3D</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">SELFin</span><span class="p">)</span>
<a name="ln-1478"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1479"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1480"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFin</span>
<a name="ln-1481"></a>
<a name="ln-1482"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFin</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1483"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFin</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1484"></a>
<a name="ln-1485"></a>  <span class="k">END SUBROUTINE </span><span class="n">Equals_Vector3D</span>
<a name="ln-1486"></a>
<a name="ln-1487"></a>  <span class="k">FUNCTION </span><span class="n">Add_Vector3D</span><span class="p">(</span><span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span>
<a name="ln-1488"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1489"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span>
<a name="ln-1490"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1491"></a>
<a name="ln-1492"></a>    <span class="k">CALL </span><span class="n">SELFOut</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">SELFa</span> <span class="p">%</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1493"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">controlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1494"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1495"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">targetType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1496"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1497"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1498"></a>
<a name="ln-1499"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1500"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1501"></a>
<a name="ln-1502"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1503"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1504"></a>
<a name="ln-1505"></a>  <span class="k">END FUNCTION </span><span class="n">Add_Vector3D</span>
<a name="ln-1506"></a>
<a name="ln-1507"></a>  <span class="k">FUNCTION </span><span class="n">Subtract_Vector3D</span><span class="p">(</span><span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span>
<a name="ln-1508"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1509"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span>
<a name="ln-1510"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1511"></a>
<a name="ln-1512"></a>    <span class="k">CALL </span><span class="n">SELFOut</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">SELFa</span> <span class="p">%</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1513"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">controlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1514"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1515"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">targetType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1516"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1517"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1518"></a>
<a name="ln-1519"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1520"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1521"></a>
<a name="ln-1522"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1523"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1524"></a>
<a name="ln-1525"></a>  <span class="k">END FUNCTION </span><span class="n">Subtract_Vector3D</span>
<a name="ln-1526"></a>
<a name="ln-1527"></a><span class="c">! -- Tensor2D -- !</span>
<a name="ln-1528"></a>
<a name="ln-1529"></a>  <span class="k">SUBROUTINE </span><span class="n">Init_Tensor2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">quadratureType</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">targetNodeType</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nElem</span><span class="p">)</span>
<a name="ln-1530"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1531"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1532"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-1533"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">quadratureType</span>
<a name="ln-1534"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-1535"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">targetNodeType</span>
<a name="ln-1536"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nVar</span>
<a name="ln-1537"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-1538"></a>
<a name="ln-1539"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-1540"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">M</span> <span class="o">=</span> <span class="n">M</span>
<a name="ln-1541"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span> <span class="o">=</span> <span class="n">nVar</span>
<a name="ln-1542"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-1543"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">controlType</span> <span class="o">=</span> <span class="n">quadratureType</span>
<a name="ln-1544"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">targetType</span> <span class="o">=</span> <span class="n">targetNodeType</span>
<a name="ln-1545"></a>
<a name="ln-1546"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1547"></a>                                     <span class="n">controlNodeType</span><span class="o">=</span><span class="n">quadratureType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1548"></a>                                     <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1549"></a>                                     <span class="n">targetNodeType</span><span class="o">=</span><span class="n">targetNodeType</span><span class="p">)</span>
<a name="ln-1550"></a>
<a name="ln-1551"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1552"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1553"></a>
<a name="ln-1554"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1555"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1556"></a>
<a name="ln-1557"></a>  <span class="k">END SUBROUTINE </span><span class="n">Init_Tensor2D</span>
<a name="ln-1558"></a>
<a name="ln-1559"></a>  <span class="k">SUBROUTINE </span><span class="n">Free_Tensor2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-1560"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1561"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1562"></a>
<a name="ln-1563"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1564"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1565"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1566"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1567"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1568"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1569"></a>
<a name="ln-1570"></a>  <span class="k">END SUBROUTINE </span><span class="n">Free_Tensor2D</span>
<a name="ln-1571"></a>
<a name="ln-1572"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateHost_Tensor2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-1573"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1574"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1575"></a>
<a name="ln-1576"></a><span class="cp">#ifdef GPU</span>
<a name="ln-1577"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1578"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1579"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1580"></a><span class="cp">#endif</span>
<a name="ln-1581"></a>
<a name="ln-1582"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateHost_Tensor2D</span>
<a name="ln-1583"></a>
<a name="ln-1584"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateDevice_Tensor2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-1585"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1586"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1587"></a>
<a name="ln-1588"></a><span class="cp">#ifdef GPU</span>
<a name="ln-1589"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1590"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1591"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1592"></a><span class="cp">#endif</span>
<a name="ln-1593"></a>
<a name="ln-1594"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateDevice_Tensor2D</span>
<a name="ln-1595"></a>
<a name="ln-1596"></a>  <span class="k">SUBROUTINE </span><span class="n">BoundaryInterp_Tensor2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1597"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1598"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1599"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1600"></a>
<a name="ln-1601"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1602"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">TensorBoundaryInterp_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1603"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1604"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1605"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1606"></a>    <span class="k">ELSE</span>
<a name="ln-1607"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">TensorBoundaryInterp_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1608"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1609"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1610"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1611"></a>    <span class="k">END IF</span>
<a name="ln-1612"></a>
<a name="ln-1613"></a><span class="k">  END SUBROUTINE </span><span class="n">BoundaryInterp_Tensor2D</span>
<a name="ln-1614"></a>
<a name="ln-1615"></a>  <span class="k">SUBROUTINE </span><span class="n">GridInterp_Tensor2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1616"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1617"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1618"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1619"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1620"></a>
<a name="ln-1621"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1622"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">TensorGridInterp_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1623"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1624"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1625"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1626"></a>    <span class="k">ELSE</span>
<a name="ln-1627"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">TensorGridInterp_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1628"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1629"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1630"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1631"></a>    <span class="k">END IF</span>
<a name="ln-1632"></a>
<a name="ln-1633"></a><span class="k">  END SUBROUTINE </span><span class="n">GridInterp_Tensor2D</span>
<a name="ln-1634"></a>
<a name="ln-1635"></a>  <span class="k">SUBROUTINE </span><span class="n">Divergence_Tensor2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1636"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1637"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1638"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1639"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1640"></a>
<a name="ln-1641"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1642"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">TensorDivergence_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1643"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1644"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1645"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1646"></a>    <span class="k">ELSE</span>
<a name="ln-1647"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">TensorDivergence_2D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1648"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1649"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1650"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1651"></a>    <span class="k">END IF</span>
<a name="ln-1652"></a>
<a name="ln-1653"></a><span class="k">  END SUBROUTINE </span><span class="n">Divergence_Tensor2D</span>
<a name="ln-1654"></a>
<a name="ln-1655"></a>  <span class="k">SUBROUTINE </span><span class="n">Determinant_Tensor2D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFout</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1656"></a><span class="cp">#undef __FUNC__</span>
<a name="ln-1657"></a><span class="cp">#define __FUNC__ &quot;Determinant_Tensor2D&quot;</span>
<a name="ln-1658"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1659"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1660"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1661"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1662"></a>    <span class="c">! Local</span>
<a name="ln-1663"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span>
<a name="ln-1664"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="kd">::</span> <span class="n">msg</span>
<a name="ln-1665"></a>
<a name="ln-1666"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1667"></a><span class="cp">#ifdef GPU</span>
<a name="ln-1668"></a>      <span class="k">CALL </span><span class="n">Determinant_Tensor2D_gpu_wrapper</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1669"></a>                                            <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1670"></a>                                            <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1671"></a>                                            <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1672"></a>                                            <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1673"></a><span class="cp">#else</span>
<a name="ln-1674"></a>     <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;GPU Acceleration currently not enabled in SELF&quot;</span>
<a name="ln-1675"></a>     <span class="n">WARNING</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a name="ln-1676"></a><span class="cp">#endif</span>
<a name="ln-1677"></a>
<a name="ln-1678"></a>    <span class="k">ELSE</span>
<a name="ln-1679"></a>
<a name="ln-1680"></a><span class="k">      DO </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-1681"></a>        <span class="k">DO </span><span class="n">iVar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span>
<a name="ln-1682"></a>          <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1683"></a>            <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1684"></a>  
<a name="ln-1685"></a>              <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span> <span class="o">=</span> <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1686"></a>                                                            <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1687"></a>                                                            <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1688"></a>                                                            <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span>
<a name="ln-1689"></a>  
<a name="ln-1690"></a>            <span class="k">END DO</span>
<a name="ln-1691"></a><span class="k">          END DO</span>
<a name="ln-1692"></a><span class="k">        END DO</span>
<a name="ln-1693"></a><span class="k">      END DO</span>
<a name="ln-1694"></a>
<a name="ln-1695"></a><span class="k">    ENDIF</span>
<a name="ln-1696"></a>
<a name="ln-1697"></a><span class="k">  END SUBROUTINE </span><span class="n">Determinant_Tensor2D</span>
<a name="ln-1698"></a>
<a name="ln-1699"></a>  <span class="k">FUNCTION </span><span class="n">AbsMaxInterior_Tensor2D</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">absMax</span><span class="p">)</span>
<a name="ln-1700"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1701"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tensor</span>
<a name="ln-1702"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">absMax</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">)</span>
<a name="ln-1703"></a>    <span class="c">! Local</span>
<a name="ln-1704"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="n">col</span>
<a name="ln-1705"></a>
<a name="ln-1706"></a>    <span class="n">absMax</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-1707"></a>    <span class="k">DO </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-1708"></a>      <span class="k">DO </span><span class="n">iVar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">nVar</span>
<a name="ln-1709"></a>        <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1710"></a>          <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1711"></a>            <span class="k">DO </span><span class="n">col</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-1712"></a>              <span class="k">DO </span><span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-1713"></a>                <span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)),</span><span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">))</span>
<a name="ln-1714"></a>              <span class="k">END DO</span>
<a name="ln-1715"></a><span class="k">            END DO</span>
<a name="ln-1716"></a><span class="k">          END DO</span>
<a name="ln-1717"></a><span class="k">        END DO</span>
<a name="ln-1718"></a><span class="k">      END DO</span>
<a name="ln-1719"></a><span class="k">    END DO</span>
<a name="ln-1720"></a>
<a name="ln-1721"></a><span class="k">  END FUNCTION </span><span class="n">AbsMaxInterior_Tensor2D</span>
<a name="ln-1722"></a>
<a name="ln-1723"></a>  <span class="k">FUNCTION </span><span class="n">AbsMaxBoundary_Tensor2D</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">absMax</span><span class="p">)</span>
<a name="ln-1724"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1725"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tensor</span>
<a name="ln-1726"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">absMax</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1727"></a>    <span class="c">! Local</span>
<a name="ln-1728"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">iSide</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="n">col</span>
<a name="ln-1729"></a>
<a name="ln-1730"></a>    <span class="n">absMax</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-1731"></a>    <span class="k">DO </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-1732"></a>      <span class="k">DO </span><span class="n">iSide</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-1733"></a>        <span class="k">DO </span><span class="n">iVar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">nVar</span>
<a name="ln-1734"></a>          <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1735"></a>            <span class="k">DO </span><span class="n">col</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-1736"></a>              <span class="k">DO </span><span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-1737"></a>                <span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">,</span><span class="n">iEl</span><span class="p">)),</span><span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">))</span>
<a name="ln-1738"></a>              <span class="k">END DO</span>
<a name="ln-1739"></a><span class="k">            END DO</span>
<a name="ln-1740"></a><span class="k">          END DO</span>
<a name="ln-1741"></a><span class="k">        END DO</span>
<a name="ln-1742"></a><span class="k">      END DO</span>
<a name="ln-1743"></a><span class="k">    END DO</span>
<a name="ln-1744"></a>
<a name="ln-1745"></a><span class="k">  END FUNCTION </span><span class="n">AbsMaxBoundary_Tensor2D</span>
<a name="ln-1746"></a>
<a name="ln-1747"></a>  <span class="k">SUBROUTINE </span><span class="n">Equals_Tensor2D</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">SELFin</span><span class="p">)</span>
<a name="ln-1748"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1749"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1750"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFin</span>
<a name="ln-1751"></a>
<a name="ln-1752"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFin</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1753"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFin</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1754"></a>
<a name="ln-1755"></a>  <span class="k">END SUBROUTINE </span><span class="n">Equals_Tensor2D</span>
<a name="ln-1756"></a>
<a name="ln-1757"></a>  <span class="k">FUNCTION </span><span class="n">Add_Tensor2D</span><span class="p">(</span><span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span>
<a name="ln-1758"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1759"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span>
<a name="ln-1760"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1761"></a>
<a name="ln-1762"></a>    <span class="k">CALL </span><span class="n">SELFOut</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">SELFa</span> <span class="p">%</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1763"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">controlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1764"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1765"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">targetType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1766"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1767"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1768"></a>
<a name="ln-1769"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1770"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1771"></a>
<a name="ln-1772"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1773"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1774"></a>
<a name="ln-1775"></a>  <span class="k">END FUNCTION </span><span class="n">Add_Tensor2D</span>
<a name="ln-1776"></a>
<a name="ln-1777"></a>  <span class="k">FUNCTION </span><span class="n">Subtract_Tensor2D</span><span class="p">(</span><span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span>
<a name="ln-1778"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1779"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span>
<a name="ln-1780"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Tensor2D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1781"></a>
<a name="ln-1782"></a>    <span class="k">CALL </span><span class="n">SELFOut</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">SELFa</span> <span class="p">%</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1783"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">controlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1784"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1785"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">targetType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1786"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1787"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1788"></a>
<a name="ln-1789"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1790"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1791"></a>
<a name="ln-1792"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1793"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-1794"></a>
<a name="ln-1795"></a>  <span class="k">END FUNCTION </span><span class="n">Subtract_Tensor2D</span>
<a name="ln-1796"></a>
<a name="ln-1797"></a><span class="c">! -- Tensor3D -- !</span>
<a name="ln-1798"></a>
<a name="ln-1799"></a>  <span class="k">SUBROUTINE </span><span class="n">Init_Tensor3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">quadratureType</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">targetNodeType</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nElem</span><span class="p">)</span>
<a name="ln-1800"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1801"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1802"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-1803"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">quadratureType</span>
<a name="ln-1804"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-1805"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">targetNodeType</span>
<a name="ln-1806"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nVar</span>
<a name="ln-1807"></a>    <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nElem</span>
<a name="ln-1808"></a>
<a name="ln-1809"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-1810"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">M</span> <span class="o">=</span> <span class="n">M</span>
<a name="ln-1811"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span> <span class="o">=</span> <span class="n">nVar</span>
<a name="ln-1812"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="n">nElem</span>
<a name="ln-1813"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">controlType</span> <span class="o">=</span> <span class="n">quadratureType</span>
<a name="ln-1814"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">targetType</span> <span class="o">=</span> <span class="n">targetNodeType</span>
<a name="ln-1815"></a>
<a name="ln-1816"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1817"></a>                                     <span class="n">controlNodeType</span><span class="o">=</span><span class="n">quadratureType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1818"></a>                                     <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1819"></a>                                     <span class="n">targetNodeType</span><span class="o">=</span><span class="n">targetNodeType</span><span class="p">)</span>
<a name="ln-1820"></a>
<a name="ln-1821"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1822"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1823"></a>
<a name="ln-1824"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">loBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1825"></a>                                        <span class="n">upBound</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">nVar</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">nElem</span><span class="o">/</span><span class="p">))</span>
<a name="ln-1826"></a>
<a name="ln-1827"></a>  <span class="k">END SUBROUTINE </span><span class="n">Init_Tensor3D</span>
<a name="ln-1828"></a>
<a name="ln-1829"></a>  <span class="k">SUBROUTINE </span><span class="n">Free_Tensor3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-1830"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1831"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1832"></a>
<a name="ln-1833"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1834"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1835"></a>    <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1836"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1837"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1838"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">Free</span><span class="p">()</span>
<a name="ln-1839"></a>
<a name="ln-1840"></a>  <span class="k">END SUBROUTINE </span><span class="n">Free_Tensor3D</span>
<a name="ln-1841"></a>
<a name="ln-1842"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateHost_Tensor3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-1843"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1844"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1845"></a>
<a name="ln-1846"></a><span class="cp">#ifdef GPU</span>
<a name="ln-1847"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1848"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1849"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">UpdateHost</span><span class="p">()</span>
<a name="ln-1850"></a><span class="cp">#endif</span>
<a name="ln-1851"></a>
<a name="ln-1852"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateHost_Tensor3D</span>
<a name="ln-1853"></a>
<a name="ln-1854"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateDevice_Tensor3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">)</span>
<a name="ln-1855"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1856"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1857"></a>
<a name="ln-1858"></a><span class="cp">#ifdef GPU</span>
<a name="ln-1859"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1860"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1861"></a>    <span class="k">CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">UpdateDevice</span><span class="p">()</span>
<a name="ln-1862"></a><span class="cp">#endif</span>
<a name="ln-1863"></a>
<a name="ln-1864"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateDevice_Tensor3D</span>
<a name="ln-1865"></a>
<a name="ln-1866"></a>  <span class="k">SUBROUTINE </span><span class="n">BoundaryInterp_Tensor3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1867"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1868"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1869"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1870"></a>
<a name="ln-1871"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1872"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">TensorBoundaryInterp_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1873"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1874"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1875"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1876"></a>    <span class="k">ELSE</span>
<a name="ln-1877"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">TensorBoundaryInterp_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1878"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1879"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1880"></a>                                                          <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1881"></a>    <span class="k">END IF</span>
<a name="ln-1882"></a>
<a name="ln-1883"></a><span class="k">  END SUBROUTINE </span><span class="n">BoundaryInterp_Tensor3D</span>
<a name="ln-1884"></a>
<a name="ln-1885"></a>  <span class="k">SUBROUTINE </span><span class="n">GridInterp_Tensor3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1886"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1887"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1888"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1889"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1890"></a>
<a name="ln-1891"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1892"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">TensorGridInterp_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1893"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1894"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1895"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1896"></a>    <span class="k">ELSE</span>
<a name="ln-1897"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">TensorGridInterp_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1898"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1899"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1900"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1901"></a>    <span class="k">END IF</span>
<a name="ln-1902"></a>
<a name="ln-1903"></a><span class="k">  END SUBROUTINE </span><span class="n">GridInterp_Tensor3D</span>
<a name="ln-1904"></a>
<a name="ln-1905"></a>  <span class="k">SUBROUTINE </span><span class="n">Divergence_Tensor3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1906"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1907"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1908"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1909"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1910"></a>
<a name="ln-1911"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1912"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">TensorDivergence_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1913"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1914"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1915"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1916"></a>    <span class="k">ELSE</span>
<a name="ln-1917"></a><span class="k">      CALL </span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interp</span> <span class="p">%</span> <span class="n">TensorDivergence_3D</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1918"></a>                                                      <span class="n">SELFout</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1919"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1920"></a>                                                      <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1921"></a>    <span class="k">END IF</span>
<a name="ln-1922"></a>
<a name="ln-1923"></a><span class="k">  END SUBROUTINE </span><span class="n">Divergence_Tensor3D</span>
<a name="ln-1924"></a>
<a name="ln-1925"></a>  <span class="k">SUBROUTINE </span><span class="n">Determinant_Tensor3D</span><span class="p">(</span><span class="n">SELFStorage</span><span class="p">,</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">gpuAccel</span><span class="p">)</span>
<a name="ln-1926"></a><span class="cp">#undef __FUNC__</span>
<a name="ln-1927"></a><span class="cp">#define __FUNC__ &quot;Determinant_Tensor3D&quot;</span>
<a name="ln-1928"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1929"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFStorage</span>
<a name="ln-1930"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Scalar3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-1931"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gpuAccel</span>
<a name="ln-1932"></a>    <span class="c">! Local</span>
<a name="ln-1933"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a name="ln-1934"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="kd">::</span> <span class="n">msg</span>
<a name="ln-1935"></a>
<a name="ln-1936"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gpuAccel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1937"></a><span class="cp">#ifdef GPU</span>
<a name="ln-1938"></a>      <span class="k">CALL </span><span class="n">Determinant_Tensor3D_gpu_wrapper</span><span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1939"></a>                                            <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">deviceData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1940"></a>                                            <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1941"></a>                                            <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1942"></a>                                            <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-1943"></a><span class="cp">#else</span>
<a name="ln-1944"></a>     <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;GPU Acceleration currently not enabled in SELF&quot;</span>
<a name="ln-1945"></a>     <span class="n">WARNING</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a name="ln-1946"></a><span class="cp">#endif</span>
<a name="ln-1947"></a>
<a name="ln-1948"></a>    <span class="k">ELSE</span>
<a name="ln-1949"></a>
<a name="ln-1950"></a><span class="k">      DO </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-1951"></a>        <span class="k">DO </span><span class="n">iVar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">nVar</span>
<a name="ln-1952"></a>          <span class="k">DO </span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1953"></a>            <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1954"></a>              <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1955"></a>
<a name="ln-1956"></a>                <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1957"></a>                  <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1958"></a>                  <span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1959"></a>                   <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1960"></a>                   <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1961"></a>                   <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">))</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1962"></a>                  <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1963"></a>                  <span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1964"></a>                   <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1965"></a>                   <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1966"></a>                   <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1967"></a>                  <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1968"></a>                  <span class="p">(</span><span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1969"></a>                   <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1970"></a>                   <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1971"></a>                   <span class="n">SELFStorage</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">))</span>
<a name="ln-1972"></a>
<a name="ln-1973"></a>              <span class="k">END DO</span>
<a name="ln-1974"></a><span class="k">            END DO</span>
<a name="ln-1975"></a><span class="k">          END DO</span>
<a name="ln-1976"></a><span class="k">        END DO</span>
<a name="ln-1977"></a><span class="k">      END DO</span>
<a name="ln-1978"></a>
<a name="ln-1979"></a><span class="k">    ENDIF</span>
<a name="ln-1980"></a>
<a name="ln-1981"></a><span class="k">  END SUBROUTINE </span><span class="n">Determinant_Tensor3D</span>
<a name="ln-1982"></a>
<a name="ln-1983"></a>  <span class="k">FUNCTION </span><span class="n">AbsMaxInterior_Tensor3D</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">absMax</span><span class="p">)</span>
<a name="ln-1984"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1985"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tensor</span>
<a name="ln-1986"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">absMax</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">)</span>
<a name="ln-1987"></a>    <span class="c">! Local</span>
<a name="ln-1988"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="n">col</span>
<a name="ln-1989"></a>
<a name="ln-1990"></a>    <span class="n">absMax</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-1991"></a>    <span class="k">DO </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-1992"></a>      <span class="k">DO </span><span class="n">iVar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">nVar</span>
<a name="ln-1993"></a>        <span class="k">DO </span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1994"></a>          <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1995"></a>            <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-1996"></a>              <span class="k">DO </span><span class="n">col</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-1997"></a>                <span class="k">DO </span><span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-1998"></a>                  <span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iEl</span><span class="p">)),</span><span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">))</span>
<a name="ln-1999"></a>                <span class="k">END DO</span>
<a name="ln-2000"></a><span class="k">              END DO</span>
<a name="ln-2001"></a><span class="k">            END DO</span>
<a name="ln-2002"></a><span class="k">          END DO</span>
<a name="ln-2003"></a><span class="k">        END DO</span>
<a name="ln-2004"></a><span class="k">      END DO</span>
<a name="ln-2005"></a><span class="k">    END DO</span>
<a name="ln-2006"></a>
<a name="ln-2007"></a><span class="k">  END FUNCTION </span><span class="n">AbsMaxInterior_Tensor3D</span>
<a name="ln-2008"></a>
<a name="ln-2009"></a>  <span class="k">FUNCTION </span><span class="n">AbsMaxBoundary_Tensor3D</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">absMax</span><span class="p">)</span>
<a name="ln-2010"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2011"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tensor</span>
<a name="ln-2012"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="kd">::</span> <span class="n">absMax</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-2013"></a>    <span class="c">! Local</span>
<a name="ln-2014"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iEl</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">iSide</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="n">col</span>
<a name="ln-2015"></a>
<a name="ln-2016"></a>    <span class="n">absMax</span> <span class="o">=</span> <span class="mf">0.0_prec</span>
<a name="ln-2017"></a>    <span class="k">DO </span><span class="n">iEl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">nElem</span>
<a name="ln-2018"></a>      <span class="k">DO </span><span class="n">iSide</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">6</span>
<a name="ln-2019"></a>        <span class="k">DO </span><span class="n">iVar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">nVar</span>
<a name="ln-2020"></a>          <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-2021"></a>            <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">N</span>
<a name="ln-2022"></a>              <span class="k">DO </span><span class="n">col</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-2023"></a>                <span class="k">DO </span><span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-2024"></a>                  <span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">tensor</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">,</span><span class="n">iEl</span><span class="p">)),</span><span class="n">absMax</span><span class="p">(</span><span class="n">iVar</span><span class="p">,</span><span class="n">iSide</span><span class="p">))</span>
<a name="ln-2025"></a>                <span class="k">END DO</span>
<a name="ln-2026"></a><span class="k">              END DO</span>
<a name="ln-2027"></a><span class="k">            END DO</span>
<a name="ln-2028"></a><span class="k">          END DO</span>
<a name="ln-2029"></a><span class="k">        END DO</span>
<a name="ln-2030"></a><span class="k">      END DO</span>
<a name="ln-2031"></a><span class="k">    END DO</span>
<a name="ln-2032"></a>
<a name="ln-2033"></a><span class="k">  END FUNCTION </span><span class="n">AbsMaxBoundary_Tensor3D</span>
<a name="ln-2034"></a>
<a name="ln-2035"></a>  <span class="k">SUBROUTINE </span><span class="n">Equals_Tensor3D</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">,</span><span class="n">SELFin</span><span class="p">)</span>
<a name="ln-2036"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2037"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-2038"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFin</span>
<a name="ln-2039"></a>
<a name="ln-2040"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFin</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-2041"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFin</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-2042"></a>
<a name="ln-2043"></a>  <span class="k">END SUBROUTINE </span><span class="n">Equals_Tensor3D</span>
<a name="ln-2044"></a>
<a name="ln-2045"></a>  <span class="k">FUNCTION </span><span class="n">Add_Tensor3D</span><span class="p">(</span><span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span>
<a name="ln-2046"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2047"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span>
<a name="ln-2048"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-2049"></a>
<a name="ln-2050"></a>    <span class="k">CALL </span><span class="n">SELFOut</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">SELFa</span> <span class="p">%</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2051"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">controlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2052"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2053"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">targetType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2054"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2055"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-2056"></a>
<a name="ln-2057"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2058"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-2059"></a>
<a name="ln-2060"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2061"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-2062"></a>
<a name="ln-2063"></a>  <span class="k">END FUNCTION </span><span class="n">Add_Tensor3D</span>
<a name="ln-2064"></a>
<a name="ln-2065"></a>  <span class="k">FUNCTION </span><span class="n">Subtract_Tensor3D</span><span class="p">(</span><span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SELFOut</span><span class="p">)</span>
<a name="ln-2066"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-2067"></a><span class="k">    CLASS</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFa</span><span class="p">,</span><span class="n">SELFb</span>
<a name="ln-2068"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Tensor3D</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SELFOut</span>
<a name="ln-2069"></a>
<a name="ln-2070"></a>    <span class="k">CALL </span><span class="n">SELFOut</span> <span class="p">%</span> <span class="n">Init</span><span class="p">(</span><span class="n">SELFa</span> <span class="p">%</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2071"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">controlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2072"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2073"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">targetType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2074"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nVar</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2075"></a>                        <span class="n">SELFa</span> <span class="p">%</span> <span class="n">nElem</span><span class="p">)</span>
<a name="ln-2076"></a>
<a name="ln-2077"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-2078"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">interior</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-2079"></a>
<a name="ln-2080"></a>    <span class="n">SELFOut</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">=</span> <span class="n">SELFa</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-2081"></a>                                    <span class="n">SELFb</span> <span class="p">%</span> <span class="n">boundary</span> <span class="p">%</span> <span class="n">hostData</span>
<a name="ln-2082"></a>
<a name="ln-2083"></a>  <span class="k">END FUNCTION </span><span class="n">Subtract_Tensor3D</span>
<a name="ln-2084"></a>
<a name="ln-2085"></a><span class="k">END MODULE </span><span class="n">SELF_Data</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2021-04-14 00:34  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> SELF was developed by Joe Schoonover</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>